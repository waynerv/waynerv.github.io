<?xml version="1.0" encoding="utf-8"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Shall We Code?</title><link>https://www.waynerv.com/</link><description>è°ˆè°ˆå¤©ï¼Œå†™å†™ç </description><generator>Hugo 0.79.1 https://gohugo.io/</generator><language>zh-CN</language><managingEditor>ampedee@gmail.com (Waynerv)</managingEditor><webMaster>ampedee@gmail.com (Waynerv)</webMaster><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><lastBuildDate>Wed, 31 Mar 2021 16:18:19 +0000</lastBuildDate><atom:link rel="self" type="application/rss+xml" href="https://www.waynerv.com/rss.xml"/><item><title>[CSAPP] è®¡ç®—æœºçš„æµ®ç‚¹æ•°è¡¨ç¤º</title><link>https://www.waynerv.com/posts/csapp-ieee-floating-intro/</link><guid isPermaLink="true">https://www.waynerv.com/posts/csapp-ieee-floating-intro/</guid><pubDate>Mon, 29 Mar 2021 22:48:53 +0800</pubDate><author>ampedee@gmail.com (Waynerv)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>å¦‚æœä½ æ›¾ç»ä½¿ç”¨è¿‡ Python æˆ–è€… JavaScript è¿›è¡Œæµ®ç‚¹æ•°è®¡ç®—ï¼Œå¯èƒ½ä¼šé‡åˆ°ç±»ä¼¼ä¸‹é¢çš„æƒ…å†µï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="o">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span class="mf">0.1&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mf">0.2&lt;/span>
&lt;span class="mf">0.30000000000000004&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…¶åŸå› æ˜¯ç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œæ‰€ä½¿ç”¨çš„æµ®ç‚¹æ•°ç±»å‹å¹¶æ²¡æœ‰ç²¾ç¡®åœ°è¡¨ç¤º &lt;code>0.1&lt;/code> å’Œ &lt;code>0.2&lt;/code> ï¼Œè‡ªç„¶ç»“æœä¹Ÿå°±ä¸ç­‰äº &lt;code>0.3&lt;/code>ã€‚å€Ÿç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹è®¡ç®—æœºåœ¨åº•å±‚æ˜¯å¦‚ä½•è¡¨ç¤ºè¿™ç±»æµ®ç‚¹æ•°çš„ã€‚&lt;/p>
&lt;h2 id="è®¡ç®—æœºæ— æ³•ç²¾ç¡®åœ°è¡¨ç¤ºæ‰€æœ‰å®æ•°">è®¡ç®—æœºæ— æ³•ç²¾ç¡®åœ°è¡¨ç¤ºæ‰€æœ‰å®æ•°&lt;/h2>
&lt;p>è¿™æ˜¯ä¸€ä¸ªéœ€è¦æ˜ç¡®çš„å‰æã€‚&lt;/p>
&lt;p>æˆ‘ä»¬è‹¥æƒ³ç²¾ç¡®çš„è¡¨ç¤ºæŸä¸ªé›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¿…é¡»æ»¡è¶³ä¸€ä¸ªæ¡ä»¶ï¼šæ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ç§ä¸å…¶ä»–å…ƒç´ ä¸åŒçš„è¡¨ç¤ºã€‚è®¡ç®—æœºé€šè¿‡å¤šä¸ªä½çš„ 0 å’Œ 1 æ¥è¡¨ç¤ºä¿¡æ¯ï¼Œè€Œå®æ•°æ˜¯æ— é™çš„ï¼Œè®¡ç®—æœºçš„ç¡¬ä»¶èµ„æºå´æ˜¯æœ‰é™çš„ï¼Œè¿™å°±æ³¨å®šäº†è®¡ç®—æœºæ— æ³•ç²¾ç¡®åœ°è¡¨ç¤ºæ‰€æœ‰å®æ•°ã€‚æœ€ä¼˜è§£æ˜¯æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ç§åˆé€‚çš„è¡¨ç¤ºæ–¹æ³•ï¼Œåˆ©ç”¨æœ‰é™çš„ç¡¬ä»¶èµ„æºï¼ˆå°½å¯èƒ½çŸ­çš„ä½æ•°ï¼‰ï¼Œå°½å¯èƒ½ç²¾ç¡®åœ°è¡¨ç¤ºå°½å¯èƒ½å¤§çš„æ•°å€¼èŒƒå›´ã€‚&lt;/p>
&lt;h2 id="äºŒè¿›åˆ¶å°æ•°">äºŒè¿›åˆ¶å°æ•°&lt;/h2>
&lt;p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç”¨äºŒè¿›åˆ¶æ¥è¡¨ç¤ºå°æ•°å‘¢ï¼Ÿ&lt;/p>
&lt;p>é¦–å…ˆè€ƒè™‘åè¿›åˆ¶æ˜¯å¦‚ä½•ç”¨å°æ•°ç‚¹æ¥è¡¨ç¤ºå°æ•°çš„ï¼š$d_md_{mâˆ’1}...d_1d_0.d_{âˆ’1}d_{âˆ’2}...d_{âˆ’n}$ï¼Œæ¯ä¸€ä½çš„å€¼ $d_i$ å–å€¼èŒƒå›´æ˜¯ 0-9ï¼Œä¸Šè¿°è¡¨ç¤ºæ‰€ä»£è¡¨çš„æ•°å€¼ $d$ ä¸ºï¼š&lt;/p>
&lt;p>$d = \displaystyle\sum_{{ i = -n}}^m 10^i Ã— d_i$&lt;/p>
&lt;p>å°æ•°ç‚¹å·¦è¾¹ç¬¬ m ä½ï¼ˆä» 0 å¼€å§‹ï¼‰å…·æœ‰ $10^m$ çš„åŠ æƒï¼Œå³è¾¹ç¬¬ n ä½ï¼ˆä» 1 å¼€å§‹ï¼‰å…·æœ‰ $10^{-n}$ çš„åŠ æƒã€‚ä¸¾ä¾‹æ¥è¯´ $12.34_{10}$ å³ä»£è¡¨ $1Ã—10^1+2Ã—10^0+3Ã—10_{âˆ’1}+4Ã—10_{âˆ’2}=12\frac{34}{100}$ ã€‚&lt;/p>
&lt;p>åŒæ ·åœ°ï¼Œå¯¹äºŒè¿›åˆ¶è¡¨ç¤ºï¼š$b_mb_{mâˆ’1}...b_1b_0.b_{âˆ’1}b_{âˆ’2}...b_{âˆ’n}$ï¼Œæ¯ä¸€ä½çš„å€¼ $b_i$ çš„å–å€¼èŒƒå›´æ˜¯ 0-1ï¼Œæ‰€ä»£è¡¨çš„æ•°å€¼ $b$ ä¸ºï¼š&lt;/p>
&lt;p>$b = \displaystyle\sum_{{ i = -n}}^m 2^i Ã— b_i$&lt;/p>
&lt;p>å°æ•°ç‚¹å·¦è¾¹ç¬¬ m ä½ï¼ˆä» 0 å¼€å§‹ï¼‰å…·æœ‰ $2^m$ çš„åŠ æƒï¼Œå³è¾¹ç¬¬ n ä½ï¼ˆä» 1 å¼€å§‹ï¼‰å…·æœ‰ $2^{-n}$ çš„åŠ æƒã€‚ä¸¾ä¾‹æ¥è¯´ $101.11_{2}$ å³ä»£è¡¨ $1Ã—2^2+0Ã—2^1+1Ã—2^0+1Ã—2_{âˆ’1}+1Ã—2_{âˆ’2}=5\frac{3}{4}$ ã€‚&lt;/p>
&lt;p>å¦‚åŒåè¿›åˆ¶å°æ•°ç‚¹å·¦ç§»é™¤ä»¥ 10ï¼Œå³ç§»ä¹˜ä»¥ 10 çš„è§„åˆ™ï¼ŒäºŒè¿›åˆ¶å°æ•°ç‚¹ä¹Ÿæœ‰å·¦ç§»é™¤ä»¥ 2ï¼Œå³ç§»ä¹˜ä»¥ 2 çš„è§„åˆ™ã€‚ç”±äºè®¡ç®—æœºåªèƒ½è¿›è¡Œæœ‰é™ä½æ•°çš„ç¼–ç ï¼Œå› æ­¤ä»ä¸Šè¿° b çš„æ±‚å€¼å…¬å¼å¯çŸ¥ï¼Œè¿™ç§æ–¹æ³•åªèƒ½ç²¾ç¡®çš„è¡¨ç¤ºèƒ½å¤Ÿå†™ä½œ $x Ã— 2^y$ çš„å€¼ã€‚&lt;/p>
&lt;h2 id="ieee-754-æµ®ç‚¹æ•°">IEEE 754 æµ®ç‚¹æ•°&lt;/h2>
&lt;p>ç”¨ $b_mb_{mâˆ’1}...b_1b_0.b_{âˆ’1}b_{âˆ’2}...b_{âˆ’n}$ è¿™ç§æ–¹å¼æ¥è¡¨ç¤ºå¾ˆå°çš„æ•°æˆ–è€…å¾ˆå¤§çš„æ•°æ˜¯éå¸¸ä½æ•ˆçš„ï¼Œæ¯”å¦‚è¡¨ç¤º $5 Ã— 2^{500}$ å°±éœ€è¦è‡³å°‘ 100 ä½ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ç§æ›´èªæ˜çš„è¡¨ç¤ºæ–¹å¼ï¼Œæ—¢ç„¶äºŒè¿›åˆ¶èƒ½å¤Ÿè¡¨ç¤ºçš„æ•°å¯ä»¥å½’çº³ä¸º $x Ã— 2^y$ï¼Œæˆ‘ä»¬å¯ä»¥ä»…è¡¨ç¤º $x$ å’Œ $y$ã€‚&lt;/p>
&lt;p>IEEE 754 æµ®ç‚¹æ•°æ ‡å‡†æ˜¯å¦‚ä»Šæœ€æµè¡Œå’Œé€šç”¨çš„æµ®ç‚¹æ•°è¡¨ç¤ºæ ‡å‡†ã€‚å®ƒç”¨ $V = (âˆ’1)^s Ã— M Ã— 2^E$ çš„å½¢å¼æ¥è¡¨ç¤ºä¸€ä¸ªæ•°å­—ï¼š&lt;/p>
&lt;ul>
&lt;li>ç¬¦å·ä½ $s$ å†³å®šè¯¥æ•°å­—æ˜¯æ­£æ•°ï¼ˆ$s=0$ï¼‰è¿˜æ˜¯è´Ÿæ•°ï¼ˆ$s=1$ï¼‰ã€‚æ•°å€¼ 0 æ˜¯ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œæˆ‘ä»¬ä¼šåœ¨ä¹‹åè§£é‡Šã€‚&lt;/li>
&lt;li>æœ‰æ•ˆæ•° $M$ æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å°æ•°ï¼Œå®ƒçš„å–å€¼èŒƒå›´ä¸º 1 å’Œæ— é™è¶‹è¿‘äº 2 ä¹‹é—´ï¼Œæˆ–è€…ä¸º 0 å’Œæ— é™è¶‹è¿‘äº 1 ä¹‹é—´ã€‚å…·ä½“å¤„äºå“ªä¸ªå–å€¼èŒƒå›´ç”±æŒ‡æ•°éƒ¨åˆ†çš„æ¯”ç‰¹ä½æ˜¯å¦å…¨éƒ¨ä¸º 0 æ¥å†³å®šã€‚&lt;/li>
&lt;li>æŒ‡æ•° $E$ å¯èƒ½ä¸ºæ­£æ•°ä¹Ÿå¯èƒ½ä¸ºè´Ÿæ•°ï¼Œé€šè¿‡ 2 çš„æŒ‡æ•°å¹‚å¯¹æœ€ç»ˆè¡¨ç¤ºçš„æµ®ç‚¹æ•°è¿›è¡ŒåŠ æƒã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.waynerv.com/images/2021-03-30-floating-fields.png" alt="">&lt;/p>
&lt;p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ IEEE æµ®ç‚¹æ•°æ˜¯å¦‚ä½•åœ¨è®¡ç®—æœºä¸­å·¥ä½œçš„ã€‚IEEE æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­æœ€å¸¸è§çš„å®é™…è¡¨ç¤ºåˆ†åˆ«æ˜¯ 32 ä½ï¼ˆå•ç²¾åº¦ï¼‰å’Œ 64 ä½ï¼ˆåŒç²¾åº¦ï¼‰ï¼Œå…¶åŒ…å«çš„æ¯”ç‰¹ä½å¯ä»¥åˆ’åˆ†ä¸º 3 éƒ¨åˆ†ï¼ˆå¦‚ä¸Šå›¾ï¼‰ï¼š&lt;/p>
&lt;ul>
&lt;li>æœ€å·¦è¾¹çš„å•ä¸ªæ¯”ç‰¹ä½ s ä»£è¡¨ç¬¦å·ä½ $s$ çš„å€¼ã€‚&lt;/li>
&lt;li>ç”± k ä¸ªæ¯”ç‰¹ä½æ„æˆçš„æŒ‡æ•°éƒ¨åˆ† &lt;strong>exp&lt;/strong> $= e_{k-1}...e_1e_0$ å¯¹æŒ‡æ•° $E$ è¿›è¡Œç¼–ç ã€‚&lt;/li>
&lt;li>ç”± n ä¸ªæ¯”ç‰¹ä½æ„æˆçš„å°æ•°éƒ¨åˆ† &lt;strong>frac&lt;/strong> $= f_{n-1}...f_1f_0$ å¯¹æœ‰æ•ˆæ•° $M$ è¿›è¡Œç¼–ç ã€‚&lt;/li>
&lt;/ul>
&lt;p>åœ¨å•ç²¾åº¦æµ®ç‚¹æ•°è¡¨ç¤ºä¸­ï¼Œs ä¸º 1 ä½ï¼ŒæŒ‡æ•°éƒ¨åˆ†ä¸º 8 ä½ï¼ˆk=8ï¼‰ï¼Œå°æ•°éƒ¨åˆ†ä¸º 23 ä½ï¼ˆn=23ï¼‰ï¼Œæ€»å…± 32 ä½ã€‚&lt;/p>
&lt;p>åœ¨åŒç²¾åº¦æµ®ç‚¹æ•°è¡¨ç¤ºä¸­ï¼Œs ä¸º 1 ä½ï¼ŒæŒ‡æ•°éƒ¨åˆ†ä¸º 11 ä½ï¼ˆk=11ï¼‰ï¼Œå°æ•°éƒ¨åˆ†ä¸º 52 ä½ï¼ˆn=52ï¼‰ï¼Œæ€»å…± 64 ä½ã€‚&lt;/p>
&lt;p>å–å†³äºæŒ‡æ•°éƒ¨åˆ†çš„æ¯”ç‰¹ä½çš„å€¼ï¼Œé€šè¿‡ä»¥ä¸Šè¡¨ç¤ºç¼–ç å¾—åˆ°çš„å€¼å¯åˆ†ä¸ºä¸‹é¢ 3 ç§æƒ…å†µã€‚&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2021-03-30-floating-3-cases.png" alt="">&lt;/p>
&lt;h3 id="è§„èŒƒåŒ–çš„å€¼normalized">è§„èŒƒåŒ–çš„å€¼ï¼ˆNormalizedï¼‰&lt;/h3>
&lt;p>è§„èŒƒåŒ–çš„å€¼æ˜¯æœ€å¸¸è§çš„æƒ…å†µï¼Œå‘ç”Ÿåœ¨å½“æŒ‡æ•°ï¼ˆexpï¼‰éƒ¨åˆ†çš„æ¯”ç‰¹ä½æ—¢éå…¨éƒ¨éƒ½æ˜¯ 0ï¼Œä¹Ÿéå…¨éƒ¨éƒ½æ˜¯ 1 æ—¶ï¼Œå³å…¶æ•´æ•°è¡¨ç¤º $0 &amp;lt; exp &amp;lt; 255$ æ—¶ã€‚&lt;/p>
&lt;p>è¿™æ—¶æŒ‡æ•°éƒ¨åˆ†ä¼šè¢«è§£é‡Šä¸ºä¸€ä¸ªåç½®å½¢å¼çš„æœ‰ç¬¦å·æ•´æ•° $E$ï¼Œè®¡ç®—æ–¹å¼ä¸º $E = e - Bias$ï¼Œå…¶ä¸­ $e$ æ˜¯ç”±æŒ‡æ•°éƒ¨åˆ†æ‰€æœ‰æ¯”ç‰¹ä½ $e_{k-1}...e_1e_0$ è¡¨ç¤ºçš„æœ‰ç¬¦å·æ•´æ•°ï¼Œè€Œ $Bias$ æ˜¯ä¸€ä¸ªå–å†³äºæŒ‡æ•°éƒ¨åˆ†æ¯”ç‰¹ä½é•¿åº¦ k çš„å¸¸æ•° $2^{k-1}-1$ï¼ˆå•ç²¾åº¦æµ®ç‚¹æ•°ä¸º 127ï¼Œ åŒç²¾åº¦æµ®ç‚¹æ•°ä¸º 1023ï¼‰ï¼Œå› æ­¤æŒ‡æ•° $E$ çš„å–å€¼èŒƒå›´ä¸º -126 åˆ° 127ï¼ˆå•ç²¾åº¦æµ®ç‚¹æ•°ï¼‰æˆ–è€… -1022 åˆ° 1023ï¼ˆåŒç²¾åº¦æµ®ç‚¹æ•°ï¼‰ã€‚&lt;/p>
&lt;p>å°æ•°éƒ¨åˆ†ä¼šè¢«è§£é‡Šä¸ºä¸€ä¸ªå°æ•°å€¼ $f$ï¼Œ$f$ çš„å–å€¼èŒƒå›´ä¸º $0 &amp;lt;= f &amp;lt; 1$ï¼Œå…¶äºŒè¿›åˆ¶è¡¨ç¤ºä¸º $0.f_{n-1}...f_1f_0$ã€‚æˆ‘ä»¬é»˜è®¤å…¶å°æ•°ç‚¹ä½äºæœ€å·¦è¾¹ï¼Œå°æ•°éƒ¨åˆ†çš„æ¯”ç‰¹ä½å‡è¡¨ç¤ºå°æ•°ç‚¹å³è¾¹çš„å€¼ã€‚è€Œæœ‰æ•ˆæ•° $M = 1 + f$ï¼Œæ­¤æ—¶ $M$ å¯çœ‹ä½œäºŒè¿›åˆ¶è¡¨ç¤ºä¸º $1.f_{n-1}...f_1f_0$ï¼Œå…¶å–å€¼èŒƒå›´ä¸º $1 &amp;lt;= M &amp;lt; 2$ã€‚è¿™é‡Œçš„ä¸€ä¸ªæŠ€å·§æ˜¯ï¼Œæˆ‘ä»¬å¯¹å°æ•°ç‚¹å·¦è¾¹çš„ä¸€ä½å–å›ºå®šå€¼ï¼ˆ0 æˆ– 1ï¼‰ï¼Œå› æ­¤ä¸éœ€è¦ç”¨æ¯”ç‰¹ä½æ˜¾å¼åœ°å»è¡¨ç¤ºå®ƒï¼Œä»è€Œå¤šäº‰å–åˆ°äº†ä¸€ä¸ªæ¯”ç‰¹ä½æ¥è¡¨ç¤ºå°æ•°éƒ¨åˆ†ï¼Œè¿›ä¸€æ­¥æ‰©å¤§äº†å°æ•°éƒ¨åˆ†çš„è¡¨ç¤ºèŒƒå›´å’Œç²¾åº¦ã€‚&lt;/p>
&lt;h3 id="éè§„èŒƒåŒ–çš„å€¼denormalized">éè§„èŒƒåŒ–çš„å€¼ï¼ˆDenormalizedï¼‰&lt;/h3>
&lt;p>å½“ exp éƒ¨åˆ†çš„æ¯”ç‰¹ä½å…¨éƒ¨éƒ½æ˜¯ 0 æ—¶ï¼Œæˆ‘ä»¬ç§°æ­¤æ—¶æµ®ç‚¹æ•°è¡¨ç¤ºçš„æ•°å€¼å½¢å¼ä¸ºéè§„èŒƒåŒ–çš„å€¼ã€‚&lt;/p>
&lt;p>è¿™ç§æƒ…å†µä¸‹ï¼ŒæŒ‡æ•° $E = 1 - Bias$ï¼Œ$E$ æˆä¸ºäº†ä¸€ä¸ªå¸¸æ•°ï¼Œå•ç²¾åº¦æ ¼å¼ä¸‹ä¸º -126ï¼ŒåŒç²¾åº¦æ ¼å¼ä¸‹ä¸º -1022ï¼›æœ‰æ•ˆæ•° $M = f$ï¼Œå³ä¸å†éšå¼åœ°åœ¨æœ€å·¦è¾¹æ·»åŠ ä¸€ä¸ªå€¼ä¸º 1 çš„æ¯”ç‰¹ä½ï¼Œå…¶å–å€¼èŒƒå›´ä¹Ÿå˜ä¸º $0 &amp;lt;= M &amp;lt; 1$ã€‚&lt;/p>
&lt;p>éè§„èŒƒåŒ–è¡¨ç¤ºæœ‰ä¸¤ä¸ªç›®çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸€æ˜¯ä¸ºäº†è¡¨ç¤º 0ï¼Œç”±äºè§„èŒƒåŒ–å€¼ä¸­ $1 &amp;lt;= M &amp;lt; 2$ï¼Œå› æ­¤ä¸ç®¡æŒ‡æ•°éƒ¨åˆ†å–ä»€ä¹ˆå€¼ï¼Œæ‰€è¡¨ç¤ºçš„æ•°å­— $V$ éƒ½ä¸å¯èƒ½ä¸º 0ã€‚è€Œåœ¨éè§„èŒƒåŒ–å€¼ä¸­ $0 &amp;lt;= M &amp;lt; 1$ï¼Œå½“ M çš„å€¼ä¸º 0 æ—¶ï¼Œæ‰€è¡¨ç¤ºçš„æ•°å­— $V$ ä¹Ÿä¸º 0ï¼Œæ­¤æ—¶æŒ‡æ•°éƒ¨åˆ†å’Œå°æ•°éƒ¨åˆ†çš„æ‰€æœ‰æ¯”ç‰¹ä½å‡ä¸º 0ã€‚åœ¨ IEEE æ ‡å‡†ä¸­ï¼Œå–å†³äºæ­¤æ—¶ç¬¦å·ä½ $s$ çš„å€¼ï¼Œ0 ä¹Ÿæœ‰æ­£è´Ÿç¬¦å·ã€‚å½“ $s=0$ æ—¶ï¼Œç”¨æ¥è¡¨ç¤ºè¯¥æµ®ç‚¹æ•°çš„æ‰€æœ‰æ¯”ç‰¹ä½å…¨éƒ¨ä¸º 0ï¼Œ $V = +0.0$ï¼›å½“ $s=1$ æ—¶ï¼Œ$V = -0.0$ã€‚åœ¨ IEEE æ ‡å‡†ä¸­ï¼Œ +0.0 å’Œ -0.0 åœ¨æŸäº›åœºæ™¯ä¸‹æ˜¯ä¸åŒçš„ã€‚&lt;/li>
&lt;li>äºŒæ˜¯ä¸ºäº†è¡¨ç¤ºéå¸¸è¶‹è¿‘äº 0 çš„æ•°ã€‚ç›¸æ¯”è§„èŒƒåŒ–å€¼ï¼Œéè§„èŒƒåŒ–è¡¨ç¤ºèƒ½å¤Ÿè¡¨ç¤ºæ›´åŠ æ¥è¿‘äº 0 çš„æ•°å­—ï¼Œä¸”åœ¨è¡¨ç¤ºçš„å€¼éå¸¸è¶‹è¿‘äº 0 æ—¶ï¼Œè¿™äº›å€¼çš„åˆ†å¸ƒèƒ½ä¿æŒç›¸å¯¹å‡åŒ€ï¼Œè¿™ç§èƒ½åŠ›ä¹Ÿå«ã€Œæ¸è¿›ä¸‹æº¢ã€ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ç‰¹æ®Šå€¼special">ç‰¹æ®Šå€¼ï¼ˆSpecialï¼‰&lt;/h3>
&lt;p>æœ€åä¸€ç§æƒ…å†µæ˜¯å½“ exp éƒ¨åˆ†çš„æ¯”ç‰¹ä½å…¨éƒ¨éƒ½æ˜¯ 1 æ—¶ã€‚&lt;/p>
&lt;p>è‹¥å°æ•°éƒ¨åˆ†çš„æ¯”ç‰¹ä½ä¹Ÿå…¨éƒ¨æ˜¯ 0ï¼Œå…¶è¡¨ç¤ºçš„å€¼ $V$ ä»£è¡¨æ— é™å¤§ï¼šå½“ $s=0$ æ—¶ï¼Œ $v = + âˆ$ï¼›å½“ $s=1$ æ—¶ï¼Œ $V = -âˆ$ã€‚æ— é™å¤§å¯ä»¥ç”¨æ¥è¡¨ç¤ºå°†ä¼šæº¢å‡ºçš„è®¡ç®—ç»“æœï¼Œå¦‚å°†ä¸¤ä¸ªæå¤§çš„æ•°ç›¸ä¹˜ï¼Œæˆ–è€…é™¤ä»¥0æ—¶ã€‚&lt;/p>
&lt;p>è‹¥å°æ•°éƒ¨åˆ†çš„æ¯”ç‰¹ä½ä¸å…¨ä¸º 0ï¼Œå…¶è¡¨ç¤ºçš„å€¼ $V$ ä»£è¡¨ &lt;code>NaN&lt;/code>ï¼ˆ&lt;strong>N&lt;/strong>ot &lt;strong>a&lt;/strong> &lt;strong>N&lt;/strong>umberï¼‰ã€‚è¿™ç§å€¼é€šå¸¸ç”¨æ¥ä½œä¸ºæŸäº›è®¡ç®—ç»“æœä¸æ˜¯çœŸå®æ•°å­—æˆ–è€…æ— é™å¤§çš„æ“ä½œçš„è¿”å›å€¼ï¼Œå¦‚ $\sqrt{-1}$ æˆ–è€… $âˆ - âˆ$ã€‚åœ¨æŸäº›åº”ç”¨ä¸­è¿˜ä¼šç”¨æ¥è¡¨ç¤ºå°šæœªåˆå§‹åŒ–çš„æ•°æ®ã€‚&lt;/p>
&lt;h3 id="ç¤ºä¾‹">ç¤ºä¾‹&lt;/h3>
&lt;p>æˆ‘ä»¬å‡å®šä¸€ä¸ª 8 ä½çš„æµ®ç‚¹æ•°è¡¨ç¤ºä½œä¸ºç¤ºä¾‹ï¼Œå…¶æŒ‡æ•°éƒ¨åˆ†é•¿åº¦ä¸º 4ï¼Œå°æ•°éƒ¨åˆ†é•¿åº¦ä¸º 3ï¼Œåç½®å€¼ä¸º 7ï¼Œå³ $k=4$ï¼Œ$n=3$ï¼Œ$Bias=7$ã€‚å…¶æŒ‡æ•°ï¼ˆExponentï¼‰ä»¥åŠå°æ•°ï¼ˆFractionï¼‰ç­‰å„ä¸ªéƒ¨åˆ†çš„å€¼ä»¥åŠæ‰€è¡¨ç¤ºçš„åè¿›åˆ¶å€¼å¦‚ä¸‹å›¾ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2021-03-30-floating-examples.png" alt="">&lt;/p>
&lt;p>ä»ä¸­æˆ‘ä»¬å¯ä»¥å‘ç° IEEE æµ®ç‚¹æ•°çš„ä¸€äº›è§„å¾‹ï¼š&lt;/p>
&lt;ol>
&lt;li>è™½ç„¶ä½¿ç”¨äº†ä¸åŒçš„è®¡ç®—æ–¹å¼ï¼Œä½†éè§„èŒƒåŒ–å€¼å¯ä»¥å¹³æ»‘åœ°è¿‡æ¸¡åˆ°è§„èŒƒåŒ–å€¼ï¼Œå¦‚ä¸Šæœ€å¤§çš„éè§„èŒƒåŒ–å€¼ä¸º $\frac{7}{512}$ï¼Œè€Œæœ€å°çš„è§„èŒƒåŒ–å€¼ä¸º $\frac{8}{512}$ã€‚&lt;/li>
&lt;li>éšç€æµ®ç‚¹æ•°çš„é€’å¢ï¼Œå…¶æ¯”ç‰¹ä½è¡¨ç¤ºæ‰€è§£é‡Šåœ°æ— ç¬¦å·æ•´æ•°ä¹Ÿéšä¹‹é€’å¢ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ç›¸å¯¹ç®€å•çš„æ— ç¬¦å·æ•´æ•°çš„æ’åºè§„åˆ™æ¥å¯¹æµ®ç‚¹æ•°è¿›è¡Œæ’åºï¼Œè¿™å¹¶éå·§åˆï¼Œè€Œæ˜¯æœ‰æ„è®¾è®¡çš„ã€‚&lt;/li>
&lt;/ol></description><category domain="https://www.waynerv.com/categories/%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%93/">ç¬”è®°æ€»ç»“</category><category domain="https://www.waynerv.com/tags/csapp/">CSAPP</category></item><item><title>Git cherry-pick æ“ä½œæµ…æ</title><link>https://www.waynerv.com/posts/git-cherry-pick-intro/</link><guid isPermaLink="true">https://www.waynerv.com/posts/git-cherry-pick-intro/</guid><pubDate>Tue, 26 Jan 2021 16:49:50 +0800</pubDate><author>ampedee@gmail.com (Waynerv)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>åœ¨å‰é¢å‡ ç¯‡è®²è§£ Git è¿›é˜¶ç”¨æ³•çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº† Git çš„å·¥ä½œåŸç†ï¼Œä»¥åŠ &lt;code>rebase&lt;/code>ï¼Œ&lt;code>merge&lt;/code>ï¼Œ&lt;code>checkout&lt;/code>ï¼Œ &lt;code>reset&lt;/code> ç­‰å¤šç§æ“ä½œçš„ä½¿ç”¨åœºæ™¯å’Œç”¨æ³•ï¼ŒåŸºæœ¬ä¸Šåœ¨ä½¿ç”¨ Git æ—¶ä½ å·²ç»å¯ä»¥æ— æ‰€ç•æƒ§äº†ï¼Œä½ å¯ä»¥è‡ªå¦‚çš„ä¿®æ”¹æäº¤å†å²ï¼Œå¹¶ä¿è¯ä¸ä¼šä¸¢å¤±ä»»ä½•æ›´æ”¹ã€‚ä»Šå¤©æˆ‘ä»¬æ¥è¡¥ä¸Šæœ€åä¸€ç¯ï¼Œäº†è§£ä½¿ç”¨åœºæ™¯ä¸å¤šä½†å´èƒ½è¾¾åˆ°å¥‡æ•ˆçš„ &lt;code>cherry-pick&lt;/code> å‘½ä»¤ã€‚&lt;/p>
&lt;h2 id="åŸºæœ¬ç”¨æ³•">åŸºæœ¬ç”¨æ³•&lt;/h2>
&lt;p>Git å‘½ä»¤æ–‡æ¡£çš„æè¿°ä¸ä¸€å®šç›´è§‚æ˜“æ‡‚ï¼Œä½†ç»å¯¹å‡†ç¡®ï¼Œæ–‡æ¡£å¯¹ &lt;code>git cherry-pick&lt;/code> æè¿°æ˜¯ï¼š &lt;code>Apply the changes introduced by some existing commits&lt;/code>ï¼Œå³åº”ç”¨æŸäº›å·²æœ‰æäº¤æ‰€å¼•å…¥çš„æ›´æ”¹ã€‚é€šå¸¸æˆ‘ä»¬ä¼šè¯´ &lt;code>cherry-pick&lt;/code> æ˜¯å°†æŸä¸ªï¼ˆäº›ï¼‰æäº¤ä»ä¸€ä¸ªåˆ†æ”¯ç§»åŠ¨åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ï¼Œè¿™ç§è¯´æ³•æ›´åŠ å®¹æ˜“ç†è§£ï¼Œä½†åé¢æˆ‘ä»¬ä¼šè§£é‡Šä¸ºä½•æ–‡æ¡£çš„æè¿°æ‰æ˜¯æœ€å‡†ç¡®çš„ã€‚&lt;/p>
&lt;p>å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹æäº¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-jsx" data-lang="jsx">&lt;span class="nx">a&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">d&lt;/span> &lt;span class="nx">master&lt;/span>
&lt;span class="o">\&lt;/span>
&lt;span class="nx">e&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">g&lt;/span> &lt;span class="nx">feature&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç°åœ¨æˆ‘ä»¬æƒ³æŠŠ &lt;code>e&lt;/code> å’Œ &lt;code>f&lt;/code> ä¸¤ä¸ªæäº¤ç§»åŠ¨åˆ° &lt;code>master&lt;/code> åˆ†æ”¯ï¼Œé¦–å…ˆéœ€è¦åˆ‡æ¢åˆ° &lt;code>master&lt;/code> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout master
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>cherry-pick&lt;/code> å‘½ä»¤çš„ç”¨æ³•ç®€å•æ˜äº†ï¼Œå¯¹éœ€è¦ç§»åŠ¨çš„ä¸€ä¸ªæˆ–å¤šä¸ªæäº¤æ‰§è¡Œ &lt;code>cherry-pick&lt;/code> å³å¯ï¼Œæ³¨æ„è¿™é‡Œæˆ‘ä»¬ç”¨å­—æ¯æŒ‡ä»£å®é™…çš„æäº¤ &lt;code>SHA-1&lt;/code> IDï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout f g
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œåçš„æäº¤å†å²å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-jsx" data-lang="jsx">&lt;span class="nx">a&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">d&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">f&lt;/span>&lt;span class="s1">&amp;#39; - g&amp;#39;&lt;/span> &lt;span class="nx">master&lt;/span>
&lt;span class="o">\&lt;/span>
&lt;span class="nx">e&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">g&lt;/span> &lt;span class="nx">feature&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®é™…çš„ç»“æœæ˜¯åœ¨ &lt;code>master&lt;/code> åˆ†æ”¯åˆ›å»ºäº† &lt;code>f'&lt;/code> å’Œ &lt;code>g'&lt;/code> ä¸¤ä¸ªæ–°çš„æäº¤ï¼Œå®ƒä»¬æ‹¥æœ‰å’Œ &lt;code>f&lt;/code> ã€&lt;code>g&lt;/code> ä¸åŒçš„ ID ã€‚&lt;/p>
&lt;h2 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯&lt;/h2>
&lt;p>ä»ä¸Šé¢çš„å‘½ä»¤è§£é‡Šæ¥çœ‹ï¼Œ&lt;code>cherry-pick&lt;/code> å®ç°çš„æ•ˆæœæ¯”è¾ƒç®€å•ï¼Œè€Œä¸”å’Œ &lt;code>merge&lt;/code>ã€&lt;code>rebase&lt;/code> çœ‹ä¸Šå»æœ‰æ‰€é‡åˆï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ &lt;code>cherry-pick&lt;/code> çš„å®é™…ä½¿ç”¨åœºæ™¯ã€‚&lt;/p>
&lt;h3 id="ç´§æ€¥-bug-ä¿®å¤">ç´§æ€¥ bug ä¿®å¤&lt;/h3>
&lt;p>é€šå¸¸åœ¨ä¸€ä¸ªäº§å“çš„ Git å·¥ä½œæµä¸­ï¼Œä¼šæœ‰è‡³å°‘ä¸€ä¸ªå‘å¸ƒåˆ†æ”¯å’Œå¼€å‘ä¸»åˆ†æ”¯ã€‚å½“å‘ç°ä¸€ä¸ª bug æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°½å¿«å‘å·²å‘å¸ƒçš„äº§å“æä¾›ä¿®å¤è¡¥ä¸ï¼ŒåŒæ—¶ä¹Ÿè¦å°†è¡¥ä¸æ•´åˆåˆ°å¼€å‘ä¸»åˆ†æ”¯ä¸­ã€‚&lt;/p>
&lt;p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æˆ‘ä»¬å‘å¸ƒäº†ä¸€ä¸ªç‰ˆæœ¬å¹¶å·²ç»å¼€å§‹å¼€å‘ä¸€äº›æ–°çš„åŠŸèƒ½ï¼Œåœ¨æ–°åŠŸèƒ½å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆå‘ç°äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ bugã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç´§æ€¥ä¿®å¤æäº¤å¯¹è¿™ä¸ªé”™è¯¯è¿›è¡Œä¿®å¤ï¼Œå¹¶åœ¨å¼€å‘ä¸»åˆ†æ”¯è¿›è¡Œé›†æˆæµ‹è¯•ã€‚è¿™ä¸ªæ–°çš„è¡¥ä¸æäº¤åœ¨åˆå…¥å¼€å‘ä¸»åˆ†æ”¯åå¯ä»¥ç›´æ¥ &lt;code>cherry-pick&lt;/code> åˆ°å‘å¸ƒåˆ†æ”¯ï¼Œåœ¨å½±å“æ›´å¤šç”¨æˆ·ä¹‹å‰ä¿®å¤è¿™ä¸ª bugã€‚è¿‡ç¨‹ç¤ºæ„å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-26-2021-git-cherry-pick.gif" alt="Jan-26-2021-git-cherry-pick">&lt;/p>
&lt;p>åœ¨ä¸Šé¢çš„åŠ¨å›¾ä¸­ï¼Œæˆ‘ä»¬åœ¨å¼€å‘ä¸»åˆ†æ”¯ &lt;code>master&lt;/code> æ·»åŠ äº†ä¸€äº›æ–°çš„åŠŸèƒ½æäº¤ï¼Œä¿®å¤äº†ä¸€äº› bug å¹¶åˆå…¥äº†ä¸¤ä¸ª &lt;code>bugfix&lt;/code> åˆ†æ”¯ï¼Œç„¶ååˆå°† &lt;code>bugfix&lt;/code> åˆ†æ”¯ä¸­çš„æ‰€æœ‰æäº¤ &lt;code>cherry-pick&lt;/code> åˆ°äº† &lt;code>release&lt;/code> åˆ†æ”¯ã€‚åœ¨æœ‰äº› Git å·¥ä½œæµä¸­æƒ…å†µä¼šæœ‰æ‰€ä¸åŒï¼Œå¯èƒ½ä¼šåŸºäº &lt;code>release&lt;/code> åˆ†æ”¯åˆ›å»º &lt;code>bugfix&lt;/code> åˆ†æ”¯ï¼Œå¹¶åœ¨åˆå…¥ &lt;code>release&lt;/code> å &lt;code>cherry-pick&lt;/code> è¿™äº›æäº¤åˆ° &lt;code>master&lt;/code>ã€‚&lt;/p>
&lt;h3 id="ä»æ”¾å¼ƒçš„åˆ†æ”¯ä¸­æŒ‘å‡ºä¸ªåˆ«æäº¤">ä»æ”¾å¼ƒçš„åˆ†æ”¯ä¸­æŒ‘å‡ºä¸ªåˆ«æäº¤&lt;/h3>
&lt;p>æœ‰æ—¶å› ä¸ºéœ€æ±‚çš„å˜åŒ–ä¸€ä¸ªåŠŸèƒ½åˆ†æ”¯å¯èƒ½ä¼šè¿‡æ—¶ï¼Œè€Œä¸ä¼šè¢«åˆå¹¶åˆ°ä¸»åˆ†æ”¯ä¸­ã€‚æœ‰æ—¶ï¼Œä¸€ä¸ª &lt;code>Pull Request&lt;/code> å¯èƒ½ä¼šåœ¨æ²¡æœ‰åˆå¹¶çš„æƒ…å†µä¸‹è¢«å…³é—­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>git log&lt;/code> å’Œ &lt;code>git reflog&lt;/code> ç­‰å‘½ä»¤ï¼Œä»ä¸­æ‰¾å‡ºä¸€äº›æœ‰ç”¨çš„æäº¤ï¼Œå¹¶æŠŠå®ƒä»¬ &lt;code>cherry-pick&lt;/code> åˆ°ä¸»åˆ†æ”¯ã€‚&lt;/p>
&lt;h3 id="å…¶ä»–åœºæ™¯">å…¶ä»–åœºæ™¯&lt;/h3>
&lt;p>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ä½¿ç”¨åœºæ™¯ï¼Œæ¯”å¦‚ä½ åœ¨æ²¡æœ‰æ„è¯†åˆ°çš„æƒ…å†µä¸‹åœ¨ä¸€ä¸ªé”™è¯¯çš„åˆ†æ”¯ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæäº¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code>cherry-pick&lt;/code> å°†å…¶ç§»åŠ¨åˆ°æ­£ç¡®çš„åˆ†æ”¯ä¸Šå»ï¼›æˆ–è€…å‡ºäºæŸäº›åŸå› ä½ æƒ³å°†å›¢é˜Ÿæˆå‘˜åœ¨å¦ä¸€ä¸ªåˆ†æ”¯å¼€å‘çš„æŸä¸ªæäº¤æ‹¿åˆ°ä½ è‡ªå·±çš„åˆ†æ”¯ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚&lt;/p>
&lt;p>ä»ä»¥ä¸Šæœ‰é™çš„åœºæ™¯æ¥çœ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;code>rebase&lt;/code> æˆ–è€… &lt;code>merge&lt;/code> é…åˆ &lt;code>reset&lt;/code> ç­‰å‘½ä»¤ä¹Ÿèƒ½å®ç°åŒæ ·çš„æ•ˆæœï¼Œä½†æ˜¯ &lt;code>cherry-pick&lt;/code> çš„ä¼˜åŠ¿åœ¨äºå®ƒè¶³å¤Ÿåœ°ç®€å•ç›´æ¥ï¼Œä¸€æ¡å‘½ä»¤å°±èƒ½å®ç°åŸæœ¬éœ€è¦ä¸€ç³»åˆ—å‘½ä»¤æ¥å®ç°çš„æ“ä½œã€‚ä½†æˆ‘ä»¬ä¾ç„¶éœ€è¦è°¨æ…çš„ä½¿ç”¨ &lt;code>cherry-pick&lt;/code> ï¼Œå¹¶æ„è¯†åˆ°å®ƒçš„ä¸€äº›å±é™©ä¹‹å¤„ã€‚&lt;/p>
&lt;h2 id="æ·±å…¥ç†è§£-cherry-pick">æ·±å…¥ç†è§£ &lt;code>cherry-pick&lt;/code>&lt;/h2>
&lt;p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåˆšåˆšé€šè¿‡æäº¤ A æ·»åŠ äº† &lt;code>main.py&lt;/code> çš„ä»£ç ä»“åº“ï¼Œ&lt;code>main.py&lt;/code> çš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Hello world&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;code>new-feature&lt;/code> åˆ†æ”¯è¿›è¡Œåç»­çš„ä¿®æ”¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout -b new-feature
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæäº¤ Bï¼ŒåŠ å…¥ä¸€ä¸ªæ–°çš„æ–‡ä»¶ &lt;code>setup.py&lt;/code> å¹¶å¯¹ &lt;code>main.py&lt;/code> åšå¦‚ä¸‹ä¿®æ”¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Hello world&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Git is easy&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ¥ç€æˆ‘ä»¬åˆåˆ›å»ºäº†ä¸€ä¸ªæäº¤ Cï¼ŒåŠ å…¥ä¸€ä¸ªæ–°çš„æ–‡ä»¶ &lt;code>README.md&lt;/code> å¹¶ç»§ç»­å¯¹ &lt;code>main.py&lt;/code> æ·»åŠ ä¸€è¡Œä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Hello world&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Git is easy&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;But sometimes it can be difficult&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æœ€åæˆ‘ä»¬å†åˆ‡æ¢å›ä¸€å¼€å§‹çš„ &lt;code>master&lt;/code> ï¼Œå¹¶å¯¹ &lt;code>new-feature&lt;/code> çš„æœ€æ–°æäº¤ C æ‰§è¡Œ &lt;code>cherry-pick&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout master
$ git cherry-pick new-feature
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œè¿‡ç¨‹å¾ˆç®€å•ï¼Œå¦‚ä¸‹ç¤ºæ„ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-26-2021-git-cherry-pick2.gif" alt="Jan-26-2021-git-cherry-pick2">&lt;/p>
&lt;p>ä½†ç°åœ¨æˆ‘ä»¬æ¥çŒœä¸€çŒœï¼Œç°åœ¨çš„ &lt;code>master&lt;/code> æœ‰å‡ ä¸ªæ–‡ä»¶ï¼Ÿ &lt;code>main.py&lt;/code> ä¼šæœ‰å‡ è¡Œ &lt;code>print&lt;/code> è¯­å¥ï¼Ÿ&lt;/p>
&lt;p>æ­£ç¡®çš„ç­”æ¡ˆæ˜¯ï¼šæˆ‘ä»¬ä¼šé­é‡åˆå¹¶å†²çª ğŸ˜ã€‚åœ¨è§£å†³å†²çªåï¼Œæˆ‘ä»¬ä¼šæ‹¥æœ‰ä¸€ä¸ªä¿®æ”¹è¿‡çš„ &lt;code>main.py&lt;/code> æ–‡ä»¶ï¼Œä»¥åŠåœ¨æäº¤ C ä¸­æ–°æ·»åŠ çš„ &lt;code>README.md&lt;/code> æ–‡ä»¶ã€‚&lt;/p>
&lt;p>ä¸ºä»€ä¹ˆç»“æœä¼šæ˜¯è¿™æ ·ï¼Ÿå€Ÿæ­¤ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ¥æ·±å…¥æ¢ç©¶ä¸€ç•ª &lt;code>cherry-pick&lt;/code> å®é™…çš„æ‰§è¡Œè¿‡ç¨‹ã€‚&lt;/p>
&lt;h3 id="åº”ç”¨å“ªäº›æ›´æ”¹">åº”ç”¨å“ªäº›æ›´æ”¹&lt;/h3>
&lt;p>åœ¨ &lt;a href="https://www.waynerv.com/posts/git-undo-intro/#%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2">Git æ’¤é”€æ“ä½œæµ…æ&lt;/a>ä¸­æˆ‘ä»¬äº†è§£åˆ°æ¯ä¸€ä¸ªæäº¤éƒ½æ˜¯ä¸€ä»½å®Œæ•´çš„æ–‡ä»¶å¿«ç…§ï¼Œä½†ä»ç¤ºä¾‹æ¥çœ‹ï¼Œ&lt;code>cherry-pick&lt;/code> çš„è¿‡ç¨‹æ˜¾ç„¶å¹¶æ²¡æœ‰åº”ç”¨ç›®æ ‡æäº¤ä¸­çš„æ‰€æœ‰æ–‡ä»¶å†…å®¹ï¼ˆå¦åˆ™å½“å‰ &lt;code>master&lt;/code> å°†åŒ…å«åœ¨æäº¤ B ä¸­åŠ å…¥çš„ &lt;code>setup.py&lt;/code> æ–‡ä»¶ï¼‰ï¼Œè€Œæ˜¯ä»…ä»…å½±å“äº†ç›®æ ‡æäº¤ä¸­æ›´æ”¹è¿‡çš„æ–‡ä»¶ï¼ˆ &lt;code>README.md&lt;/code> å’Œ &lt;code>main.py&lt;/code> ï¼‰ã€‚ç”±æ­¤å¯è§ï¼Œã€Œå°†æŸä¸ªæäº¤ä»ä¸€ä¸ªåˆ†æ”¯ç§»åŠ¨åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ã€è¿™ä¸€è¯´æ³•å¹¶ä¸å‡†ç¡®ï¼Œ &lt;code>cherry-pick&lt;/code> åªä¼šåº”ç”¨åœ¨ç›®æ ‡æäº¤ä¸­å¼•å…¥çš„æ›´æ”¹ï¼Œå³åœ¨è¯¥æäº¤ä¸­æ›´æ”¹è¿‡çš„æ–‡ä»¶ã€‚&lt;/p>
&lt;h3 id="å¦‚ä½•åº”ç”¨">å¦‚ä½•åº”ç”¨&lt;/h3>
&lt;p>åœ¨ç¡®å®šäº† &lt;code>cherry-pick&lt;/code> åªä¼šåº”ç”¨ç›®æ ‡æäº¤ä¸­æ›´æ”¹è¿‡çš„æ–‡ä»¶åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹åº”ç”¨æ›´æ”¹çš„å…·ä½“è¿‡ç¨‹ã€‚ã€Œåº”ç”¨ã€åœ¨å†…éƒ¨å…¶å®å°±æ˜¯åƒ &lt;code>merge&lt;/code> ä¸€æ ·æ‰§è¡Œäº†ä¸€æ¬¡ä¸‰è·¯åˆå¹¶ã€‚å…³äº Git çš„ä¸‰è·¯åˆå¹¶ç®—æ³•æˆ‘ä»¬åœ¨ &lt;a href="https://www.waynerv.com/posts/git-merge-intro/#%E9%80%92%E5%BD%92%E4%B8%89%E8%B7%AF%E5%90%88%E5%B9%B6%E7%AE%97%E6%B3%95">Git åˆå¹¶æ“ä½œæµ…æ&lt;/a>ä¸­å·²æœ‰è¯¦ç»†ä»‹ç»ã€‚è¿™æ¬¡æˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼æ¥è¡¨ç¤ºä¸‰è·¯åˆå¹¶ä¸­çš„å„æ–¹ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ &lt;code>git cherry-pick &amp;lt;commit C&amp;gt;&lt;/code> æ—¶ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>LOCAL&lt;/strong>ï¼šåœ¨è¯¥æäº¤åŸºç¡€ä¸Šæ‰§è¡Œåˆå¹¶ï¼ˆå³å½“å‰æ‰€åœ¨åˆ†æ”¯çš„ HEADï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>REMOTE&lt;/strong>ï¼šä½ æ­£åœ¨ &lt;code>cherry-pick&lt;/code> çš„ç›®æ ‡æäº¤ï¼ˆå³ &lt;code>&amp;lt;commit C&amp;gt;&lt;/code>ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>BASE&lt;/strong>ï¼šä½ è¦ &lt;code>cherry-pick&lt;/code> çš„æäº¤çš„çˆ¶æäº¤ï¼ˆå³ C^ï¼ŒC çš„ä¸Šä¸€æ¬¡æäº¤ï¼‰ï¼Œé€šå¸¸ä¸º LOCAL å’Œ REMOTE çš„å…±åŒç¥–å…ˆæäº¤ï¼ˆä½†ä¹Ÿå¯èƒ½ä¸æ˜¯ï¼Œæ¯”å¦‚åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼‰ã€‚&lt;/li>
&lt;/ol>
&lt;p>æ‰§è¡Œ &lt;code>cherry-pick&lt;/code> æ—¶ï¼Œå°±æ˜¯ä»¥ BASE ä½œä¸ºåŸºç¡€ï¼Œä»¥ LOCAL å’Œ REMOTE ä½œä¸ºè¦åˆå¹¶çš„å†…å®¹è¿›è¡Œä¸‰è·¯åˆå¹¶ï¼Œå¹¶å°†åˆå¹¶çš„ç»“æœä½œä¸ºä¸€ä¸ªæ–°çš„æäº¤æ·»åŠ åˆ° LOCAL ä¹‹åï¼ˆç®—æ³•æ‰§è¡Œçš„å…·ä½“è¿‡ç¨‹ä¸å†èµ˜è¿°ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡ŒéªŒè¯ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>é¦–å…ˆå°†ç¤ºä¾‹ä»“åº“ Git çš„ &lt;code>merge.conflictstyle&lt;/code> æ›´æ”¹ä¸º &lt;code>diff3&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git config merge.conflictstyle diff3
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ç„¶åé‡æ–°æ‰§è¡Œä¸Šé¢çš„ç¤ºä¾‹æ­¥éª¤ï¼Œå¹¶æŸ¥çœ‹å‘ç”Ÿåˆå¹¶å†²çªçš„ &lt;code>main.py&lt;/code> çš„æ–‡ä»¶å†…å®¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="k">if&lt;/span> &lt;span class="nv">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>:
print&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Hello world&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;span class="o">&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&lt;/span>&amp;lt; HEAD
&lt;span class="o">||||||&lt;/span>&lt;span class="p">|&lt;/span> parent of 77b3860 &lt;span class="o">(&lt;/span>C&lt;span class="o">)&lt;/span>
print&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Git is easy&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;span class="o">=======&lt;/span>
print&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Git is easy&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
print&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;But sometimes it can be difficult&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt; 77b3860 &lt;span class="o">(&lt;/span>C&lt;span class="o">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç›¸æ¯”å¸¸è§„çš„ &lt;code>diff&lt;/code> å±•ç¤ºçš„ LOCAL å’Œ REMOTE ä¸¤æ–¹å¯¹æ¯”ï¼Œ&lt;code>diff3&lt;/code> ä¼šé€šè¿‡ &lt;code>|||||||&lt;/code> å¤šå±•ç¤ºä¸€æ–¹æ¥è‡ª BASE çš„å†…å®¹ã€‚ä»ç»“æœä¸­æˆ‘ä»¬å¯ä»¥ç¡®è®¤ï¼ŒBASE æ­£æ˜¯æäº¤ C çš„çˆ¶æäº¤ï¼ˆå³æäº¤ Bï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å¤„ç†å†²çª">å¤„ç†å†²çª&lt;/h3>
&lt;p>&lt;code>cherry-pick&lt;/code> å‡ºç°å†²çªæ—¶çš„å¤„ç†æ–¹å¼ä¸ &lt;code>rebase&lt;/code> å’Œ &lt;code>merge&lt;/code> ä¸€è‡´ï¼Œæˆ‘ä»¬é€šè¿‡ &lt;code>git status&lt;/code> æŸ¥çœ‹å‘ç”Ÿå†²çªçš„æ–‡ä»¶ï¼Œä¿®æ”¹è¿™äº›æ–‡ä»¶å¹¶åˆ é™¤å…¶ä¸­çš„ç‰¹æ®Šæ ‡è®°ï¼Œé€šè¿‡ &lt;code>git add&lt;/code> å°†å…¶æ ‡è®°ä¸ºå†²çªå·²è§£å†³ï¼Œæœ€å &lt;code>git commit&lt;/code> æäº¤æ›´æ”¹ã€‚&lt;/p>
&lt;p>åœ¨è§£å†³å†²çªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨è§£å†³æ‰€æœ‰å†²çªåæ‰§è¡Œ &lt;code>git cherry-pick --continue&lt;/code> æäº¤æ‰€æœ‰å†…å®¹ï¼Œä½¿ç”¨ &lt;code>git cherry-pick --skip&lt;/code> åœ¨å¤„ç†å¤šä¸ªæäº¤æ—¶è·³è¿‡æ­¤æäº¤ï¼Œæˆ–ä½¿ç”¨ &lt;code>git cherry-pick --abort&lt;/code> å–æ¶ˆ &lt;code>cherry-pick&lt;/code> æ“ä½œï¼Œæ¢å¤åˆ°æ‰§è¡Œæ“ä½œä¹‹å‰çš„çŠ¶æ€ã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>&lt;code>git cherry-pick&lt;/code> çš„ç”¨é€”å¹¶ä¸å¹¿æ³›ï¼Œåœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¼šå¾ˆæœ‰ç”¨ï¼Œä½†ç”±äºå…¶åˆå¹¶æœºåˆ¶æœ‰å¼•å…¥æ„æƒ³ä¸åˆ°çš„æ–‡ä»¶æ›´æ”¹çš„é£é™©ï¼Œåœ¨ä½¿ç”¨æ—¶æˆ‘ä»¬åº”è¯¥è°¨æ…è€ƒè™‘å¯èƒ½å‘ç”Ÿçš„ç»“æœã€‚&lt;/p>
&lt;p>&lt;code>cherry-pick&lt;/code> è¿˜æœ‰ä¸¤ä¸ªå®¹æ˜“äº§ç”Ÿçš„è¯¯è§£éœ€è¦æ¾„æ¸…ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>cherry-pick&lt;/code> å¹¶ä¸ä¼šåº”ç”¨æäº¤æ‰€ä»£è¡¨çš„æ•´ä¸ªæ–‡ä»¶å¿«ç…§ï¼Œè€Œæ˜¯åªä¼šå½±å“è¯¥åœ¨æäº¤ä¸­æ–°å¢ã€åˆ é™¤æˆ–æ›´æ”¹çš„æ–‡ä»¶ã€‚&lt;/li>
&lt;li>&lt;code>cherry-pick&lt;/code> å¹¶ä¸æ˜¯ç®€å•çš„åº”ç”¨ç›®æ ‡æäº¤ä¸å…¶çˆ¶æäº¤çš„ &lt;code>diff&lt;/code> å†…å®¹ï¼Œè€Œæ˜¯ä¼šåœ¨å†…éƒ¨ä»¥è¯¥çˆ¶æäº¤ä½œä¸ºåŸºç¡€åœ¨å½“å‰åˆ†æ”¯æŒ‡å‘æäº¤å’Œç›®æ ‡æäº¤ä¹‹é—´è¿›è¡Œä¸€æ¬¡ä¸‰è·¯åˆå¹¶ï¼Œå› æ­¤æœ‰å¯èƒ½å‘ç”Ÿåˆå¹¶å†²çªã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://git-scm.com/docs/git-cherry-pick">git-cherry-pick-documentation&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.atlassian.com/git/tutorials/cherry-pick">Git Cherry Pick Tutorial&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://think-like-a-git.net/sections/rebase-from-the-ground-up/cherry-picking-explained.html">CHERRY-PICKING EXPLAINED&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/a/52932137/10224392">what does git cherry-pick {commit-hash} do?&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/a/10058070/10224392">In a Git cherry-pick or rebase merge conflict, how are BASE (aka â€œthe ancestorâ€), LOCAL, and REMOTE determined?&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/27417656/should-diff3-be-default-conflictstyle-on-git">Should diff3 be default conflictstyle on git?&lt;/a>&lt;/li>
&lt;/ul></description><category domain="https://www.waynerv.com/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</category><category domain="https://www.waynerv.com/tags/git/">Git</category></item><item><title>Git æ’¤é”€æ“ä½œæµ…æ</title><link>https://www.waynerv.com/posts/git-undo-intro/</link><guid isPermaLink="true">https://www.waynerv.com/posts/git-undo-intro/</guid><pubDate>Sat, 09 Jan 2021 12:53:49 +0800</pubDate><author>ampedee@gmail.com (Waynerv)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œã€Œæ€æ ·æ’¤é”€ Git æäº¤ã€æ˜¯ä½ ä¸€å®šæœç´¢è¿‡çš„é—®é¢˜ï¼Œä½ ä¹Ÿè®¸å¯ä»¥ç”¨æœç´¢ç»“æœä¸­çš„å‘½ä»¤æš‚æ—¶è¿‡å…³ï¼Œä½†å´å¯èƒ½åœ¨å†æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ä¸€å¤´é›¾æ°´ï¼šä¸ºä»€ä¹ˆè¿™æ¬¡æœåˆ°çš„ç­”æ¡ˆä¸ä¸€æ ·ï¼Ÿ&lt;code>git checkout&lt;/code>ã€&lt;code>git reset&lt;/code>ã€&lt;code>git revert&lt;/code> è¿™äº›å‘½ä»¤æˆ‘åˆ°åº•è¯¥ç”¨å“ªä¸ªï¼Ÿ&lt;/p>
&lt;p>ä¹‹æ‰€ä»¥å¦‚æ­¤ï¼Œæ˜¯å› ä¸ºä½ çš„éœ€æ±‚å¹¶ä¸èƒ½ç®€å•åœ°æè¿°ä¸ºã€Œæ’¤é”€ã€æŸæ¬¡æäº¤ï¼Œè€Œå¯èƒ½æ˜¯ï¼š&lt;/p>
&lt;ul>
&lt;li>æˆ‘åœ¨æœ¬åœ°ä¿®æ”¹äº†ä¸€äº›æ–‡ä»¶è¿˜æœªæäº¤ï¼Œä½†æˆ‘æƒ³æ”¾å¼ƒæŸäº›æ–‡ä»¶çš„æ›´æ”¹ã€‚&lt;/li>
&lt;li>æˆ‘ä¸å°å¿ƒ &lt;code>git add&lt;/code> äº†é”™è¯¯çš„æ–‡ä»¶ï¼Œç°åœ¨æƒ³æŠŠå®ƒå–æ¶ˆæš‚å­˜ã€‚&lt;/li>
&lt;li>æˆ‘åˆšåˆšæ‰§è¡Œçš„æäº¤æ·»åŠ äº†ä¸è¯¥æäº¤çš„æ–‡ä»¶ï¼Œæˆ‘æƒ³å–æ¶ˆè¿™æ¬¡æäº¤ï¼Œä½†ä¿ç•™ï¼ˆæˆ–ä¸ä¿ç•™ï¼‰å¯¹æ–‡ä»¶æ‰€ä½œçš„ä¿®æ”¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯¹äºå„ç§å¤æ‚çš„æƒ…å½¢ï¼ŒGit éƒ½æä¾›äº†å¯¹åº”çš„æ–¹æ¡ˆæ¥è§£å†³ï¼Œä½†ç”±äºå‘½ä»¤å¾ˆå¤šä¸”åŒä¸€å‘½ä»¤è¿˜æœ‰å¾ˆå¤šé€‰é¡¹ï¼Œæƒ³è¦è®°ä½å®ƒä»¬ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚ä»¥ &lt;code>reset&lt;/code> ã€ &lt;code>checkout&lt;/code> ä¸ºä¾‹ï¼Œåœ¨æ·»åŠ ä¸åŒé€‰é¡¹å¹¶å¯¹ä¸åŒå‚æ•°æ‰§è¡Œåï¼Œå°±èƒ½å®ç° 6 ç§ä¸åŒä½†åˆå¾ˆå¸¸ç”¨çš„æ•ˆæœã€‚&lt;/p>
&lt;p>å¸¦ç€è¿™äº›ç–‘æƒ‘ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ‰§è¡Œè¿™äº›æ“ä½œæ—¶ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¸Œæœ›ä½ åœ¨é˜…è¯»æœ¬æ–‡åï¼Œèƒ½å¤Ÿå¯¹ Git çš„æ’¤é”€æ“ä½œè¿ç”¨è‡ªå¦‚ï¼Œè§£å†³å¤§éƒ¨åˆ†ä¸æ’¤é”€ç›¸å…³çš„å®é™…é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="git-ä¸­çš„æ’¤é”€">Git ä¸­çš„æ’¤é”€&lt;/h2>
&lt;p>é¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯ï¼ŒGit ä¸­å¹¶æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šä¼ ç»Ÿæ–‡æœ¬å¤„ç†è½¯ä»¶éƒ½ä¼šæä¾›çš„ &lt;code>undo&lt;/code> ï¼ˆæ’¤é”€ï¼‰åŠŸèƒ½ï¼ŒGit æœ¬èº«ä¹Ÿä¸æ˜¯ä¸€ä¸ªæ–‡æœ¬å¤„ç†è½¯ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªå†…å®¹å¯»å€æ–‡ä»¶ç³»ç»Ÿï¼Œä½ æ‰€æäº¤çš„æ›´æ”¹éƒ½ä¼šè¢«ä¿å­˜ã€‚å®ƒå°±åƒæ—¶å…‰æœºä¸€æ ·ï¼Œå¯ä»¥è½»æ˜“åœ°ä½¿ä¿å­˜çš„æ–‡ä»¶å›åˆ°è¿‡å»çš„æŸä¸ªçŠ¶æ€ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ï¼ŒGit åŒæ—¶ç®¡ç†ç€ä¸‰é¢—ä¸åŒçš„ã€Œæ ‘ã€çš„çŠ¶æ€ï¼Œå½“æˆ‘ä»¬è®¨è®ºã€Œæ’¤é”€ã€è¿™ä¸ªæ“ä½œæ—¶ï¼Œé™¤äº†é€‰æ‹©éœ€è¦æ¢å¤åˆ°çš„æ—¶é—´ç‚¹ï¼Œè¿˜éœ€è¦æ˜ç¡®æƒ³æ›´æ”¹å“ªå‡ é¢—æ ‘ã€‚&lt;/p>
&lt;p>å–å†³äºä½ æƒ³æ“ä½œçš„æ ‘ï¼Œä½ éœ€è¦ç”¨åˆ° &lt;code>checkout&lt;/code> ã€&lt;code>reset&lt;/code>ã€&lt;code>revert&lt;/code> ç­‰ä¸åŒçš„å‘½ä»¤ã€‚å› æ­¤åœ¨äº†è§£å…·ä½“çš„å‘½ä»¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è®¤è¯†ä¸€ä¸‹è¿™ä¸‰æ£µæ ‘ã€‚&lt;/p>
&lt;h2 id="git-çš„ä¸‰æ£µæ ‘">Git çš„ä¸‰æ£µæ ‘&lt;/h2>
&lt;p>è¿™ä¸‰æ£µæ ‘åˆ†åˆ«æ˜¯ï¼š&lt;/p>
&lt;ul>
&lt;li>å·¥ä½œåŒºï¼ˆWorking Directoryï¼‰&lt;/li>
&lt;li>æš‚å­˜åŒºï¼ˆStaging Indexï¼‰&lt;/li>
&lt;li>æäº¤å†å²ï¼ˆCommit Historyï¼‰&lt;/li>
&lt;/ul>
&lt;p>è™½ç„¶æˆ‘ä»¬ç”¨æ ‘æ¥å½¢å®¹å®ƒä»¬ï¼Œä½†éœ€è¦å…ˆæ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼Œæ ‘å¹¶ä¸ä»£è¡¨å®ƒä»¬çœŸå®çš„æ•°æ®ç»“æ„ã€‚ã€Œæ ‘ã€åœ¨è¿™é‡Œçš„å®é™…æ„æ€æ˜¯ã€Œæ–‡ä»¶çš„é›†åˆã€ï¼Œè€Œä¸æ˜¯æŒ‡ç‰¹å®šçš„æ•°æ®ç»“æ„ã€‚åœ¨æ–‡ä¸­æˆ‘ä»¬ä¸ä¼šå»æ·±å…¥æ¢ç©¶å®ƒä»¬çš„åº•å±‚ï¼Œè€Œæ˜¯é‡ç‚¹äº†è§£å®ƒä»¬çš„ä½œç”¨åŠç›¸äº’å…³ç³»ã€‚&lt;/p>
&lt;h3 id="å·¥ä½œåŒº">å·¥ä½œåŒº&lt;/h3>
&lt;p>å·¥ä½œåŒºå³å­˜æ”¾å½“å‰æ“ä½œæ–‡ä»¶çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿç›®å½•ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ªæ²™ç›’ï¼Œåœ¨å…¶ä¸­éšæ„åœ°æ·»åŠ æˆ–ç¼–è¾‘æ–‡ä»¶ï¼Œç„¶åå†å°†ä¿®æ”¹åçš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºå¹¶è®°å½•åˆ°æäº¤å†å²ä¸­ã€‚&lt;/p>
&lt;p>Git å¯ä»¥æŠŠå·¥ä½œåŒºä¸­çš„æ–‡ä»¶å¤„ç†ã€å‹ç¼©æˆä¸€ä¸ªæäº¤å¯¹è±¡ï¼Œä¹Ÿèƒ½å°†å–å¾—çš„æäº¤å¯¹è±¡è§£åŒ…æˆæ–‡ä»¶åŒæ­¥åˆ°å·¥ä½œåŒºä¸­ã€‚&lt;/p>
&lt;h3 id="æš‚å­˜åŒº">æš‚å­˜åŒº&lt;/h3>
&lt;p>æš‚å­˜åŒºä¿å­˜ç€ä¸‹ä¸€æ¬¡æ‰§è¡Œ &lt;code>git commit&lt;/code> æ—¶å°†åŠ å…¥åˆ°æäº¤å†å²ä¸­çš„å†…å®¹ã€‚&lt;/p>
&lt;p>Git æŠŠå®ƒä½œä¸ºå·¥ä½œåŒºä¸æäº¤å†å²ä¹‹é—´çš„ä¸­é—´åŒºåŸŸï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯¹æäº¤å†…å®¹è¿›è¡Œç»„ç»‡ï¼šæˆ‘ä»¬å¯èƒ½ä¼šåœ¨å·¥ä½œåŒºåŒæ—¶æ›´æ”¹å¤šä¸ªå®Œå…¨ä¸ç›¸å¹²çš„æ–‡ä»¶ï¼Œè¿™æ—¶å¯ä»¥å°†å®ƒä»¬åˆ†åˆ«æ”¾å…¥æš‚å­˜åŒºï¼Œå¹¶åœ¨ä¸åŒçš„æäº¤ä¸­åŠ å…¥æäº¤å†å²ã€‚æ­¤å¤–æš‚å­˜åŒºè¿˜ç”¨äºåˆå¹¶å†²çªæ—¶å­˜æ”¾æ–‡ä»¶çš„ä¸åŒç‰ˆæœ¬ã€‚&lt;/p>
&lt;p>é™¤éæ˜¯ä¸€ä¸ªåˆšåˆšåˆå§‹åŒ–çš„ Git ä»“åº“ï¼Œå¦åˆ™æš‚å­˜åŒºå¹¶ä¸æ˜¯ç©ºçš„ï¼Œå®ƒä¼šå¡«å……æœ€è¿‘ä¸€æ¬¡æäº¤æ‰€å¯¹åº”çš„æ–‡ä»¶å¿«ç…§ï¼Œå› æ­¤å½“æˆ‘ä»¬åŸºäºæœ€è¿‘ä¸€æ¬¡æäº¤åœ¨å·¥ä½œåŒºåšäº†ä¸€äº›ä¿®æ”¹ä¹‹åï¼Œ&lt;code>git status&lt;/code> ä¼šå°†å·¥ä½œåŒºçš„æ–‡ä»¶ä¸æš‚å­˜åŒºçš„æ–‡ä»¶å¿«ç…§è¿›è¡Œå¯¹æ¯”ï¼Œ å¹¶æç¤ºæˆ‘ä»¬æœ‰å“ªäº›åšäº†ä¿®æ”¹çš„æ–‡ä»¶å°šæœªåŠ å…¥æš‚å­˜åŒºã€‚&lt;/p>
&lt;h4 id="index-æ–‡ä»¶">Index æ–‡ä»¶&lt;/h4>
&lt;p>æš‚å­˜åŒºå¹¶ä¸åƒå·¥ä½œåŒºæœ‰å¯è§çš„æ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼Œæˆ–è€…åƒæäº¤å†å²ä¸€æ ·é€šè¿‡ &lt;code>.git/objects&lt;/code> ç›®å½•ä¿å­˜ç€æ‰€æœ‰æäº¤å¯¹è±¡ï¼Œå®ƒæ²¡æœ‰å®é™…å­˜åœ¨çš„ç›®å½•æˆ–æ–‡ä»¶å¤¹ï¼Œå®ƒçš„å®ä½“æ˜¯ä½äº &lt;code>.git&lt;/code> ç›®å½•çš„ &lt;code>index&lt;/code> æ–‡ä»¶ã€‚ &lt;code>index&lt;/code> æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒ…å«ç€ä¸€ä¸ªç”±è·¯å¾„åç§°ã€æƒé™å’Œ &lt;code>blob&lt;/code> å¯¹è±¡çš„ SHA-1 å€¼ç»„æˆçš„æœ‰åºåˆ—è¡¨ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>git ls-files&lt;/code> å‘½ä»¤æŸ¥çœ‹ &lt;code>index&lt;/code> ä¸­çš„å†…å®¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git ls-files --stage
&lt;span class="m">100644&lt;/span> 30d74d258442c7c65512eafab474568dd706c430 &lt;span class="m">0&lt;/span> README.md
&lt;span class="m">100644&lt;/span> 9c1cab9a57432098de869e202ed73161af33d182 &lt;span class="m">0&lt;/span> main.py
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>index&lt;/code> ä¸­è®°å½•äº†æš‚å­˜åŒºæ–‡ä»¶çš„è·¯å¾„åç§°å’Œ SHA-1 IDï¼Œæ–‡ä»¶å†…å®¹å·²ç»ä½œä¸º &lt;code>blob&lt;/code> å¯¹è±¡ä¿å­˜åˆ°äº† &lt;code>.git/objects&lt;/code> ç›®å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ID å–å¾—å¯¹åº”çš„ &lt;code>blob&lt;/code> å¯¹è±¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ tree .git/objects -L &lt;span class="m">2&lt;/span>
.git/objects
â”œâ”€â”€ &lt;span class="m">30&lt;/span>
â”‚Â Â  â””â”€â”€ d74d258442c7c65512eafab474568dd706c430
â”œâ”€â”€ 9c
â”‚Â Â  â””â”€â”€ 1cab9a57432098de869e202ed73161af33d182
â”œâ”€â”€ info
â””â”€â”€ pack
&lt;span class="m">4&lt;/span> directories, &lt;span class="m">2&lt;/span> files
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>blob&lt;/code> å¯¹è±¡æ˜¯ Git ç”¨æ¥ä¿å­˜æ–‡ä»¶æ•°æ®çš„äºŒè¿›åˆ¶å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ &lt;code>git cat-file&lt;/code> å‘½ä»¤æ‰“å°å…¶å†…å®¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git cat-file -p 30d74d258442c7c65512eafab474568dd706c430
This is a README file.
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å½“æˆ‘ä»¬å°†ä¸€ä¸ªä¿®æ”¹è¿‡çš„æ–‡ä»¶åŠ å…¥æš‚å­˜åŒºåï¼Œå¦‚æœåˆåœ¨å·¥ä½œåŒºå¯¹æ–‡ä»¶è¿›è¡Œäº†æ–°çš„ä¿®æ”¹ï¼Œéœ€è¦é‡æ–°å°†å…¶åŠ å…¥æš‚å­˜åŒºï¼Œå› ä¸ºæš‚å­˜åŒºä»¥ &lt;code>blob&lt;/code> å¯¹è±¡ä¿å­˜çš„åªæ˜¯æ–‡ä»¶åŠ å…¥æ—¶çš„å†…å®¹ã€‚&lt;/p>
&lt;p>åœ¨ &lt;code>index&lt;/code> æ–‡ä»¶ä¸­ï¼Œè¿˜è®°å½•äº†æ¯ä¸€ä¸ªæ–‡ä»¶çš„åˆ›å»ºæ—¶é—´å’Œæœ€åä¿®æ”¹æ—¶é—´ç­‰å…ƒä¿¡æ¯ï¼Œå®ƒé€šè¿‡å¼•ç”¨æ•°æ®å¯¹è±¡åŒ…å«äº†ä¸€ä»½å®Œæ•´çš„æ–‡ä»¶å¿«ç…§ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å¯¹æ¯” SHA-1 æ ¡éªŒå’Œå®ç°ä¸å·¥ä½œåŒºæ–‡ä»¶ä¹‹é—´çš„å¿«é€Ÿæ¯”è¾ƒã€‚&lt;/p>
&lt;h3 id="æäº¤å†å²">æäº¤å†å²&lt;/h3>
&lt;p>æäº¤å†å²æ˜¯å·¥ä½œåŒºæ–‡ä»¶åœ¨ä¸åŒæ—¶é—´çš„æ–‡ä»¶å¿«ç…§ï¼ˆå¿«ç…§å³æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åœ¨ç‰¹å®šæ—¶é—´ç‚¹çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å†…å®¹å’Œå…ƒä¿¡æ¯ï¼‰ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>git log&lt;/code> å‘½ä»¤æŸ¥çœ‹å½“å‰åˆ†æ”¯çš„æäº¤å†å²ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git log
commit ea4c48a0984880bda4031f0713229229c12793e4 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master&lt;span class="o">)&lt;/span>
Author: Waynerv &amp;lt;waynerv@notmyemail.com&amp;gt;
Date: Wed Jan &lt;span class="m">6&lt;/span> 21:05:44 &lt;span class="m">2021&lt;/span> +0800
add main file
commit b15cc74d6d85435660fcacce1305a54273880479
Author: Waynerv &amp;lt;waynerv@notmyemail.com&amp;gt;
Date: Wed Jan &lt;span class="m">6&lt;/span> 21:05:06 &lt;span class="m">2021&lt;/span> +0800
add ignore file
commit e137e9b81cc5dfc5b1c9c7d06b861553d5c42491
Author: Waynerv &amp;lt;waynerv@notmyemail.com&amp;gt;
Date: Wed Jan &lt;span class="m">6&lt;/span> 21:04:39 &lt;span class="m">2021&lt;/span> +0800
first commit
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ¯ä¸€ä¸ªæäº¤éƒ½ä¼šæœ‰ä¸€ä¸ª 40 ä½çš„ã€ŒIDã€ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">ea4c48a0984880bda4031f0713229229c12793e4
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Git é€šè¿‡ã€Œæäº¤å¯¹è±¡ã€æ¥å‚¨å­˜æ¯ä¸€æ¬¡æäº¤ã€‚è¿™ä¸ª ID æ˜¯ä»¥å¯¹è±¡å†…å®¹è¿›è¡Œ SHA-1 è®¡ç®—å¾—åˆ°çš„å“ˆå¸Œå€¼ï¼Œä¸åŒçš„å†…å®¹ä¸€å®šä¼šå¾—åˆ°ä¸åŒçš„ç»“æœï¼ŒGit æ—¢æŠŠå®ƒä½œä¸ºæ¯ä¸€ä¸ªå¯¹è±¡ï¼ˆä¸ä»…ä»…æ˜¯æäº¤å¯¹è±¡ï¼‰çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¹Ÿç”¨ä½œ &lt;code>.git/objects&lt;/code> ç›®å½•ä¸­çš„åœ°å€ï¼ˆå…¶ä¸­å­˜å‚¨ç€å®é™…çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ ID æ‰¾åˆ°å¯¹åº”çš„å¯¹è±¡å¹¶æ‰“å°å…¶å†…å®¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git cat-file -p ea4c48a0984880bda4031f0713229229c12793e4
tree 9e761342b98484aac2d8734f45fc2d0fde3e29db
parent b15cc74d6d85435660fcacce1305a54273880479
author Waynerv &amp;lt;waynerv@notmyemail.com&amp;gt; &lt;span class="m">1609938344&lt;/span> +0800
committer Waynerv &amp;lt;waynerv@notmyemail.com&amp;gt; &lt;span class="m">1609938344&lt;/span> +0800
add main application file
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™ä¸ªæäº¤å¯¹è±¡çš„å†…å®¹åŒ…å«ä¸‰éƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯¹åº”çš„ &lt;code>tree&lt;/code> å¯¹è±¡çš„ ID&lt;/li>
&lt;li>çˆ¶æäº¤å¯¹è±¡çš„ ID&lt;/li>
&lt;li>ä½œè€…ã€æäº¤è€…åŠæäº¤ä¿¡æ¯ç­‰å…ƒä¿¡æ¯&lt;/li>
&lt;/ul>
&lt;p>&lt;code>tree&lt;/code> å¯¹è±¡ä¸»è¦ç”±å…¶ä»– &lt;code>tree&lt;/code> å¯¹è±¡å’Œ &lt;code>blob&lt;/code> å¯¹è±¡çš„ ID ä»¥åŠè·¯å¾„åç§°ç»„æˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git ls-tree 9e761342b98484aac2d8734f45fc2d0fde3e29db
&lt;span class="m">100644&lt;/span> blob 723ef36f4e4f32c4560383aa5987c575a30c6535 .gitignore
&lt;span class="m">100644&lt;/span> blob 30d74d258442c7c65512eafab474568dd706c430 README.md
&lt;span class="m">100644&lt;/span> blob 9c1cab9a57432098de869e202ed73161af33d182 main.py
&lt;span class="m">040000&lt;/span> tree 556af47de72b597f532f63b63983be433f137e57 tests
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å°±åƒç›®å½•é€’å½’åœ°åŒ…å«å…¶ä»–ç›®å½•å’Œæ–‡ä»¶ä¸€æ ·ï¼Œä¸€ä¸ª &lt;code>tree&lt;/code> å¯¹è±¡å³å¯è¡¨ç¤ºæ•´ä¸ªå·¥ä½œåŒºä¸­æ‰€æœ‰å·²æäº¤ç›®å½•åŠæ–‡ä»¶çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´æäº¤å†å²ä¸­çš„æ¯ä¸€ä¸ªæäº¤éƒ½åŒ…å«ç€ä¸€ä»½å®Œæ•´çš„æŸä¸€æ—¶åˆ»çš„æ–‡ä»¶å¿«ç…§ï¼Œå¹¶é€šè¿‡ä¿å­˜ä¸Šä¸€æ¬¡æäº¤çš„å¼•ç”¨å½¢æˆè¿ç»­çš„æ–‡ä»¶å¿«ç…§å†å²ã€‚&lt;/p>
&lt;h3 id="å·¥ä½œæµç¨‹">å·¥ä½œæµç¨‹&lt;/h3>
&lt;p>åœ¨ç»§ç»­å‰ï¼Œæˆ‘ä»¬éœ€è¦ç®€å•äº†è§£ä¸‹åˆ†æ”¯å’Œ HEADã€‚&lt;/p>
&lt;p>åœ¨ Git ä¸­æˆ‘ä»¬å°† SHA-1 å€¼ç”¨åšæäº¤å¯¹è±¡ï¼ˆä»¥åŠ &lt;code>tree&lt;/code> å’Œ &lt;code>blob&lt;/code> å¯¹è±¡ï¼‰çš„ IDï¼Œé€šè¿‡ ID æ“ä½œæäº¤å¯¹è±¡ä»¥åŠæäº¤å¯¹è±¡å¼•ç”¨çš„æ–‡ä»¶å¿«ç…§ã€‚ä½†å¤§éƒ¨åˆ†æ—¶å€™ï¼Œè®°ä½ä¸€ä¸ª ID æ˜¯éå¸¸å›°éš¾çš„ï¼Œå› æ­¤ Git ç”¨ä¸€ä¸ªæ–‡ä»¶æ¥ä¿å­˜ SHA-1 å€¼ï¼Œè¿™ä¸ªæ–‡ä»¶çš„åå­—å³ä½œä¸ºã€Œå¼•ç”¨ï¼ˆrefsï¼‰ã€æ¥æ›¿ä»£åŸå§‹çš„ SHA-1 å€¼ã€‚&lt;/p>
&lt;p>è¿™ç±»åŒ…å« SHA-1 å€¼çš„æ–‡ä»¶ä¿å­˜åœ¨ &lt;code>.git/refs&lt;/code> ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ &lt;code>.git/refs/heads&lt;/code> ç›®å½•ä¸­æ‰¾åˆ°ä»£è¡¨å„ä¸ªåˆ†æ”¯å¼•ç”¨çš„æ–‡ä»¶ï¼Œå°è¯•æ‰“å° &lt;code>master&lt;/code> æ–‡ä»¶çš„å†…å®¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat .git/refs/heads/master
ea4c48a0984880bda4031f0713229229c12793e4
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™åŸºæœ¬å°±æ˜¯ Git åˆ†æ”¯çš„æœ¬è´¨ï¼šä¸€ä¸ªæŒ‡å‘æŸä¸€ç³»åˆ—æäº¤ä¹‹é¦–çš„æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬è¿˜ç”¨ HEAD æ¥æŒ‡å‘æœ€è¿‘çš„ä¸€æ¬¡æäº¤ï¼ŒHEAD æ–‡ä»¶é€šå¸¸æ˜¯ä¸€ä¸ªç¬¦å·å¼•ç”¨ï¼ˆsymbolic referenceï¼‰ï¼ŒæŒ‡å‘ç›®å‰æ‰€åœ¨çš„åˆ†æ”¯ã€‚ æ‰€è°“ç¬¦å·å¼•ç”¨ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘å…¶ä»–å¼•ç”¨çš„å¼•ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat .git/HEAD
ref: refs/heads/master
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒHEAD æ–‡ä»¶å¯èƒ½ä¼šåŒ…å«ä¸€ä¸ª git å¯¹è±¡çš„ SHA-1 å€¼ã€‚ å½“ä½ åœ¨æ£€å‡ºä¸€ä¸ªæ ‡ç­¾ã€æäº¤æˆ–è¿œç¨‹åˆ†æ”¯ï¼Œè®©ä½ çš„ä»“åº“å˜æˆÂ ã€Œ&lt;a href="https://git-scm.com/docs/git-checkout#_detached_head">åˆ†ç¦» HEAD&lt;/a>ã€çŠ¶æ€æ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout ea4c48a0984880bda4031f0713229229c12793e4
$ cat .git/HEAD
ea4c48a0984880bda4031f0713229229c12793e4
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æœ€åï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸Šæ–‡ä»‹ç»çš„ä¸‰æ£µæ ‘ä¹‹é—´çš„å·¥ä½œæµç¨‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/git-three-trees.png" alt="Untitled">&lt;/p>
&lt;ol>
&lt;li>å‡è®¾æˆ‘ä»¬è¿›å…¥åˆ°ä¸€ä¸ªæ–°ç›®å½•ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ª &lt;code>README&lt;/code> æ–‡ä»¶ã€‚æ­¤æ—¶æš‚å­˜åŒºä¸ºç©ºï¼Œæäº¤å†å²ä¸ºç©ºï¼ŒHEAD å¼•ç”¨æŒ‡å‘æœªåˆ›å»ºçš„ &lt;code>master&lt;/code> åˆ†æ”¯ã€‚&lt;/li>
&lt;li>ç°åœ¨æˆ‘ä»¬æƒ³æäº¤è¯¥æ–‡ä»¶ï¼Œé¦–å…ˆéœ€è¦é€šè¿‡ &lt;code>git add&lt;/code> å°†å…¶æ·»åŠ åˆ°æš‚å­˜åŒºã€‚æ­¤æ—¶ Git å°†åœ¨ &lt;code>.git/objects&lt;/code> ç›®å½•ä¸­ä»¥è¯¥æ–‡ä»¶çš„å†…å®¹ç”Ÿæˆä¸€ä¸ª &lt;code>blob&lt;/code> å¯¹è±¡ï¼Œå¹¶å°† &lt;code>blob&lt;/code> å¯¹è±¡çš„ä¿¡æ¯æ·»åŠ åˆ° &lt;code>.git/index&lt;/code> æ–‡ä»¶ä¸­ã€‚&lt;/li>
&lt;li>æ¥ç€è¿è¡Œ &lt;code>git commit&lt;/code> ï¼Œå®ƒä¼šå–å¾—æš‚å­˜åŒºä¸­çš„å†…å®¹ç”Ÿæˆä¸€ä¸ª &lt;code>tree&lt;/code> å¯¹è±¡ï¼Œè¯¥ &lt;code>tree&lt;/code> å¯¹è±¡å³ä¸ºå·¥ä½œåŒºæ–‡ä»¶çš„æ°¸ä¹…å¿«ç…§ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæŒ‡å‘è¯¥ &lt;code>tree&lt;/code> å¯¹è±¡çš„æäº¤å¯¹è±¡ï¼Œæœ€åæ›´æ–° &lt;code>master&lt;/code> æŒ‡å‘æœ¬æ¬¡æäº¤ã€‚&lt;/li>
&lt;li>å‡å¦‚æˆ‘ä»¬åœ¨å·¥ä½œåŒºç¼–è¾‘äº†æ–‡ä»¶ï¼ŒGit ä¼šå°†å…¶ä¸æš‚å­˜åŒºç°æœ‰æ–‡ä»¶å¿«ç…§è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨ &lt;code>git add&lt;/code> äº†æ›´æ”¹çš„æ–‡ä»¶åï¼Œæ ¹æ®æ–‡ä»¶å½“å‰å†…å®¹ç”Ÿæˆæ–°çš„ &lt;code>blob&lt;/code> å¯¹è±¡å¹¶æ›´æ–° &lt;code>.git/index&lt;/code> æ–‡ä»¶ä¸­çš„å¼•ç”¨ IDã€‚&lt;code>git commit&lt;/code> çš„è¿‡ç¨‹ä¸ä¹‹å‰ç±»ä¼¼ï¼Œä½†æ˜¯æ–°çš„æäº¤å¯¹è±¡ä¼šä»¥ HEAD å¼•ç”¨æŒ‡å‘çš„æäº¤ä½œä¸ºçˆ¶æäº¤ï¼Œç„¶åæ›´æ–°å…¶å¼•ç”¨çš„ &lt;code>master&lt;/code> æŒ‡å‘æ–°åˆ›å»ºçš„æäº¤ã€‚&lt;/li>
&lt;li>å½“æˆ‘ä»¬ &lt;code>git checkout&lt;/code> ä¸€ä¸ªåˆ†æ”¯æˆ–æäº¤æ—¶ï¼Œå®ƒä¼šä¿®æ”¹ HEAD æŒ‡å‘æ–°çš„åˆ†æ”¯å¼•ç”¨æˆ–æäº¤ï¼Œå°†æš‚å­˜åŒºå¡«å……ä¸ºè¯¥æ¬¡æäº¤çš„æ–‡ä»¶å¿«ç…§ï¼Œç„¶åå°†æš‚å­˜åŒºçš„å†…å®¹è§£åŒ…å¤åˆ¶åˆ°å·¥ä½œåŒºä¸­ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="å¸¸è§çš„æ’¤é”€å‘½ä»¤">å¸¸è§çš„ã€Œæ’¤é”€ã€å‘½ä»¤&lt;/h2>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä½¿ç”¨å¦‚ä¸‹çš„ Git ä»“åº“ä½œä¸ºåŸºå‡†ç¤ºä¾‹ï¼Œä»‹ç»ä¸€äº›å¸¸è§çš„ã€Œæ’¤é”€ã€å‘½ä»¤ã€‚å‡è®¾å·¥ä½œåŒºä¸­å·²å­˜åœ¨è¿™äº›æ–‡ä»¶ï¼Œä¸”å¼€å§‹ä»‹ç»æ¯ä¸ªå‘½ä»¤æ—¶ç¤ºä¾‹ä»“åº“éƒ½ä¼šå›åˆ°åˆå§‹çŠ¶æ€ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git init
$ git add README.md &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git commit -m &lt;span class="s2">&amp;#34;first commit&amp;#34;&lt;/span>
$ git add .gitignore &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git commit -m &lt;span class="s2">&amp;#34;add ignore file&amp;#34;&lt;/span>
$ git add main.py &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git commit -m &lt;span class="s2">&amp;#34;add main file&amp;#34;&lt;/span>
$ git log --pretty&lt;span class="o">=&lt;/span>oneline
ea4c48a &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master&lt;span class="o">)&lt;/span> add main file
b15cc74 add ignore file
e137e9b first commit
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸ºäº†æ–¹ä¾¿å±•ç¤ºæˆ‘ä»¬å°†åªå– SHA-1 ID çš„å‰ 7 ä½ï¼Œä½† Git ä¾ç„¶èƒ½å‡†ç¡®çš„æ‰¾åˆ°å¯¹åº”çš„æäº¤ã€‚&lt;/p>
&lt;h3 id="git-checkout">git checkout&lt;/h3>
&lt;p>&lt;code>checkout&lt;/code> æœ‰ä¸¤ç§å·¥ä½œæ–¹å¼ï¼šåœ¨å‘½ä»¤å‚æ•°ä¸­å¸¦æ–‡ä»¶è·¯å¾„ä¸ä¸å¸¦ã€‚ä¸¤ç§æ–¹å¼çš„å…·ä½“è¡Œä¸ºæœ‰å¾ˆå¤§åŒºåˆ«ã€‚&lt;/p>
&lt;h4 id="ä¸å¸¦è·¯å¾„">ä¸å¸¦è·¯å¾„&lt;/h4>
&lt;p>ä¸å¸¦è·¯å¾„çš„&lt;code>git checkout [commit or branch]&lt;/code> ç”¨äºã€Œæ£€å‡ºã€æŸä¸ªæäº¤æˆ–åˆ†æ”¯ï¼Œæ£€å‡ºå¯ä»¥ç†è§£ä¸ºã€Œæ‹¿å‡ºæ¥æŸ¥çœ‹ã€ï¼Œå› æ­¤è¿™ä¸ªæ“ä½œå¯¹å·¥ä½œåŒºæ˜¯å®‰å…¨çš„ã€‚&lt;code>git checkout [commit]&lt;/code> ä¼šæ›´æ–°æ‰€æœ‰çš„ä¸‰æ£µæ ‘ï¼Œä½¿å…¶å’Œ &lt;code>[commit]&lt;/code> çš„çŠ¶æ€ä¿æŒä¸€è‡´ï¼Œä½†ä¿ç•™å·¥ä½œåŒºå’Œæš‚å­˜åŒºæ‰€åšçš„æ›´æ”¹ã€‚&lt;/p>
&lt;p>å‡å¦‚æˆ‘ä»¬åœ¨å·¥ä½œåŒºæ–°å¢äº† &lt;code>tests/test.py&lt;/code> æ–‡ä»¶ï¼Œå¹¶åŠ å…¥åˆ°äº†æš‚å­˜åŒºä¸­ï¼Œç„¶å &lt;code>checkout&lt;/code> åˆ°ä¸Šä¸€ä¸ªæäº¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git add tests/test.py
$ git checkout b15cc74
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>checkout&lt;/code> å‘½ä»¤çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä»¥ä¸‹åŠ¨å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-11-2021-git-checkout.gif" alt="Jan-11-2021-git-checkout">&lt;/p>
&lt;ol>
&lt;li>
&lt;p>é¦–å…ˆ HEAD ä¼šç›´æ¥æŒ‡å‘ &lt;code>b15cc74&lt;/code> æäº¤ï¼Œè¿›å…¥åˆ†ç¦» HEAD çŠ¶æ€ï¼Œå³ä¸å†æŒ‡å‘åˆ†æ”¯å¼•ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat .git/HEAD
b15cc74
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ç„¶åå°†æå– &lt;code>b15cc74&lt;/code> æäº¤çš„æ–‡ä»¶å¿«ç…§ä¾æ¬¡æ›´æ–°åˆ°æš‚å­˜åŒºä»¥åŠå·¥ä½œåŒºã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è‹¥å·¥ä½œåŒºä¸æš‚å­˜åŒºå­˜åœ¨æœªæäº¤çš„æœ¬åœ°æ›´æ”¹ï¼Œ&lt;code>checkout&lt;/code> è¿˜ä¼šå°è¯•å°†æ–‡ä»¶å¿«ç…§ä¸æœ¬åœ°æ›´æ”¹åšç®€å•çš„åˆå¹¶ï¼Œè‹¥åˆå¹¶å¤±è´¥ï¼Œå°†ä¼šä¸­æ­¢æ“ä½œå¹¶æ¢å¤åˆ° &lt;code>checkout&lt;/code> ä¹‹å‰çš„çŠ¶æ€ã€‚å› æ­¤&lt;code>checkout&lt;/code> å¯¹å·¥ä½œåŒºæ˜¯å®‰å…¨çš„ï¼Œå®ƒä¸ä¼šä¸¢å¼ƒå·¥ä½œåŒºæ‰€åšçš„æ›´æ”¹ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;code>git commit [branch]&lt;/code> çš„æ‰§è¡Œè¿‡ç¨‹ä¸ä¸Šé¢ç±»ä¼¼ï¼Œä½†æ˜¯ HEAD ä¼šæŒ‡å‘ &lt;code>[branch]&lt;/code> è¿™ä¸ªåˆ†æ”¯å¼•ç”¨ã€‚&lt;/p>
&lt;h4 id="å¸¦è·¯å¾„">å¸¦è·¯å¾„&lt;/h4>
&lt;p>å½“ &lt;code>git checkout&lt;/code> åƒä¸‹é¢è¿™æ ·åœ¨å‘½ä»¤å‚æ•°ä¸­å¸¦æ–‡ä»¶è·¯å¾„æ—¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout b15cc74 README.md
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œè¿‡ç¨‹å¦‚å¦‚ä»¥ä¸‹åŠ¨å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-11-2021-git-checkout-file.gif" alt="Jan-11-2021-git-checkout-file">&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å®ƒä¼šæ‰¾åˆ°è¯¥æäº¤ï¼Œå¹¶åœ¨è¯¥æäº¤çš„æ–‡ä»¶å¿«ç…§ä¸­åŒ¹é…æ–‡ä»¶è·¯å¾„å¯¹åº”çš„æ–‡ä»¶ï¼Œä½†å¹¶&lt;strong>ä¸ä¼šç§»åŠ¨&lt;/strong> HEADï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat .git/HEAD
ref: refs/heads/master
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>å°†åŒ¹é…åˆ°çš„æ–‡ä»¶å¿«ç…§è¦†ç›–åˆ°æš‚å­˜åŒºä»¥åŠå·¥ä½œåŒºã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è‹¥å·¥ä½œåŒºä¸æš‚å­˜åŒºå­˜åœ¨å¯¹è¯¥æ–‡ä»¶çš„æœ¬åœ°æ›´æ”¹ï¼Œè¯¥æ›´æ”¹å°†ä¼šä¸¢å¤±ã€‚å› æ­¤&lt;code>checkout&lt;/code> å¸¦æ–‡ä»¶è·¯å¾„æ—¶å¯¹å·¥ä½œåŒºæ˜¯ä¸å®‰å…¨çš„ï¼Œå®ƒä¼šä¸¢å¼ƒå·¥ä½œåŒºå¯¹è¯¥æ–‡ä»¶æ‰€åšçš„æ›´æ”¹ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="git-reset">git reset&lt;/h3>
&lt;p>&lt;code>git reset&lt;/code> çš„ä¸»è¦ä½œç”¨æ˜¯å°† HEAD é‡ç½®ä¸ºæŒ‡å®šçš„æäº¤ã€‚ä¸ &lt;code>checkout&lt;/code> çš„åŒºåˆ«åœ¨äºï¼Œå®ƒå¯¹æäº¤å†å²çš„æ›´æ”¹å¹¶ä¸ä»…ä»…åªæ˜¯æ›´æ–° HEAD æœ¬èº«ï¼Œå¦‚æœ HEAD åŸæ¥æŒ‡å‘æŸä¸ªåˆ†æ”¯å¼•ç”¨ï¼Œåˆ™ä¼šå°†åˆ†æ”¯å¼•ç”¨ä¹Ÿæ›´æ–°ä¸ºæŒ‡å‘æ–°çš„æäº¤ã€‚&lt;/p>
&lt;p>å®ƒçš„å·¥ä½œæ–¹å¼æ›´å¤šäº†ï¼Œæœ‰ &lt;code>â€”soft&lt;/code>ã€ &lt;code>--mixed&lt;/code>ã€&lt;code>--hard&lt;/code> ä¸‰ç§ä¸»è¦çš„å‘½ä»¤é€‰é¡¹ï¼Œåˆ†åˆ«å¯¹åº”æ›´æ–°ä¸åŒæ•°é‡çš„æ ‘ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/iShot2021-01-07-git-reset.png" alt="iShot2021-01-07 22.21.30">&lt;/p>
&lt;h4 id="--soft">&lt;code>--soft&lt;/code>&lt;/h4>
&lt;p>å½“å‘½ä»¤è¡Œé€‰é¡¹ä¸º &lt;code>--soft&lt;/code> æ—¶ï¼Œ&lt;code>git reset&lt;/code> åªä¼šå¯¹æäº¤å†å²è¿›è¡Œé‡ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout master &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> cat .git/refs/heads/master
å·²ç»ä½äº &lt;span class="s1">&amp;#39;master&amp;#39;&lt;/span>
ea4c48a
$ git reset --soft b15cc74
$ git status
ä½äºåˆ†æ”¯ master
è¦æäº¤çš„å˜æ›´ï¼š
ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git restore --staged &amp;lt;æ–‡ä»¶&amp;gt;...&amp;#34;&lt;/span> ä»¥å–æ¶ˆæš‚å­˜ï¼‰
æ–°æ–‡ä»¶ï¼š main.py
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä»¥ä¸‹åŠ¨å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-11-2021-git-reset-soft.gif" alt="Jan-11-2021-git-reset-soft">&lt;/p>
&lt;ol>
&lt;li>
&lt;p>é¦–å…ˆå°† HEAD åŠå…¶æŒ‡å‘çš„åˆ†æ”¯å¼•ç”¨æŒ‡å‘ &lt;code>b15cc74&lt;/code> æäº¤ï¼Œæœ¬ç¤ºä¾‹ä¸­ HEAD åŸæœ¬æŒ‡å‘ &lt;code>master&lt;/code> ï¼Œæ‰§è¡Œæ“ä½œä¹‹åä¾ç„¶æŒ‡å‘ &lt;code>master&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat .git/HEAD
ref: refs/heads/master
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½† &lt;code>master&lt;/code> åˆ†æ”¯å¼•ç”¨å´ä»åŸæ¥æŒ‡å‘ &lt;code>ea4c48a&lt;/code> å˜æˆäº†æŒ‡å‘ &lt;code>b15cc74&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ cat .git/refs/heads/master
b15cc74
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è‹¥ HEAD åŸæœ¬å¤„äºåˆ†ç¦» HEAD çŠ¶æ€ï¼Œåˆ™åªä¼šæ›´æ–° HEAD æœ¬èº«ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>reset --soft&lt;/code> åˆ°æ­¤å°±å·²ç»ç»“æŸäº†ï¼Œå®ƒä¸ä¼šå†å¯¹æš‚å­˜åŒºä»¥åŠå·¥ä½œåŒºè¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¾ç„¶ä¿ç•™ç€åŸæ¥çš„ &lt;code>ea4c48a&lt;/code> æäº¤ä¹‹åçš„æ–‡ä»¶å¿«ç…§ä¸æ–‡ä»¶ï¼Œå› æ­¤è¿è¡Œ &lt;code>git status&lt;/code> æˆ‘ä»¬å°†çœ‹åˆ°æš‚å­˜åŒºä¸­æœ‰å¾…æäº¤çš„å˜æ›´ï¼Œå·¥ä½œåŒºå’Œæš‚å­˜åŒºä¸­çš„æœ¬åœ°æ›´æ”¹ä¹Ÿéƒ½ä¼šå¾—åˆ°ä¿ç•™ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="--mixed">&lt;code>--mixed&lt;/code>&lt;/h4>
&lt;p>&lt;code>--mixed&lt;/code> é€‰é¡¹æ˜¯ &lt;code>git reset&lt;/code> å‘½ä»¤çš„é»˜è®¤é€‰é¡¹ï¼Œ&lt;code>git reset [commit]&lt;/code> å³ç­‰åŒäº &lt;code>git reset --mixed [commit]&lt;/code>ã€‚å®ƒé™¤äº†é‡ç½®æäº¤å†å²ï¼Œè¿˜ä¼šæ›´æ–°æš‚å­˜åŒºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout master &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> cat .git/refs/heads/master
å·²ç»ä½äº &lt;span class="s1">&amp;#39;master&amp;#39;&lt;/span>
ea4c48a
$ git reset --mixed b15cc74
$ git status
ä½äºåˆ†æ”¯ master
æœªè·Ÿè¸ªçš„æ–‡ä»¶:
ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git add &amp;lt;æ–‡ä»¶&amp;gt;...&amp;#34;&lt;/span> ä»¥åŒ…å«è¦æäº¤çš„å†…å®¹ï¼‰
main.py
æäº¤ä¸ºç©ºï¼Œä½†æ˜¯å­˜åœ¨å°šæœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git add&amp;#34;&lt;/span> å»ºç«‹è·Ÿè¸ªï¼‰
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä»¥ä¸‹åŠ¨å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-11-2021-git-reset-mixed.gif" alt="Jan-11-2021-git-reset-mixed">&lt;/p>
&lt;ol>
&lt;li>æ›´æ–° HEAD æŒ‡å‘ &lt;code>b15cc74&lt;/code> æäº¤ï¼Œé‡ç½®æäº¤å†å²çš„è¿‡ç¨‹ä¸ &lt;code>--soft&lt;/code> å®Œå…¨ç›¸åŒã€‚&lt;/li>
&lt;li>ä¹‹åè¿˜ä¼šæ›´æ–°æš‚å­˜åŒºï¼Œå°†å…¶å¡«å……ä¸º &lt;code>b15cc74&lt;/code> æäº¤çš„æ–‡ä»¶å¿«ç…§ï¼Œæš‚å­˜åŒºä¸­çš„åŸæœ‰å†…å®¹å°†ä¼šä¸¢å¤±ã€‚&lt;/li>
&lt;li>ä¸ä¼šå¯¹å·¥ä½œåŒºè¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œå·¥ä½œåŒºä¾ç„¶ä¿ç•™ç€åŸæ¥çš„ &lt;code>ea4c48a&lt;/code> æäº¤ä¹‹åçš„æ–‡ä»¶ï¼Œå› æ­¤è¿è¡Œ &lt;code>git status&lt;/code> æˆ‘ä»¬å°†çœ‹åˆ°æœ‰æœªè·Ÿè¸ªçš„æ–‡ä»¶å¾…åŠ å…¥æš‚å­˜åŒºï¼Œå·¥ä½œåŒºä¸­çš„æœ¬åœ°æ›´æ”¹ä¹Ÿä¼šå¾—åˆ°ä¿ç•™ã€‚&lt;/li>
&lt;/ol>
&lt;h4 id="--hard">&lt;code>--hard&lt;/code>&lt;/h4>
&lt;p>&lt;code>--hard&lt;/code> æ˜¯ &lt;code>reset&lt;/code> æœ€&lt;strong>ç›´æ¥&lt;/strong>ã€æœ€&lt;strong>å±é™©&lt;/strong>ä»¥åŠæœ€&lt;strong>å¸¸ç”¨&lt;/strong>çš„é€‰é¡¹ã€‚ &lt;code>git reset â€”hard [commit]&lt;/code> ä¼šå°†æ‰€æœ‰çš„ä¸‰æ£µæ ‘éƒ½æ›´æ–°ä¸ºæŒ‡å®šæäº¤çš„çŠ¶æ€ï¼Œå·¥ä½œåŒºå’Œæš‚å­˜åŒºä¸­æ‰€æœ‰æœªæäº¤çš„æ›´æ”¹éƒ½ä¼šæ°¸ä¹…ä¸¢å¤±ï¼Œä½†è¢«é‡ç½®çš„æäº¤ä»æœ‰åŠæ³•æ‰¾å›ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬åŒæ ·æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git checkout master &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> cat .git/refs/heads/master
å·²ç»ä½äº &lt;span class="s1">&amp;#39;master&amp;#39;&lt;/span>
ea4c48a
$ git reset --hard b15cc74
HEAD ç°åœ¨ä½äº b15cc74 add gitignore file
$ git status
ä½äºåˆ†æ”¯ master
æ— æ–‡ä»¶è¦æäº¤ï¼Œå¹²å‡€çš„å·¥ä½œåŒº
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä»¥ä¸‹åŠ¨å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-11-2021-git-reset-hard.gif" alt="Jan-11-2021-git-reset-hard">&lt;/p>
&lt;ol>
&lt;li>æ›´æ–° HEAD æŒ‡å‘ &lt;code>b15cc74&lt;/code> æäº¤ï¼Œé‡ç½®æäº¤å†å²çš„è¿‡ç¨‹ä¸ &lt;code>--soft&lt;/code> åŠ &lt;code>--mixed&lt;/code> é€‰é¡¹ç›¸åŒã€‚&lt;/li>
&lt;li>æ›´æ–°æš‚å­˜åŒºï¼Œå°†å…¶å¡«å……ä¸º &lt;code>b15cc74&lt;/code> æäº¤çš„æ–‡ä»¶å¿«ç…§ï¼Œæš‚å­˜åŒºä¸­çš„åŸæœ‰å†…å®¹å°†ä¼šä¸¢å¤±ã€‚&lt;/li>
&lt;li>æ›´æ–°å·¥ä½œåŒºï¼Œå°†å…¶å¡«å……ä¸º &lt;code>b15cc74&lt;/code> æäº¤çš„æ–‡ä»¶å¿«ç…§ï¼Œå·¥ä½œåŒºä¸­çš„åŸæœ‰å†…å®¹å°†ä¼šä¸¢å¤±ã€‚&lt;/li>
&lt;/ol>
&lt;p>æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œ&lt;code>reset â€”hard&lt;/code> ä¼šå°†å·¥ä½œåŒºã€æš‚å­˜åŒºå’Œæäº¤å†å²éƒ½é‡ç½®ä¸ºåˆšåˆšæ–°å¢äº† &lt;code>b15cc74&lt;/code> æäº¤æ—¶çš„çŠ¶æ€ï¼Œå¹¶ç®€å•ç²—æš´åœ°è¦†ç›–æ‰å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„åŸæœ‰å†…å®¹ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„æ“ä½œï¼Œå› ä¸ºå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„æœªæäº¤æ›´æ”¹ä¸¢å¤±åæ— æ³•å†é€šè¿‡ Git æ‰¾å›ã€‚&lt;/p>
&lt;h4 id="æ‰¾å›æäº¤å†å²">æ‰¾å›æäº¤å†å²&lt;/h4>
&lt;p>&lt;code>reset&lt;/code> åä¸¢å¤±çš„æäº¤å†å²ä»ç„¶èƒ½å¤Ÿæ¢å¤ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯æ›´æ–°äº† HEAD æŒ‡å‘çš„æäº¤ï¼Œè€Œæ²¡æœ‰å¯¹å®é™…çš„æäº¤å¯¹è±¡åšä»»ä½•æ›´æ”¹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>git reflog&lt;/code> æ‰¾åˆ° HEAD æ›¾ç»æŒ‡å‘è¿‡çš„æäº¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git reflog
b15cc74 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master&lt;span class="o">)&lt;/span> HEAD@&lt;span class="o">{&lt;/span>0&lt;span class="o">}&lt;/span>: reset: moving to b15cc74
ea4c48a HEAD@&lt;span class="o">{&lt;/span>1&lt;span class="o">}&lt;/span>: checkout: moving from master to master
......
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä»ä¸­å¯ä»¥æ‰¾åˆ° &lt;code>master&lt;/code> åŸæ¥æ‰€æŒ‡å‘çš„ &lt;code>ea4c48a&lt;/code> æäº¤ï¼Œå†æ‰§è¡Œ &lt;code>git reset --hard ea4c48a&lt;/code> å°±èƒ½æ¢å¤åŸæ¥çš„æäº¤å†å²ã€‚&lt;/p>
&lt;h4 id="ä¸è¦-reset-å…¬å…±åˆ†æ”¯">ä¸è¦ reset å…¬å…±åˆ†æ”¯&lt;/h4>
&lt;p>å¦ä¸€ä¸ªå…³äº &lt;code>reset&lt;/code>çš„å®è·µæ˜¯ï¼Œä¸è¦åœ¨å…¬å…±åˆ†æ”¯ä¸Šæ‰§è¡Œ &lt;code>reset&lt;/code>ã€‚å…¬å…±åˆ†æ”¯æ˜¯æŒ‡ä½ ä¸å…¶ä»–å›¢é˜Ÿæˆå‘˜åä½œå¼€å‘çš„åˆ†æ”¯ã€‚&lt;/p>
&lt;p>å½“ä»»ä½•æäº¤è¢«æ¨é€åˆ°å…¬å…±åˆ†æ”¯åï¼Œå¿…é¡»å‡è®¾å…¶ä»–å¼€å‘è€…å·²ç»ä¾èµ–å®ƒã€‚åˆ é™¤å…¶ä»–äººå·²ç»åœ¨ç»§ç»­å¼€å‘çš„æäº¤ï¼Œä¼šç»™åä½œå¸¦æ¥ä¸¥é‡çš„é—®é¢˜ã€‚è€Œä¸”ä½ éœ€è¦å¼ºåˆ¶æ¨é€æ‰èƒ½å°†ä½  &lt;code>reset&lt;/code> åçš„åˆ†æ”¯æäº¤åˆ°è¿œç¨‹ä»“åº“ï¼Œå½“å…¶ä»–äººæ‹‰å–è¿™ä¸ªå…¬å…±åˆ†æ”¯æ—¶ï¼Œä»–ä»¬çš„æäº¤å†å²ä¼šçªç„¶æ¶ˆå¤±ä¸€éƒ¨åˆ†ã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œè¯·ç¡®ä¿åœ¨æœ¬åœ°çš„å®éªŒåˆ†æ”¯ä¸Šä½¿ç”¨ &lt;code>git reset&lt;/code>ï¼Œè€Œä¸è¦é‡ç½®å·²ç»å‘å¸ƒåˆ°å…¬å…±åˆ†æ”¯çš„æäº¤ã€‚å¦‚æœä½ éœ€è¦ä¿®å¤ä¸€ä¸ªå…¬å…±æäº¤å¼•å…¥çš„é—®é¢˜ï¼Œè¯·çœ‹ä¹‹åå°†ä»‹ç»çš„ä¸“é—¨ä¸ºæ­¤ç›®çš„è®¾è®¡çš„ &lt;code>git revert&lt;/code>ã€‚&lt;/p>
&lt;h4 id="å–æ¶ˆæš‚å­˜æ–‡ä»¶">å–æ¶ˆæš‚å­˜æ–‡ä»¶&lt;/h4>
&lt;p>å’Œ &lt;code>checkout&lt;/code> ä¸€æ ·ï¼Œ&lt;code>git reset&lt;/code> ä¹Ÿèƒ½å¯¹æ–‡ä»¶è·¯å¾„æ‰§è¡Œï¼Œå¸¸ç”¨äºå°†å·²åŠ å…¥æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶é›†åˆå–æ¶ˆæš‚å­˜ã€‚&lt;/p>
&lt;p>å‡è®¾æˆ‘ä»¬åœ¨å·¥ä½œåŒºæ–°å¢äº† &lt;code>hello.py&lt;/code> å’Œ &lt;code>world.py&lt;/code> ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶åŒæ—¶åŠ å…¥äº†æš‚å­˜åŒºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git add .
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç°åœ¨æˆ‘ä»¬æ„è¯†åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸åº”è¯¥æ”¾åœ¨ä¸€ä¸ªæäº¤ä¸­ï¼Œå› æ­¤éœ€è¦å°†å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶å–æ¶ˆæš‚å­˜ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git reset world.py
$ git status
ä½äºåˆ†æ”¯ master
æ‚¨çš„åˆ†æ”¯ä¸ä¸Šæ¸¸åˆ†æ”¯ &lt;span class="s1">&amp;#39;origin/master&amp;#39;&lt;/span> ä¸€è‡´ã€‚
è¦æäº¤çš„å˜æ›´ï¼š
ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git restore --staged &amp;lt;æ–‡ä»¶&amp;gt;...&amp;#34;&lt;/span> ä»¥å–æ¶ˆæš‚å­˜ï¼‰
æ–°æ–‡ä»¶ï¼š hello.py
æœªè·Ÿè¸ªçš„æ–‡ä»¶:
ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git add &amp;lt;æ–‡ä»¶&amp;gt;...&amp;#34;&lt;/span> ä»¥åŒ…å«è¦æäº¤çš„å†…å®¹ï¼‰
world.py
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ­¤æ—¶æš‚å­˜åŒºä¸­åªæœ‰ &lt;code>hello.py&lt;/code> æ–‡ä»¶äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«æäº¤å®ƒä»¬ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git commit -m &lt;span class="s2">&amp;#34;add hello.py&amp;#34;&lt;/span>
&lt;span class="c1"># åœ¨å¦ä¸€ä¸ªæäº¤ä¸­æäº¤ world.py&lt;/span>
$ git add world.py
$ git commit -m &lt;span class="s2">&amp;#34;add world.py&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®é™…ä¸Š &lt;code>reset&lt;/code> å¸¦æ–‡ä»¶è·¯å¾„å‘½ä»¤çš„å®Œæ•´å½¢å¼æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git reset &lt;span class="o">[&lt;/span>&amp;lt;tree-ish&amp;gt;&lt;span class="o">]&lt;/span> &amp;lt;pathspec&amp;gt;â€¦
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯¥æ“ä½œçš„å®è´¨ï¼Œæ˜¯ä» &lt;code>&amp;lt;tree-ish&amp;gt;&lt;/code> æå– &lt;code>&amp;lt;pathspec&amp;gt;&lt;/code> å¯¹åº”çš„æ–‡ä»¶å¿«ç…§æ›´æ–°åˆ°æš‚å­˜åŒºï¼Œ&lt;code>&amp;lt;tree-ish&amp;gt;&lt;/code>å¯ä»¥æ˜¯æäº¤æˆ–åˆ†æ”¯ï¼Œé»˜è®¤å€¼ä¸º HEADï¼Œå› æ­¤é»˜è®¤ä¼šå°†æš‚å­˜åŒºçš„æŒ‡å®šè·¯å¾„æ¢å¤åˆ° HEAD æäº¤çš„çŠ¶æ€ã€‚ &lt;code>git reset world.py&lt;/code> å‘½ä»¤çš„å®é™…è¿‡ç¨‹æ˜¯ï¼š&lt;/p>
&lt;ol>
&lt;li>ä» HEAD æäº¤ä¸­åŒ¹é… &lt;code>world.py&lt;/code> å¯¹åº”çš„æ–‡ä»¶å¿«ç…§ã€‚&lt;/li>
&lt;li>å°†åŒ¹é…åˆ°çš„æ–‡ä»¶å¿«ç…§å¤åˆ¶åˆ°æš‚å­˜åŒºã€‚&lt;/li>
&lt;/ol>
&lt;p>å› æ­¤ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº†æŸä¸ªæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œ&lt;code>reset&lt;/code> åä¼šè¢«æ›¿æ¢æˆåŸæœ¬çš„æ–‡ä»¶ç‰ˆæœ¬ï¼›æ–°å¢çš„æ–‡ä»¶ä¼šä»æš‚å­˜åŒºä¸­ç§»é™¤ï¼ˆå› ä¸ºä¸Šä¸€æ¬¡æäº¤ä¸­æ²¡æœ‰è¯¥æ–‡ä»¶ï¼‰ï¼Œå®é™…å®ç°äº†å°†æ–‡ä»¶å–æ¶ˆæš‚å­˜çš„æ•ˆæœã€‚&lt;/p>
&lt;h3 id="git-revert">git revert&lt;/h3>
&lt;p>&lt;code>git revert&lt;/code> å‘½ä»¤ç”¨äºå›æ»šæŸä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰æäº¤å¼•å…¥çš„æ›´æ”¹ã€‚&lt;/p>
&lt;p>å…¶ä»–çš„ã€Œæ’¤é”€ã€å‘½ä»¤å¦‚ &lt;code>git checkout&lt;/code> å’Œ &lt;code>git reset&lt;/code>ï¼Œä¼šå°† HEAD æˆ–åˆ†æ”¯å¼•ç”¨é‡æ–°æŒ‡å‘åˆ°æŒ‡å®šçš„æäº¤ï¼Œ&lt;code>git revert&lt;/code> å‘½ä»¤ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæŒ‡å®šçš„æäº¤ï¼Œä½†å¹¶ä¸ä¼šå°†ä»»ä½•å¼•ç”¨ç§»åŠ¨åˆ°è¿™ä¸ªæäº¤ä¸Šã€‚&lt;code>revert&lt;/code> æ“ä½œä¼šæ¥æ”¶æŒ‡å®šçš„æäº¤ï¼Œåè½¬è¯¥æäº¤å¼•å…¥çš„æ›´æ”¹ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ã€Œå›æ»šæäº¤ã€è®°å½•åè½¬æ›´æ”¹ï¼Œç„¶åæ›´æ–°åˆ†æ”¯å¼•ç”¨ï¼Œä½¿å…¶æŒ‡å‘è¯¥æäº¤ã€‚å¦‚ä»¥ä¸‹åŠ¨å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Jan-11-2021-git-revert.gif" alt="Jan-11-2021-git-revert">&lt;/p>
&lt;p>ç›¸æ¯” &lt;code>reset&lt;/code> ï¼Œ&lt;code>revert&lt;/code> ä¼šåœ¨æäº¤å†å²ä¸­å¢åŠ ä¸€ä¸ªæ–°çš„æäº¤ï¼Œè€Œä¸ä¼šå¯¹ä¹‹å‰çš„æäº¤è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚ é»˜è®¤æƒ…å†µä¸‹ &lt;code>revert&lt;/code> ä¼šè‡ªåŠ¨æ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š&lt;/p>
&lt;ul>
&lt;li>å°†åè½¬æŒ‡å®šæäº¤çš„æ›´æ”¹åˆå¹¶åˆ°å·¥ä½œåŒº&lt;/li>
&lt;li>å°†æ›´æ”¹æ·»åŠ åˆ°æš‚å­˜åŒº&lt;/li>
&lt;li>åˆ›å»ºæ–°çš„æäº¤&lt;/li>
&lt;/ul>
&lt;p>å› æ­¤å®ƒè¦æ±‚æˆ‘ä»¬æä¾›ä¸€ä¸ªå¹²å‡€çš„æš‚å­˜åŒºï¼ˆå³å’Œ HEAD æäº¤çŠ¶æ€ä¸€è‡´ï¼‰ï¼Œä¸”è¦æ±‚å·¥ä½œåŒºçš„æœ¬åœ°æ›´æ”¹ä¸ä¼šè¢«åˆå¹¶æ“ä½œè¦†ç›–ï¼Œå¦åˆ™å›æ»šä¼šå¤±è´¥ã€‚æˆ‘ä»¬å¯ä»¥æ·»åŠ  &lt;code>--no-commit&lt;/code> å‘½ä»¤é€‰é¡¹æ¥è¿›å…¥äº¤äº’æ¨¡å¼æ‰‹åŠ¨æ‰§è¡Œã€Œåˆ›å»ºæ–°çš„æäº¤ã€ï¼Œæ­¤æ—¶ &lt;code>revert&lt;/code> æ“ä½œä¼šå°†åè½¬çš„æ›´æ”¹åº”ç”¨åˆ°å·¥ä½œåŒºå’Œæš‚å­˜åŒºç­‰å¾…æäº¤ï¼Œä¸”ä¸è¦æ±‚æš‚å­˜åŒºä¸ HEAD ä¸€è‡´ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬é€šè¿‡ç¤ºä¾‹æ¥æ¼”ç¤ºè¿™ä¸€è¿‡ç¨‹ï¼Œç°åœ¨æˆ‘ä»¬æƒ³å›æ»š &lt;code>b15cc74&lt;/code> è¿™ä¸ªæäº¤ï¼Œè¿™ä¸ªæäº¤ä¸­åŠ å…¥äº† &lt;code>.gitignore&lt;/code> æ–‡ä»¶ï¼Œé¢„æœŸçš„ç»“æœæ˜¯ä¼šæ–°å¢ä¸€ä¸ªåˆ é™¤è¯¥æ–‡ä»¶çš„æäº¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git revert b15cc74
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åœ¨ç»ˆç«¯æ‰§è¡Œè¯¥å‘½ä»¤åå°†ç›´æ¥è·³è½¬åˆ°ä¸€ä¸ªç¼–è¾‘å™¨ç•Œé¢ï¼Œå¯ä»¥ä¿®æ”¹æ–°æäº¤çš„æäº¤ä¿¡æ¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">Revert &lt;span class="s2">&amp;#34;add gitignore file&amp;#34;&lt;/span>
This reverts commit b15cc74d6d85435660fcacce1305a54273880479.
&lt;span class="c1"># è¯·ä¸ºæ‚¨çš„å˜æ›´è¾“å…¥æäº¤è¯´æ˜ã€‚ä»¥ &amp;#39;#&amp;#39; å¼€å§‹çš„è¡Œå°†è¢«å¿½ç•¥ï¼Œè€Œä¸€ä¸ªç©ºçš„æäº¤&lt;/span>
&lt;span class="c1"># è¯´æ˜å°†ä¼šç»ˆæ­¢æäº¤ã€‚&lt;/span>
......
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¿å­˜å &lt;code>revert&lt;/code> å‘½ä»¤æ‰§è¡Œç»“æŸï¼Œå¹¶è¾“å‡ºä»¥ä¸‹ç»“æœï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">åˆ é™¤ .gitignore
&lt;span class="o">[&lt;/span>master 6bb25da&lt;span class="o">]&lt;/span> Revert &lt;span class="s2">&amp;#34;add gitignore file&amp;#34;&lt;/span>
&lt;span class="m">1&lt;/span> file changed, &lt;span class="m">1&lt;/span> deletion&lt;span class="o">(&lt;/span>-&lt;span class="o">)&lt;/span>
delete mode &lt;span class="m">100644&lt;/span> .gitignore
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç»“æœç¬¦åˆé¢„æœŸï¼Œæ–°å¢äº†ä¸€ä¸ªåˆ é™¤ &lt;code>.gitignore&lt;/code> æ–‡ä»¶çš„ &lt;code>6bb25da&lt;/code> æäº¤ï¼Œå¹¶ä¸” &lt;code>master&lt;/code> å½“å‰æŒ‡å‘äº†è¯¥æäº¤ã€‚&lt;/p>
&lt;p>ä½†å¦‚æœæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å¯¹å·¥ä½œåŒºä¸­çš„æ–‡ä»¶åšè¿‡æ›´æ”¹ä¸”åŠ å…¥åˆ°äº†æš‚å­˜åŒºï¼Œæ‰§è¡Œ &lt;code>revert&lt;/code> çš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git revert b15cc74
error: æ‚¨çš„æœ¬åœ°ä¿®æ”¹å°†è¢«è¿˜åŸè¦†ç›–ã€‚
æç¤ºï¼šæäº¤æ‚¨çš„ä¿®æ”¹æˆ–è´®è—åå†ç»§ç»­ã€‚
fatal: è¿˜åŸå¤±è´¥
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="revert-çš„ä¼˜åŠ¿">revert çš„ä¼˜åŠ¿&lt;/h4>
&lt;p>è™½ç„¶æ•ˆæœä¸ &lt;code>reset&lt;/code> ç›¸ä¼¼ï¼Œä½†ä½¿ç”¨ &lt;code>revert&lt;/code> æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š&lt;/p>
&lt;ul>
&lt;li>å®ƒä¸ä¼šæ”¹å˜ä¹‹å‰çš„æäº¤å†å²ï¼Œè¿™ä½¿å¾— &lt;code>revert&lt;/code> å¯¹äºå·²ç»æ¨é€åˆ°å…±äº«ä»“åº“çš„æäº¤æ˜¯ä¸€ä¸ªã€Œå®‰å…¨ã€çš„æ“ä½œï¼Œå®ƒä¼šå®Œæ•´çš„è®°å½•æŸä¸ªæäº¤è¢«åŠ å…¥åŠå›æ»šçš„è¿‡ç¨‹ã€‚&lt;/li>
&lt;li>å®ƒå¯ä»¥å›æ»šæäº¤å†å²ä¸Šä»»æ„ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç‚¹çš„æäº¤ï¼Œè€Œ &lt;code>reset&lt;/code> åªèƒ½é‡ç½®ä»æŒ‡å®šæäº¤èµ·ä¹‹åçš„æ‰€æœ‰å†å²ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯&lt;/h3>
&lt;p>æˆ‘ä»¬åˆ†åˆ«ä»‹ç»äº† &lt;code>checkout&lt;/code> ã€&lt;code>reset&lt;/code> ã€&lt;code>revert&lt;/code> ä¸‰ä¸ªå‘½ä»¤çš„ä¸»è¦ç”¨æ³•ï¼Œä¸‹é¢çš„è¡¨æ ¼æ¦‚æ‹¬äº†å®ƒä»¬çš„å¸¸è§ä½¿ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">å‘½ä»¤&lt;/th>
&lt;th>ä½œç”¨å¯¹è±¡&lt;/th>
&lt;th>å¸¸ç”¨åœºæ™¯&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">&lt;code>git reset&lt;/code>&lt;/td>
&lt;td>æäº¤&lt;/td>
&lt;td>æ”¾å¼ƒç§äººåˆ†æ”¯ä¸Šçš„æäº¤æˆ–è€…è¿˜æœªæäº¤çš„æœ¬åœ°æ›´æ”¹&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">&lt;code>git reset&lt;/code>&lt;/td>
&lt;td>æ–‡ä»¶&lt;/td>
&lt;td>å°†ä¸€ä¸ªæ–‡ä»¶å–æ¶ˆæš‚å­˜&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">&lt;code>git checkout&lt;/code>&lt;/td>
&lt;td>æäº¤&lt;/td>
&lt;td>åˆ‡æ¢åˆ†æ”¯æˆ–è€…æŸ¥çœ‹ä¸€ä¸ªä¹‹å‰çš„æäº¤&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">&lt;code>git checkout&lt;/code>&lt;/td>
&lt;td>æ–‡ä»¶&lt;/td>
&lt;td>å°†æ–‡ä»¶æ¢å¤åˆ°æŒ‡å®šæäº¤æ—¶çš„çŠ¶æ€å¹¶ä¸¢å¼ƒåœ¨å·¥ä½œåŒºä¸­å¯¹è¯¥æ–‡ä»¶çš„æ›´æ”¹&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">&lt;code>git revert&lt;/code>&lt;/td>
&lt;td>æäº¤&lt;/td>
&lt;td>åœ¨å…¬å…±åˆ†æ”¯ä¸Šæ’¤é”€ä¸€ä¸ªæäº¤&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">&lt;code>git revert&lt;/code>&lt;/td>
&lt;td>æ–‡ä»¶&lt;/td>
&lt;td>æ— &lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="å…¶ä»–æ›¿ä»£å‘½ä»¤">å…¶ä»–æ›¿ä»£å‘½ä»¤&lt;/h2>
&lt;p>æˆ‘ä»¬ä»‹ç»äº† &lt;code>checkout&lt;/code> ã€&lt;code>reset&lt;/code> ã€&lt;code>revert&lt;/code> ä¸‰ä¸ªå‘½ä»¤å…± 7 ç§å’Œæ’¤é”€ç›¸å…³çš„ç”¨æ³•ï¼Œè€Œè¿™äº›å‘½ä»¤è¿˜æœ‰è®¸å¤šå…¶ä»–çš„é€‰é¡¹å’Œç”¨é€”ï¼Œåœ¨ä½¿ç”¨è¿™äº›å‘½ä»¤æ—¶ï¼Œå³ä½¿æ˜¯è€æ‰‹ä¹Ÿå¯èƒ½éœ€è¦ä¸æ—¶åœ°å¯¹ç…§æ‰‹å†Œã€‚ä¹Ÿè®¸æ˜¯æ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼ŒGit åœ¨ 2.23 ç‰ˆæœ¬ä¸­åˆå‘å¸ƒäº† &lt;code>resetore&lt;/code> å’Œ &lt;code>switch&lt;/code> ä¸¤ä¸ªæ–°å‘½ä»¤ï¼Œæ–°å‘½ä»¤èƒ½æ›¿ä»£ä¸Šé¢çš„éƒ¨åˆ†ç”¨æ³•ä¸”ç”¨é€”æ›´ä¸ºä¸“ä¸€ã€‚&lt;/p>
&lt;h3 id="git-restore">git restore&lt;/h3>
&lt;p>&lt;code>restore&lt;/code> å‘½ä»¤ç”¨äºè¿˜åŸå·¥ä½œåŒºæˆ–æš‚å­˜åŒºä¸­çš„æŒ‡å®šæ–‡ä»¶æˆ–æ–‡ä»¶é›†åˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git restore &lt;span class="o">[&lt;/span>--source&lt;span class="o">=&lt;/span>&amp;lt;tree&amp;gt;&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--staged&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--worktree&lt;span class="o">]&lt;/span> &amp;lt;pathspec&amp;gt;â€¦
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä»å®šä¹‰å’Œå‘½ä»¤è¡Œå½¢å¼æ¥ç†è§£ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿˜åŸå³æ¢å¤åˆ°è¿‡å»æŸä¸€çŠ¶æ€ï¼Œæ„å‘³ç€è¯¥å‘½ä»¤éœ€è¦æŒ‡å®šå·²æœ‰çš„æŸä¸ªæ–‡ä»¶å¿«ç…§ï¼ˆæäº¤ã€åˆ†æ”¯ç­‰ï¼‰ä½œä¸ºæ•°æ®æºï¼Œé€šè¿‡ &lt;code>source&lt;/code> é€‰é¡¹è®¾ç½®ã€‚&lt;/li>
&lt;li>å¯ä»¥é€‰æ‹©å¯¹å·¥ä½œåŒºï¼ˆ&lt;code>--worktree&lt;/code> ï¼‰ã€æš‚å­˜åŒºï¼ˆ&lt;code>--staged&lt;/code> ï¼‰æˆ–ä¸¤è€…åŒæ—¶ç”Ÿæ•ˆï¼Œé»˜è®¤å€¼ä¸ºä»…å·¥ä½œåŒºã€‚å½“æŒ‡å®šçš„ä½ç½®ä¸ºå·¥ä½œåŒºæ—¶ï¼Œé»˜è®¤æ•°æ®æºä¸ºæš‚å­˜åŒºçš„æ–‡ä»¶å¿«ç…§ï¼›å½“æŒ‡å®šçš„ä½ç½®åŒ…å«æš‚å­˜åŒºæ—¶ï¼Œé»˜è®¤æ•°æ®æºä¸º HEADã€‚&lt;/li>
&lt;li>å¯ä»¥é€‰æ‹©å¯¹æŒ‡å®šçš„æ–‡ä»¶æˆ–ä¸€äº›æ–‡ä»¶ç”Ÿæ•ˆï¼Œé€šè¿‡ &lt;code>&amp;lt;pathspec&amp;gt;&lt;/code> å‚æ•°æŒ‡å®šã€‚&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„ Git ä»“åº“ä½œä¸ºç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬ä¿®æ”¹äº† &lt;code>main.py&lt;/code> å¹¶å·²ç»åŠ å…¥åˆ°äº†æš‚å­˜åŒºï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>æˆ‘ä»¬æƒ³å°† &lt;code>main.py&lt;/code> å–æ¶ˆæš‚å­˜ï¼Œå³å°†æš‚å­˜åŒºä¸­çš„ &lt;code>main.py&lt;/code> è¿˜åŸä¸º HEAD ä¸­çš„å†…å®¹ï¼Œæ­¤æ—¶ HEAD æ˜¯é»˜è®¤çš„ &lt;code>source&lt;/code> ï¼Œå› æ­¤å¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git restore --staged main.py
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯¥æ–‡ä»¶å°†è¢«å–æ¶ˆæš‚å­˜ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç°åœ¨æˆ‘ä»¬æƒ³æ”¾å¼ƒå·¥ä½œåŒºä¸­å¯¹è¯¥æ–‡ä»¶çš„æ›´æ”¹ï¼Œå¯ä»¥é€‰æ‹©å°†å…¶è¿˜åŸä¸ºæš‚å­˜åŒºä¸­çš„å†…å®¹ï¼Œå› ä¸ºæ­¤æ—¶æš‚å­˜åŒºä¸­çš„å†…å®¹å’Œ HEAD ç›¸åŒï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git resetore main.py
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>è¿™åªæ˜¯æœ€åŸºç¡€çš„ç”¨æ³•ï¼Œè¿˜å¯ä»¥æŒ‡å®š &lt;code>--source&lt;/code> ä¸ºä»»æ„æäº¤ ID å°†æ–‡ä»¶è¿˜åŸä¸ºè¯¥æäº¤ä¸­çš„çŠ¶æ€ã€‚&lt;/p>
&lt;p>&lt;code>git restore [--source=&amp;lt;tree-ish&amp;gt;] --staged &amp;lt;pathspec&amp;gt;...&lt;/code> å’Œ &lt;code>git reset [&amp;lt;tree-ish&amp;gt;] &amp;lt;pathspec&amp;gt;&lt;/code> åœ¨ä½¿ç”¨ä¸Šæ˜¯ç­‰ä»·çš„ã€‚è¾ƒæ–°ç‰ˆæœ¬çš„ Git ä¼šåœ¨å‘½ä»¤è¡Œä¸­æç¤ºä½¿ç”¨ &lt;code>restore&lt;/code> å‘½ä»¤æ¥å–æ¶ˆæš‚å­˜æˆ–ä¸¢å¼ƒå·¥ä½œåŒºçš„æ”¹åŠ¨ã€‚&lt;/p>
&lt;h3 id="git-switch">git switch&lt;/h3>
&lt;p>&lt;code>git switch&lt;/code> å‘½ä»¤ä¸“é—¨ç”¨äºåˆ‡æ¢åˆ†æ”¯ï¼Œå¯ä»¥ç”¨æ¥æ›¿ä»£ &lt;code>checkout&lt;/code> çš„éƒ¨åˆ†ç”¨é€”ã€‚&lt;/p>
&lt;p>åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼ˆ &lt;code>-C&lt;/code> å¤§å°å†™çš†å¯ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git switch -C &amp;lt;new-branch&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åˆ‡æ¢åˆ°å·²æœ‰åˆ†æ”¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git switch &amp;lt;branch&amp;gt;
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å’Œ &lt;code>checkout&lt;/code> ä¸€æ ·ï¼Œ &lt;code>switch&lt;/code> å¯¹å·¥ä½œåŒºæ˜¯å®‰å…¨çš„ï¼Œå®ƒä¼šå°è¯•åˆå¹¶å·¥ä½œåŒºå’Œæš‚å­˜åŒºä¸­çš„æœ¬åœ°æ›´æ”¹ï¼Œå¦‚æœæ— æ³•å®Œæˆåˆå¹¶åˆ™ä¼šä¸­æ­¢æ“ä½œï¼Œæœ¬åœ°æ›´æ”¹ä¼šè¢«ä¿ç•™ã€‚&lt;/p>
&lt;p>&lt;code>switch&lt;/code> çš„ä½¿ç”¨æ–¹å¼ç®€å•ä¸”ä¸“ä¸€ï¼Œå®ƒæ— æ³•åƒ &lt;code>checkout&lt;/code> ä¸€æ ·å¯¹æŒ‡å®šæäº¤ä½¿ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ git switch ea4c48a
fatal: æœŸæœ›ä¸€ä¸ªåˆ†æ”¯ï¼Œå¾—åˆ°æäº¤ &lt;span class="s1">&amp;#39;ea4c48a&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ">å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;h3 id="æ’¤é”€æœ¬åœ°åˆ†æ”¯æäº¤">æ’¤é”€æœ¬åœ°åˆ†æ”¯æäº¤&lt;/h3>
&lt;p>ä½¿ç”¨ &lt;code>git reset&lt;/code> ï¼Œå–å†³äºä½ æ˜¯å¦éœ€è¦ä¿ç•™è¯¥æäº¤ä¹‹åçš„æ›´æ”¹ï¼Œæ·»åŠ  &lt;code>--soft&lt;/code> ã€&lt;code>â€”hard&lt;/code> ç­‰é€‰é¡¹ã€‚&lt;/p>
&lt;h3 id="å›æ»šè¿œç¨‹ä¸»å¹²åˆ†æ”¯ä¸Šçš„æäº¤">å›æ»šè¿œç¨‹ä¸»å¹²åˆ†æ”¯ä¸Šçš„æäº¤&lt;/h3>
&lt;p>ä½¿ç”¨ &lt;code>git revert&lt;/code>ã€‚&lt;/p>
&lt;h3 id="ä¿®æ”¹ä¸Šä¸€æ¬¡æäº¤çš„å†…å®¹">ä¿®æ”¹ä¸Šä¸€æ¬¡æäº¤çš„å†…å®¹&lt;/h3>
&lt;p>å¦‚æœè¯¥æäº¤è¿˜æœªè¿›å…¥å…¬å…±åˆ†æ”¯ï¼Œæœ€ç›´æ¥çš„æ–¹å¼æ˜¯ä½¿ç”¨ &lt;code>git commit --amend&lt;/code>ã€‚å¦‚æœè¯¥æäº¤å·²ç»ä½äºå…¬å…±åˆ†æ”¯ï¼Œåº”è¯¥ä½¿ç”¨ &lt;code>git revert&lt;/code>ã€‚&lt;/p>
&lt;h3 id="æš‚å­˜æ›´æ”¹åå†æ¢å¤">æš‚å­˜æ›´æ”¹åå†æ¢å¤&lt;/h3>
&lt;p>ä¸€ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯æ˜¯ï¼Œæˆ‘ä»¬åœ¨å½“å‰åˆ†æ”¯ä¿®æ”¹äº†ä¸€äº›æ–‡ä»¶ï¼Œä½†è¿˜ä¸è¶³ä»¥ç»„ç»‡æˆæäº¤æˆ–è€…åŒ…å«äº†å¤šä¸ªæäº¤çš„å†…å®¹ï¼Œçªç„¶æœ‰ç´§æ€¥æƒ…å†µéœ€è¦å¼€å§‹ä¸€é¡¹æ–°çš„ä»»åŠ¡ï¼Œæ­¤æ—¶æˆ‘ä»¬å¸Œæœ›å¯ä»¥å°†å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„æœ¬åœ°æ›´æ”¹æš‚æ—¶ä¿å­˜èµ·æ¥ï¼Œä»¥å¤‡åœ¨å…¶ä»–å·¥ä½œå®Œæˆåå¯ä»¥ä»è¿™é‡Œç»§ç»­ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬å½“ç„¶å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„åˆ†æ”¯ç„¶åé‡ç½®æˆ–åˆå¹¶æ¥å®ç°ç›®çš„ï¼Œä½†é‚£æ ·å¤æ‚è€Œç¹çã€‚è€Œ &lt;code>git stash&lt;/code> å‘½ä»¤åˆ™å¯ä»¥å¾ˆå¥½çš„æ»¡è¶³éœ€æ±‚ï¼Œå®ƒä¼šå°†æœ¬åœ°æ›´æ”¹ä¿å­˜èµ·æ¥ï¼Œå¹¶å°†å·¥ä½œåŒºå’Œæš‚å­˜åŒºæ¢å¤åˆ°ä¸ HEAD æäº¤ç›¸åŒ¹é…çš„çŠ¶æ€ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯æˆ–è€…ç»§ç»­åœ¨å½“å‰åˆ†æ”¯å®Œæˆå…¶ä»–ä»»åŠ¡ï¼Œä¹‹åå†å°†æš‚å­˜çš„å†…å®¹å–å›ã€‚&lt;/p>
&lt;p>&lt;code>git stash&lt;/code> çš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># ä¿å­˜å½“å‰æ›´æ”¹ï¼ˆæ·»åŠ  -u é€‰é¡¹ä»¥åŒ…æ‹¬æœªè·Ÿè¸ªçš„æ–°æ–‡ä»¶ï¼‰&lt;/span>
$ git stash -u
&lt;span class="c1"># å®Œæˆå…¶ä»–ä»»åŠ¡......&lt;/span>
&lt;span class="c1"># æ¢å¤æš‚å­˜çš„æ›´æ”¹&lt;/span>
$ git stash pop
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>stash&lt;/code> çš„å®è´¨ä¹Ÿæ˜¯å°†æœ¬åœ°æ›´æ”¹ä¿å­˜ä¸ºä¸€æ¬¡æ–°çš„æäº¤ï¼Œç„¶åå†å°†è¯¥æäº¤æ¢å¤åˆ°å·¥ä½œåŒºå’Œæš‚å­˜åŒºï¼Œä½†å®ƒä¸ä¼šå½±å“å½“å‰çš„æäº¤å†å²ã€‚&lt;code>stash&lt;/code> è¿˜æœ‰æ›´å¤šè¿›é˜¶ç”¨æ³•ï¼Œæ¯”å¦‚æŒ‡å®šæš‚å­˜çš„æ–‡ä»¶è·¯å¾„ã€æš‚å­˜å¤šæ¬¡å¹¶æ‹©ä¸€æ¢å¤ç­‰ã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬é¦–å…ˆäº†è§£äº†ä¸€äº›å¿…è¦çš„ Git å†…éƒ¨æœºåˆ¶ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ &lt;code>blob&lt;/code> ã€&lt;code>tree&lt;/code> å’Œæäº¤å¯¹è±¡ç­‰å†…éƒ¨å¯¹è±¡ä¿å­˜æ•°æ®ï¼Œæ¯æ¬¡æäº¤éƒ½æ˜¯ä¸€ä»½å®Œæ•´çš„æ–‡ä»¶å¿«ç…§ã€‚&lt;/li>
&lt;li>SHA-1 IDã€åˆ†æ”¯å¼•ç”¨åŠ HEAD çš„å®è´¨ã€‚&lt;/li>
&lt;li>ç®¡ç†ä¸‰æ£µæ ‘çš„çŠ¶æ€ï¼šå·¥ä½œåŒºã€æš‚å­˜åŒºã€æäº¤å†å²ã€‚&lt;/li>
&lt;li>åˆ›å»ºä¸€æ¬¡æäº¤çš„å®Œæ•´å·¥ä½œæµç¨‹ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç„¶åé€šè¿‡ç¤ºä¾‹åˆ†åˆ«ä»‹ç»äº† &lt;code>checkout&lt;/code> ã€&lt;code>reset&lt;/code> å’Œ &lt;code>revert&lt;/code> çš„åŸºæœ¬ç”¨æ³•ä¸åŒºåˆ«ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>checkout&lt;/code>
&lt;ul>
&lt;li>ä¸å¸¦è·¯å¾„ï¼šå°†å·¥ä½œåŒºã€æš‚å­˜åŒºæ›´æ–°ä¸ºæŒ‡å®šæäº¤çš„çŠ¶æ€ï¼Œä½†ä¼šä¿ç•™æœ¬åœ°æ›´æ”¹ã€‚&lt;/li>
&lt;li>å¸¦è·¯å¾„ï¼šå°†æŒ‡å®šæ–‡ä»¶æ›´æ–°ä¸ºæŒ‡å®šæäº¤çš„çŠ¶æ€ï¼Œä¸ä¼šä¿ç•™æœ¬åœ°æ›´æ”¹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>reset&lt;/code>
&lt;ul>
&lt;li>&lt;code>â€”soft&lt;/code>ï¼šä»…å°† HEAD åŠå…¶æŒ‡å‘çš„åˆ†æ”¯å¼•ç”¨ç§»åŠ¨åˆ°æŒ‡å®šæäº¤ã€‚&lt;/li>
&lt;li>&lt;code>â€”mixed&lt;/code>ï¼šé™¤äº†æ›´æ”¹æäº¤å†å²ï¼Œè¿˜å°†æš‚å­˜åŒºä¹Ÿæ›´æ–°ä¸ºæŒ‡å®šæäº¤çš„å†…å®¹ã€‚&lt;/li>
&lt;li>&lt;code>â€”hard&lt;/code>ï¼šé™¤äº†æ›´æ”¹æäº¤å†å²å’Œæš‚å­˜åŒºï¼Œè¿˜å°†å·¥ä½œåŒºä¹Ÿæ›´æ–°ä¸ºæŒ‡å®šæäº¤çš„å†…å®¹ï¼Œå·¥ä½œåŒºçš„æœ¬åœ°æ›´æ”¹ä¼šæ°¸ä¹…ä¸¢å¤±ã€‚&lt;/li>
&lt;li>å¯¹æ–‡ä»¶è·¯å¾„ä½¿ç”¨å¯ä»¥å°†æ–‡ä»¶å–æ¶ˆæš‚å­˜ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>revert&lt;/code>
&lt;ul>
&lt;li>åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ä»¥æ’¤é”€æŒ‡å®šæäº¤å¼•å…¥çš„æ›´æ”¹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>è¿˜ä»‹ç»äº†ä¸¤ä¸ªæ–°ç‰ˆæœ¬å¼•å…¥çš„æ›´ä¸“ä¸€çš„å‘½ä»¤ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>restore&lt;/code>ï¼šå°†å·¥ä½œåŒºæˆ–æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶è¿˜åŸä¸ºæŒ‡å®šæäº¤æ—¶çš„çŠ¶æ€ã€‚&lt;/li>
&lt;li>&lt;code>switch&lt;/code>ï¼šåˆ‡æ¢åˆ°å·²æœ‰åˆ†æ”¯æˆ–è€…åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯ã€‚&lt;/li>
&lt;/ul>
&lt;p>æœ€åç»™å‡ºäº†ä¸€äº›å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¹¶ä»‹ç»äº† &lt;code>git stash&lt;/code> çš„ç”¨æ³•ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E9%87%8D%E7%BD%AE%E6%8F%AD%E5%AF%86#_git_reset">Git å·¥å…· - é‡ç½®æ­å¯†&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%92%A4%E6%B6%88%E6%93%8D%E4%BD%9C">Git åŸºç¡€ - æ’¤æ¶ˆæ“ä½œ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.atlassian.com/git/tutorials/undoing-changes">Undoing Commits &amp;amp; Changes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://medium.com/blue-harvest-tech-blog/git-2-23-0-forget-about-checkout-and-switch-to-restore-ac2682b737b3">Git 2.23.0: Forget about checkout, and switch to restore&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://git-scm.com/book/zh/v2/Git-%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86-Git-%E5%BC%95%E7%94%A8">Git å†…éƒ¨åŸç† - Git å¼•ç”¨&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://medium.com/hackernoon/understanding-git-index-4821a0765cf">Understanding Git â€” Index&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.blog/2020-12-17-commits-are-snapshots-not-diffs/">Commits are snapshots, not diffs&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://shafiul.github.io//gitbook/7_the_git_index.html">The Git Index&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://mincong.io/2018/04/28/git-index/#:~:text=The%20index%20is%20a%20binary,Git%3A%20they%20are%20used%20interchangeably.">Git: Understanding the Index File&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://tom.preston-werner.com/2009/05/19/the-git-parable.html">The Git Parable&lt;/a>&lt;/li>
&lt;/ul></description><category domain="https://www.waynerv.com/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</category><category domain="https://www.waynerv.com/tags/git/">Git</category></item><item><title>æ„å»ºä¿éšœä»£ç è´¨é‡çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ</title><link>https://www.waynerv.com/posts/build-automatic-code-quality-workflow/</link><guid isPermaLink="true">https://www.waynerv.com/posts/build-automatic-code-quality-workflow/</guid><pubDate>Mon, 04 Jan 2021 11:28:01 +0800</pubDate><author>ampedee@gmail.com (Waynerv)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œä»£ç è´¨é‡å¯ä»¥è¯´æ˜¯æˆ‘ä»¬çš„èŒä¸šåº•çº¿ã€‚ç»´æŠ¤åº•çº¿ä¸èƒ½å…¨é è‡ªè§‰ï¼Œå› æ­¤æœ¬æ–‡å°†ä»‹ç»å‡ ç§è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œå¹¶å±•ç¤ºå¦‚ä½•å°†å®ƒä»¬é›†æˆåˆ°æ—¥å¸¸çš„å·¥ä½œæµä¸­ï¼Œçœå¿ƒçœåŠ›çš„æŒç»­ä¿éšœä»£ç è´¨é‡ã€‚&lt;/p>
&lt;h2 id="linter">Linter&lt;/h2>
&lt;p>Linter æ˜¯ä¸€ç±»ç”¨äºæ ‡è®°ç¨‹åºé”™è¯¯ã€bugã€é£æ ¼é”™è¯¯å’Œå¯ç–‘ç»“æ„çš„é™æ€ä»£ç åˆ†æå·¥å…·ï¼Œæ¯”å¦‚ Python ä¸­çš„ &lt;code>Pylint&lt;/code>ã€ &lt;code>flake8&lt;/code>ï¼ŒJavaScript ä¸­çš„ &lt;code>EsLint&lt;/code>ï¼Œè¿™ç±»å·¥å…·ä¼šæ‰¾åˆ°ä½ ä»£ç ä¸­çš„é”™è¯¯ï¼Œå¹¶ç»™å‡ºå¦‚ä½•ä¿®å¤çš„æç¤ºã€‚&lt;/p>
&lt;h3 id="ä¸ºä½•è¦ä½¿ç”¨-linter">ä¸ºä½•è¦ä½¿ç”¨ Linter&lt;/h3>
&lt;p>äººæ€»æ˜¯ä¼šç²—å¿ƒå’ŒçŠ¯é”™ï¼Œå€ŸåŠ© Linter æˆ‘ä»¬å¯ä»¥å‘ç°ä»£ç ä¸­ä¸æ˜“å¯Ÿè§‰æˆ–é—æ¼çš„é”™è¯¯ï¼Œå¹¶è¿›è¡Œçº æ­£ã€‚ä½¿ç”¨ Linter æœ‰ä»¥ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>æ ¹æ® &lt;a href="https://www.python.org/dev/peps/pep-0008/">PEP8&lt;/a> ç­‰è¯­è¨€è§„èŒƒæŒç»­çš„æç¤ºä¸çº æ­£ï¼Œå¸®åŠ©ä½ å†™å‡ºæ›´å¥½çš„ä»£ç &lt;/li>
&lt;li>å‡å°‘ä»£ç ä¸­çš„æ ¼å¼é”™è¯¯ã€ç¬”è¯¯åŠç³Ÿç³•çš„é£æ ¼ç­‰ä½çº§é”™è¯¯&lt;/li>
&lt;li>èŠ‚çœå›¢é˜Ÿæˆå‘˜ review ä½ ä»£ç çš„æ—¶é—´ï¼Œæé«˜åä½œæ•ˆç‡&lt;/li>
&lt;li>é…ç½®ç®€å•ï¼Œä»…éœ€å‡ æ­¥å³å¯ä¸Šæ‰‹&lt;/li>
&lt;/ul>
&lt;h3 id="flake8-ç¤ºä¾‹">&lt;code>flake8&lt;/code> ç¤ºä¾‹&lt;/h3>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»¥ Python ä¸­çš„ &lt;code>flake8&lt;/code> ä¸ºä¾‹ï¼Œä»‹ç»å…¶ç”¨æ³•ã€‚&lt;/p>
&lt;p>é¦–å…ˆé€šè¿‡ &lt;code>pip&lt;/code> å®‰è£… &lt;code>flake8&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ pip install flake8
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flake8&lt;/code> çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œç›´æ¥ä»¥éœ€è¦æ£€æŸ¥çš„æ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•çš„è·¯å¾„ä½œä¸º &lt;code>flake8&lt;/code> å‘½ä»¤çš„å‚æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ flake8 . &lt;span class="c1"># æ£€æŸ¥å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶&lt;/span>
./__init__.py:4:1: E402 module level import not at top of file
./__init__.py:4:1: F401 &lt;span class="s1">&amp;#39;.md_toc.main&amp;#39;&lt;/span> imported but unused
./__init__.py:4:25: W292 no newline at end of file
./md_toc.py:6:18: E999 SyntaxError: non-default argument follows default argument
./md_toc.py:28:80: E501 line too long &lt;span class="o">(&lt;/span>&lt;span class="m">108&lt;/span> &amp;gt; &lt;span class="m">79&lt;/span> characters&lt;span class="o">)&lt;/span>
./md_toc.py:48:80: E501 line too long &lt;span class="o">(&lt;/span>&lt;span class="m">113&lt;/span> &amp;gt; &lt;span class="m">79&lt;/span> characters&lt;span class="o">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åœ¨è¿è¡Œç»“æœä¸­ï¼Œ &lt;code>flake8&lt;/code> ä¸ä»…æŒ‡å‡ºäº†å…·ä½“çš„é”™è¯¯åŸå› ï¼Œè¿˜ç»™å‡ºäº†å‡ºé”™çš„æ–‡ä»¶ä½ç½®åŠä»£ç æ‰€åœ¨è¡Œæ•°ã€‚&lt;/p>
&lt;p>æ›´å¤šå…¶ä»–çš„é€‰é¡¹å¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–å¸®åŠ©ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ flake8 --help
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flake8&lt;/code> çš„å¯è‡ªå®šä¹‰ç¨‹åº¦å¾ˆé«˜ï¼Œé™¤äº†åœ¨è¿è¡Œæ—¶æ·»åŠ å‘½ä»¤é€‰é¡¹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æ¥è‡ªå®šä¹‰æ£€æŸ¥è§„åˆ™ã€‚æ–¹æ³•æ˜¯åœ¨è¿è¡Œ &lt;code>flake8&lt;/code> çš„é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  &lt;code>.flake8&lt;/code> æ–‡ä»¶ï¼Œå¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="k">[flake8]&lt;/span>
&lt;span class="na">max-line-length&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">120 # é€‚å½“æé«˜æœ€å¤§è¡Œé•¿åº¦&lt;/span>
&lt;span class="na">max-complexity&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">24 # è®¾ç½®æœ€å¤§å¤æ‚åº¦ä¸º24&lt;/span>
&lt;span class="na">ignore&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">F401, W503, E203 # å¿½ç•¥è¿™äº›é”™è¯¯ç±»å‹&lt;/span>
&lt;span class="na">exclude&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s"># å¿½ç•¥ä»¥ä¸‹æ–‡ä»¶
&lt;/span>&lt;span class="s"> .git,
&lt;/span>&lt;span class="s"> __pycache__,
&lt;/span>&lt;span class="s"> scripts,
&lt;/span>&lt;span class="s"> logs,
&lt;/span>&lt;span class="s"> upload,
&lt;/span>&lt;span class="s"> build,
&lt;/span>&lt;span class="s"> dist,
&lt;/span>&lt;span class="s"> docs,
&lt;/span>&lt;span class="s"> migrations&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flake8&lt;/code> è¿˜å¯ä»¥æ·»åŠ æ’ä»¶å®ç°æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³å¼ºåˆ¶è¦æ±‚ç¼–å†™å‡½æ•° &lt;code>docstring&lt;/code>ï¼Œå¯ä»¥å®‰è£… &lt;code>flake8-docstrings&lt;/code> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ pip install flake8-docstrings
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é‡æ–°è¿è¡Œæ£€æŸ¥åï¼Œä¼šå‘ç°ç»“æœä¸­å¤šå‡ºäº†å¦‚ä¸‹é”™è¯¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">./__init__.py:1:1: D104 Missing docstring in public package
./md_toc.py:6:1: D103 Missing docstring in public &lt;span class="k">function&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ›´å¤šå…¶ä»–åŠŸèƒ½å’Œæ’ä»¶å¯æŸ¥çœ‹ &lt;code>flake8&lt;/code> çš„&lt;a href="https://flake8.pycqa.org/en/latest/index.html">æ–‡æ¡£&lt;/a>ã€‚&lt;/p>
&lt;p>é™¤äº† &lt;code>flake8&lt;/code> ä»¥å¤–ï¼ŒPython è¿˜æœ‰ä»¥ä¸‹ Linter å¯ä¾›é€‰æ‹©ï¼Œå®ƒä»¬çš„ç”¨æ³•å¤§åŒå°å¼‚ï¼Œä½†åœ¨æ£€æŸ¥èŒƒå›´ã€å®¹å¿åº¦ç­‰æ–¹é¢æœ‰æ‰€åŒºåˆ«ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/PyCQA/pylint">Pylint&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/PyCQA/pyflakes">Pyflakes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://pypi.python.org/pypi/PyChecker">Pychecker&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://pypi.python.org/pypi/pep8">Pep8&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="static-type-checker">Static Type Checker&lt;/h2>
&lt;p>Python ä» &lt;a href="https://www.python.org/dev/peps/pep-0484/">PEP 484&lt;/a> å¼•å…¥ &lt;code>Type Hints&lt;/code> ï¼ˆç±»å‹æç¤ºï¼‰ä»¥æ¥ï¼Œé…å¥—çš„å·¥å…·é“¾ç”Ÿæ€ä¹Ÿåœ¨é€æ¸æˆç†Ÿï¼Œå‡ºç°äº†å¦‚ &lt;code>mypy&lt;/code>ã€ &lt;code>pyright&lt;/code> ç­‰é™æ€ç±»å‹æ£€æŸ¥å·¥å…·ã€‚&lt;/p>
&lt;p>å®ƒä»¬å¯ä»¥æ ¹æ® Python ä»£ç ä¸­çš„ç±»å‹æç¤ºè¿›è¡Œé™æ€ç±»å‹æ£€æŸ¥ï¼Œä¸éœ€è¦è¿è¡Œç¨‹åºå°±å¯ä»¥æ‰¾åˆ°ç¨‹åºä¸­çš„é”™è¯¯ã€‚è€Œä¸”å¦‚æœæœ‰é—ç•™ä»£ç ä¸å¥½å¤„ç†ï¼Œè¿˜å¯ä»¥åœ¨ç¨‹åºä¸­æ··åˆä½¿ç”¨åŠ¨æ€å’Œé™æ€ç±»å‹ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä»¥ &lt;code>mypy&lt;/code> åšç®€å•ç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># test_mypy.py&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">greeting&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&amp;gt;&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="s1">&amp;#39;Hello &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">name&lt;/span>
&lt;span class="n">greeting&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é€šè¿‡ &lt;code>pip&lt;/code> å®‰è£… &lt;code>mypy&lt;/code> :&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ pip install mypy
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯¹è¯¥æ–‡ä»¶è¿è¡Œæ£€æŸ¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ mypy test_mypy.py
test_mypy.py:4: error: Argument &lt;span class="m">1&lt;/span> to &lt;span class="s2">&amp;#34;greeting&amp;#34;&lt;/span> has incompatible &lt;span class="nb">type&lt;/span> &lt;span class="s2">&amp;#34;int&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> expected &lt;span class="s2">&amp;#34;str&amp;#34;&lt;/span>
Found &lt;span class="m">1&lt;/span> error in &lt;span class="m">1&lt;/span> file &lt;span class="o">(&lt;/span>checked &lt;span class="m">1&lt;/span> &lt;span class="nb">source&lt;/span> file&lt;span class="o">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åœ¨æ£€æŸ¥ç»“æœä¸­ï¼Œ &lt;code>mypy&lt;/code> æç¤ºæˆ‘ä»¬åœ¨è°ƒç”¨ &lt;code>greeting()&lt;/code> æ—¶ä¼ å…¥çš„å‚æ•°ç±»å‹å‡ºé”™ã€‚&lt;/p>
&lt;h3 id="ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„">ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„&lt;/h3>
&lt;p>é™æ€ç±»å‹æ£€æŸ¥å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬åƒé™æ€è¯­è¨€ä¸€æ ·åœ¨è¿è¡Œä»£ç ä¹‹å‰å°±æ•è·åˆ°æŸäº›é”™è¯¯ï¼Œä½†éœ€è¦æˆ‘ä»¬åœ¨ç¨‹åºä¸­åŠ å…¥å¤§é‡çš„ç±»å‹æç¤ºæ‰èƒ½å®Œæ•´å‘æŒ¥å…¶ä½œç”¨ã€‚è™½ç„¶ç¨å¾®åŠ å¤§äº†å·¥ä½œé‡ï¼Œä½†å¼•å…¥ç±»å‹æç¤ºè¿˜ä¼šå¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>ç›¸æ¯”ä¼ ç»Ÿçš„Â &lt;a href="https://link.zhihu.com/?target=https%3A//realpython.com/documenting-python-code/">docstrings&lt;/a>ï¼Œç±»å‹æç¤ºé…åˆè‰¯å¥½çš„å‘½åæ—¢èƒ½ä½œä¸ºè§£é‡Šæ–‡æ¡£ï¼Œä¹Ÿèƒ½ç”¨äºè‡ªåŠ¨æ£€æŸ¥ã€‚&lt;/li>
&lt;li>å¯ä»¥ä½¿ IDE é€šè¿‡ç±»å‹æ¨æ–­æä¾›æ›´å¥½çš„ä»£ç è¡¥å…¨å’Œæç¤ºåŠŸèƒ½ã€‚&lt;/li>
&lt;li>å¼ºåˆ¶ä½ å»æ€è€ƒåŠ¨æ€è¯­è¨€ç¨‹åºçš„ç±»å‹å¯èƒ½ä¼šå¸®åŠ©ä½ æ„å»ºæ›´æ¸…æ™°çš„ä»£ç æ¶æ„ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="autoformatter">Autoformatter&lt;/h2>
&lt;p>Autoformatter ï¼ˆè‡ªåŠ¨æ ¼å¼åŒ–å™¨ï¼‰é¡¾åæ€ä¹‰æ˜¯å¯ä»¥å°†ä»£ç æŒ‰ç‰¹å®šè§„åˆ™è‡ªåŠ¨æ ¼å¼åŒ–çš„ä¸€ç±»å·¥å…·ã€‚Linter å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°ä»£ç ä¸­çš„æ ¼å¼é”™è¯¯å’Œé£æ ¼é—®é¢˜ï¼Œä½†å¹¶ä¸ä¼šè‡ªåŠ¨çº æ­£ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å€ŸåŠ©è‡ªåŠ¨æ ¼å¼åŒ–å™¨ï¼Œè¿›ä¸€æ­¥å°†æˆ‘ä»¬ä»é‡å¤çç¢çš„æ‰‹åŠ¨ä¿®æ”¹ä¸­è§£æ”¾å‡ºæ¥ã€‚&lt;/p>
&lt;p>Python ä¸­æœ‰ &lt;code>black&lt;/code> ã€ &lt;code>yapf&lt;/code>ã€ &lt;code>autopep8&lt;/code>ã€ &lt;code>isort&lt;/code> ç­‰ä¼—å¤šæ ¼å¼åŒ–å·¥å…·ï¼Œé™¤äº†æ•´ä½“ä¸Šéµå¾ª PEP8 ä»¥å¤–ï¼Œå„è‡ªéƒ½æœ‰ä¸åŒçš„é£æ ¼è§„èŒƒå’Œé€‚ç”¨èŒƒå›´ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½è¿›è¡Œé€‰æ‹©ã€‚&lt;/p>
&lt;p>ä»¥ &lt;code>black&lt;/code> å’Œä¸‹é¢è¿™æ®µä»£ç ä¸ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># test_black.py&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">f&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">List&lt;/span>&lt;span class="p">[&lt;/span> &lt;span class="nb">int&lt;/span> &lt;span class="p">])&lt;/span> &lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="mi">37&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">42&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">u&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="o">**&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">very_important_function&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">template&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">variables&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nb">file&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PathLike&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">debug&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">bool&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">False&lt;/span>&lt;span class="p">,):&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;Applies `variables` to the `template` and writes to `file`.&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="k">with&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;w&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="o">...&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é¦–å…ˆé€šè¿‡ &lt;code>pip&lt;/code> å®‰è£… &lt;code>black&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ pip install black
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç„¶åå¯¹éœ€è¦æ ¼å¼åŒ–çš„æ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•çš„è·¯å¾„æ‰§è¡Œ &lt;code>black&lt;/code> å‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ black test_black.py
reformatted /Users/waynerv/Repos/github-markdown-toc/gfm_toc/__init__.py
reformatted /Users/waynerv/Repos/github-markdown-toc/gfm_toc/md_toc.py
All &lt;span class="k">done&lt;/span>! âœ¨ ğŸ° âœ¨
&lt;span class="m">2&lt;/span> files reformatted.
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>black&lt;/code> ä¼šé¦–å…ˆæ£€æŸ¥å‡ºä¸ç¬¦åˆå…¶è§„èŒƒçš„æ–‡ä»¶ï¼Œç„¶åç¼–è¾‘æ–‡ä»¶å®Œæˆä¿®æ”¹ï¼Œå¹¶è¾“å‡ºä¿®æ”¹çš„æ–‡ä»¶è·¯å¾„åŠæ•°é‡ã€‚æ ¼å¼åŒ–åçš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="c1"># test_black.py&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">f&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">List&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">]):&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="mi">37&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">42&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">u&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="o">**&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">very_important_function&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="n">template&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="o">*&lt;/span>&lt;span class="n">variables&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nb">file&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">PathLike&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">debug&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">bool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">False&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">):&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;Applies `variables` to the `template` and writes to `file`.&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="k">with&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;w&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="o">...&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>black&lt;/code> å·ç§°ã€Œä¸å¦¥åçš„ä»£ç æ ¼å¼åŒ–å™¨ã€ï¼Œå…¶ä¸å¦¥åä½“ç°åœ¨åŸºæœ¬æ²¡æœ‰å¯ä¾›è‡ªå®šä¹‰çš„é€‰é¡¹ï¼Œè¦ä¹ˆå…¨ç›˜æ¥å—å®ƒçš„ä»£ç é£æ ¼ï¼Œè¦ä¹ˆå°±ä¸ç”¨å®ƒã€‚å¦‚æœä½ æˆ–è€…ä½ çš„å›¢é˜Ÿèƒ½å¤Ÿæ¥å—å®ƒçš„é£æ ¼ï¼Œä½¿ç”¨ &lt;code>black&lt;/code> å¯ä»¥èŠ‚çœå¾ˆå¤šèŠ±åœ¨ä»£ç é£æ ¼ä¸Šçš„ç²¾åŠ›å’Œæ—¶é—´ï¼ˆå†ä¹Ÿä¸ç”¨äº‰è®ºæŸç§é£æ ¼å­°ä¼˜å­°åŠ£äº†ï¼‰ã€‚&lt;/p>
&lt;p>å®è·µä¸­æˆ‘ä»¬å¯ä»¥å¯¹æœ€å¤§è¡Œé•¿åº¦ä»¥åŠå¼•å·æ ¼å¼åŒ–é€‰é¡¹åšä¸€äº›è°ƒæ•´ï¼Œæ–¹æ³•æ˜¯åœ¨æ‰§è¡Œ &lt;code>black&lt;/code> çš„é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  &lt;code>pyproject.tomal&lt;/code> æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="k">[tool.black]&lt;/span>
&lt;span class="na">line-length&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">120&lt;/span>
&lt;span class="na">skip-string-normalization&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ide-çš„è‡ªå¸¦å·¥å…·">IDE çš„è‡ªå¸¦å·¥å…·&lt;/h3>
&lt;p>ç°ä»£çš„ IDE å’Œç¼–è¾‘å™¨åŸºæœ¬éƒ½ä¼šè‡ªå¸¦ Linter å’Œæ ¼å¼åŒ–ç­‰åŠŸèƒ½ï¼Œæ¯”å¦‚ &lt;code>PyCharm&lt;/code> å°±å¯ä»¥é€šè¿‡ &lt;code>âŒ¥ âŒ˜ L&lt;/code> å¿«æ·é”®æ ¼å¼åŒ–å½“å‰æ–‡ä»¶çš„ä»£ç ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬è¿˜æœ‰å¿…è¦æ‰‹åŠ¨é›†æˆè¿™äº›ç¬¬ä¸‰æ–¹å·¥å…·å—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯æœ‰å¿…è¦ï¼Œæˆ‘ä»¬ä»¥ç¬¬ä¸‰æ–¹å’Œ IDE è‡ªå¸¦çš„ä»£ç å·¥å…·ä½œå¯¹æ¯”ï¼š&lt;/p>
&lt;ul>
&lt;li>è‡ªå¸¦å·¥å…·å¯¹ç¯å¢ƒä¾èµ–ç¨‹åº¦å¾ˆé«˜ï¼Œå¿…é¡»è¦æœ‰ç‰¹å®šçš„äºŒè¿›åˆ¶åŒ…åŠé…ç½®æ–‡ä»¶æ‰èƒ½æ‰§è¡Œï¼›è€Œä½¿ç”¨ä¸é¡¹ç›®ç›¸åŒè¯­è¨€å®ç°çš„ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼Œé…ç½®ä¹Ÿèƒ½å¾ˆæ–¹ä¾¿åœ°æ•´åˆåˆ°é¡¹ç›®æœ¬èº«çš„é…ç½®æ–‡ä»¶ä¸­ï¼ˆå¦‚&lt;code>pyproject.toml&lt;/code>ã€&lt;code>tox.ini&lt;/code>ç­‰ï¼‰ï¼Œä¸”é€šå¸¸éƒ½å¯ä»¥å¾ˆå¿«åœ°é›†æˆåˆ°ä¸åŒ IDE ä¸­ã€‚&lt;/li>
&lt;li>è‡ªå¸¦å·¥å…·åªèƒ½åœ¨ IDE çš„å›¾å½¢ç•Œé¢ä¸­æ‰‹åŠ¨æ‰§è¡Œï¼›è€Œç¬¬ä¸‰æ–¹å·¥å…·åªè¦æœ‰åŸºç¡€çš„ä»£ç è¿è¡Œç¯å¢ƒå°±å¯ä»¥æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬å¾ˆæ–¹ä¾¿çš„é›†æˆåˆ° Hooksã€CI ä¸­è‡ªåŠ¨åŒ–æ‰§è¡Œã€‚&lt;/li>
&lt;li>è‡ªå¸¦å·¥å…·å¹¶ä¸ä¸€å®šä¸¥æ ¼éµå¾ª PEP8 ç­‰é€šç”¨è§„èŒƒï¼Œè€Œä¸”ä¸æ–¹ä¾¿åœ¨åä½œæˆå‘˜ä¸­åˆ†äº«é…ç½®ï¼Œè¯è¯´å›æ¥ï¼Œå‡å¦‚ä½ ç”¨ &lt;code>PyCharm&lt;/code> ä½†ä½ çš„åŒäº‹ç”¨ &lt;code>VSCode&lt;/code> å‘¢ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;p>åœ¨æ¥ä¸‹æ¥çš„ Hooks å’Œ Pipeline ä¸¤èŠ‚å†…å®¹ä¸­ï¼Œä½ å°†è¿›ä¸€æ­¥è®¤è¯†åˆ°é›†æˆç¬¬ä¸‰æ–¹å·¥å…·å¸¦æ¥çš„ä¼˜åŠ¿ã€‚&lt;/p>
&lt;h2 id="hooks">Hooks&lt;/h2>
&lt;p>åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬ä»‹ç»äº†å¾ˆå¤šä¿éšœè´¨é‡çš„å·¥å…·ï¼Œä½†åœ¨æ—¥å¸¸ç¼–ç ä¸­ï¼Œæˆ‘ä»¬æ€»ä¸èƒ½æ¯ä¸€æ¬¡æäº¤ä»£ç å‰ï¼Œéƒ½æŠŠè¿™äº›å·¥å…·æ‰‹åŠ¨æ‰§è¡Œä¸€éå§ï¼Ÿè¿™çœ‹ä¸Šå»ä¸æ˜¯é«˜æ•ˆçš„åšæ³•ï¼Œåº†å¹¸åœ°æ˜¯æˆ‘ä»¬æœ‰ç°æˆé€”å¾„è§£å†³è¿™äº›é—®é¢˜ã€‚&lt;/p>
&lt;h3 id="git-hooks">Git Hooks&lt;/h3>
&lt;p>Git å¯ä»¥åœ¨ä»“åº“ä¸­å‘ç”Ÿç‰¹å®šäº‹ä»¶æ—¶è‡ªåŠ¨è¿è¡Œè‡ªå®šä¹‰çš„è„šæœ¬ï¼Œè¿™äº›è‡ªå®šä¹‰è„šæœ¬å³ç§°ä¸º &lt;code>hooks&lt;/code>ã€‚ å®ƒä»¬è®©ä½ å¯ä»¥åœ¨å¼€å‘å‘¨æœŸçš„å…³é”®ç‚¹è§¦å‘å¯å®šåˆ¶çš„åŠ¨ä½œï¼Œæ¯”å¦‚æ¯æ¬¡æ‰§è¡Œæäº¤å‰éƒ½æ‰§è¡Œä¸€æ¬¡ &lt;code>flake8&lt;/code> å‘½ä»¤ã€‚å¤§éƒ¨åˆ†å…¶ä»–çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¹Ÿä¼šæä¾›ç±»ä¼¼çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;p>&lt;code>hooks&lt;/code> ä¿å­˜åœ¨ Git ä»“åº“çš„ &lt;code>.git/hooks&lt;/code> ç›®å½•ä¸­ï¼Œå®ƒå¯ä»¥æ˜¯æ™®é€šçš„ shell è„šæœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯ Pythonã€Ruby ç­‰è¯­è¨€çš„å¯æ‰§è¡Œè„šæœ¬ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†å¸¸ç”¨å·¥å…·é›†æˆåˆ° &lt;code>hooks&lt;/code> ä¸­ã€‚ &lt;code>hooks&lt;/code> é€šå¸¸æŒ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå¸¸ç”¨çš„å®¢æˆ·ç«¯ç±»æœ‰ &lt;code>pre-commit&lt;/code> ã€ &lt;code>prepare-commit-msg&lt;/code>ã€ &lt;code>commit-msg&lt;/code>ã€ &lt;code>post-commit&lt;/code>ã€ &lt;code>pre-rebase&lt;/code> ç­‰ &lt;code>hooks&lt;/code>ï¼Œå®ƒä»¬åˆ†åˆ«åœ¨åç§°æ‰€ä»£è¡¨çš„äº‹ä»¶è§¦å‘æ—¶è¿è¡Œã€‚&lt;/p>
&lt;p>ä»¥ &lt;code>pre-commit&lt;/code> ä¸ºä¾‹ï¼Œè¯¥ &lt;code>hooks&lt;/code> åœ¨è¾“å…¥æäº¤ä¿¡æ¯å‰è¿è¡Œã€‚ å®ƒå¯ä»¥æ£€æŸ¥å³å°†æäº¤çš„å¿«ç…§ï¼Œå¦‚æœè¯¥ &lt;code>hooks&lt;/code> ä»¥éé›¶å€¼é€€å‡ºï¼ŒGit å°†æ”¾å¼ƒæ­¤æ¬¡æäº¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥æ£€æŸ¥æäº¤çš„ä»£ç é£æ ¼æ˜¯å¦æ­£ç¡®ï¼ˆè¿è¡Œä¾‹å¦‚ &lt;code>flake8&lt;/code>ã€ &lt;code>black&lt;/code> ç­‰ç¨‹åºï¼‰ã€æ˜¯å¦å¼•å…¥å®‰å…¨é£é™©ç­‰ç­‰ã€‚æ•´ä¸ªæµç¨‹ç¤ºæ„å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-pre-commit-workflow.png" alt="2020-01-04-pre-commit-workflow">&lt;/p>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å±•ç¤ºï¼Œå¦‚ä½•å°†ä¸Šæ–‡ä»‹ç»çš„ä¼—å¤šå·¥å…·å¿«é€Ÿåœ°é›†æˆåˆ° &lt;code>pre-commit hooks&lt;/code> ä¸­ã€‚&lt;/p>
&lt;h3 id="pre-commit">pre-commit&lt;/h3>
&lt;p>&lt;code>pre-commit&lt;/code> æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å’Œç»´æŠ¤å¤šç§è¯­è¨€ &lt;code>pre-commit hooks&lt;/code> çš„æ¡†æ¶ï¼Œå°±åƒ Python çš„åŒ…ç®¡ç†å™¨ &lt;code>pip&lt;/code> ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>pre-commit&lt;/code> å°†ä»–äººåˆ›å»ºå¹¶åˆ†äº«çš„ &lt;code>pre-commit hooks&lt;/code> å®‰è£…åˆ°è‡ªå·±çš„é¡¹ç›®ä»“åº“ä¸­ã€‚ &lt;code>pre-commit&lt;/code> å¤§å¤§å‡å°‘äº†æˆ‘ä»¬ä½¿ç”¨ &lt;code>git hooks&lt;/code> çš„éš¾åº¦ï¼Œä½ åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šæƒ³è¦çš„ &lt;code>hooks&lt;/code>ï¼Œå®ƒä¼šæ›¿ä½ å®‰è£…ä»»æ„è¯­è¨€ç¼–å†™çš„ &lt;code>hooks&lt;/code> å¹¶è§£å†³ç¯å¢ƒä¾èµ–é—®é¢˜ï¼Œç„¶ååœ¨æ¯æ¬¡æäº¤å‰æ‰§è¡Œã€‚&lt;/p>
&lt;p>&lt;code>pre-commit&lt;/code> çš„ç®€å•ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>é€šè¿‡ &lt;code>pip&lt;/code> å®‰è£… &lt;code>pre-commit&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ pip install pre-commit
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>pre-commit&lt;/code> æ˜¯é¢å‘å¤šè¯­è¨€çš„ï¼Œå› æ­¤å®ƒè¿˜æ”¯æŒé€šè¿‡ &lt;code>homebrew&lt;/code> ç­‰æ–¹å¼å®‰è£…ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ·»åŠ é…ç½®æ–‡ä»¶ã€‚&lt;/p>
&lt;p>ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º &lt;code>.pre-commit-config.yml&lt;/code> çš„æ–‡ä»¶ï¼Œé€šå¸¸æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æˆ‘ä»¬æŒ‰ç‰¹å®šæ ¼å¼æ·»åŠ éœ€è¦è¿è¡Œçš„ &lt;code>hooks&lt;/code> å¹¶æŒ‡å®šå‚æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">repos&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.com/psf/black&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">20.&lt;/span>&lt;span class="l">8b1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hooks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">black&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">language_version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">python3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">exclude&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">^migrations/|^uploads/|^scripts/|^logs/|^docs/|^dist/|^build/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.com/pycqa/flake8&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3.8.4&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hooks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">flake8&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">exclude&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">^migrations/|^uploads/|^scripts/|^logs/|^docs/|^dist/|^build/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.com/pre-commit/pre-commit-hooks&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v3.3.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hooks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">check-added-large-files&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="w"> &lt;/span>--&lt;span class="l">maxkb=512 ]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åœ¨è¯¥ç¤ºä¾‹æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº† &lt;code>black&lt;/code> ã€ &lt;code>flake8&lt;/code> ä»¥åŠä¸€ä¸ªæ£€æŸ¥æ˜¯å¦æ·»åŠ äº†å¤§ä½“ç§¯æ–‡ä»¶åˆ° Git çš„ &lt;code>hooks&lt;/code>ï¼Œè¿˜åˆ†åˆ«æŒ‡å®šäº†è¯­è¨€ç‰ˆæœ¬ã€è·³è¿‡æ£€æŸ¥è·¯å¾„ç­‰é€‰é¡¹ã€‚&lt;/p>
&lt;p>é…ç½®æ–‡ä»¶çš„é€‰é¡¹å«ä¹‰å‚è§ &lt;a href="https://pre-commit.com/#plugins">https://pre-commit.com/#plugins&lt;/a>ï¼Œæ‰€æœ‰æ”¯æŒå®‰è£…çš„ &lt;code>hooks&lt;/code> åˆ—è¡¨å‚è§&lt;a href="https://pre-commit.com/hooks.html">https://pre-commit.com/hooks.html&lt;/a>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å®‰è£… &lt;code>git hook&lt;/code> è„šæœ¬ã€‚åœ¨é…ç½®æ–‡ä»¶æ‰€åœ¨çš„æ ¹ç›®å½•è¿è¡Œå‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ pre-commit install
pre-commit installed at .git/hooks/pre-commit
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™ä¼šåœ¨ &lt;code>.git/hooks&lt;/code> æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª &lt;code>pre-commit&lt;/code> è„šæœ¬æ–‡ä»¶ï¼Œå¹¶åœ¨æ¥ä¸‹æ¥ä½ æ¯ä¸€æ¬¡æäº¤ä¹‹å‰è¿è¡Œï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥å°è¯•æäº¤ä¸€æ¬¡ä»£ç äº†ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ï¼ˆå¯é€‰æ­¥éª¤ï¼‰å¯¹æ‰€æœ‰æ–‡ä»¶è¿è¡Œ &lt;code>hooks&lt;/code>ã€‚&lt;/p>
&lt;p>é€šå¸¸ &lt;code>pre-commit&lt;/code> åªä¼šåœ¨è§¦å‘ &lt;code>git hooks&lt;/code> æ—¶å¯¹å‘ç”Ÿæ›´æ”¹çš„æ–‡ä»¶è¿è¡Œï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¯¹å½“å‰ä»“åº“çš„æ‰€æœ‰æ–‡ä»¶è¿è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ pre-commit run --all-files
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Initializing environment &lt;span class="k">for&lt;/span> https://github.com/psf/black.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Initializing environment &lt;span class="k">for&lt;/span> https://github.com/pycqa/flake8.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Initializing environment &lt;span class="k">for&lt;/span> https://github.com/pre-commit/pre-commit-hooks.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Installing environment &lt;span class="k">for&lt;/span> https://github.com/psf/black.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Once installed this environment will be reused.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> This may take a few minutes...
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Installing environment &lt;span class="k">for&lt;/span> https://github.com/pycqa/flake8.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Once installed this environment will be reused.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> This may take a few minutes...
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Installing environment &lt;span class="k">for&lt;/span> https://github.com/pre-commit/pre-commit-hooks.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> Once installed this environment will be reused.
&lt;span class="o">[&lt;/span>INFO&lt;span class="o">]&lt;/span> This may take a few minutes...
black....................................................................Failed
- hook id: black
- files were modified by this hook
reformatted /.../setup.py
reformatted /.../test/generate_toc_test.py
All &lt;span class="k">done&lt;/span>! âœ¨ ğŸ° âœ¨
&lt;span class="m">2&lt;/span> files reformatted, &lt;span class="m">2&lt;/span> files left unchanged.
flake8...................................................................Passed
Check &lt;span class="k">for&lt;/span> added large files..............................................Passed
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç»“æœæ˜¾ç¤ºæˆ‘ä»¬æœ‰æ–‡ä»¶æœªé€šè¿‡ &lt;code>black&lt;/code> æ£€æŸ¥ï¼Œä½† &lt;code>black&lt;/code> åŒæ—¶ä¹Ÿå¸®æˆ‘ä»¬è‡ªåŠ¨è¿›è¡Œäº†æ ¼å¼åŒ–ï¼Œå› æ­¤åªéœ€è¦æš‚å­˜å¹¶é‡æ–°æäº¤è¿™äº›æ–‡ä»¶å³å¯ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="pre-commit-hooks-çš„é™åˆ¶">&lt;code>pre-commit hooks&lt;/code> çš„é™åˆ¶&lt;/h3>
&lt;p>ä½¿ç”¨ &lt;code>pre-commit&lt;/code> ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ä¸°å¯Œå¤šæ ·çš„ä»£ç å·¥å…·é›†æˆåˆ° Git çš„å·¥ä½œæµä¸­ï¼Œè¿™å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜äº†æˆ‘ä»¬çš„æ•ˆç‡ï¼Œä½† &lt;code>pre-commit hooks&lt;/code> æœ¬èº«å­˜åœ¨ä»¥ä¸‹é™åˆ¶ï¼š&lt;/p>
&lt;ul>
&lt;li>å®¢æˆ·ç«¯ &lt;code>hooks&lt;/code> å¹¶ä¸ä¼šéšä»£ç åº“ä¸€èµ·è¢«å¤åˆ¶ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æœ¬åœ°ä»“åº“é€šè¿‡ &lt;code>pre-commit install&lt;/code> æ‰§è¡Œå®‰è£…ä¹‹å &lt;code>hooks&lt;/code> æ‰ä¼šç”Ÿæ•ˆã€‚&lt;/li>
&lt;li>ä½¿ç”¨ &lt;code>git commit --no-verify&lt;/code> å³å¯ç»•è¿‡æ‰€æœ‰çš„ &lt;code>pre-commit hooks&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;code>pre-commit&lt;/code> è§£å†³äº†åœ¨æœ¬åœ°é›†æˆä»£ç å·¥å…·çš„é—®é¢˜ï¼Œä½†åœ¨å›¢é˜Ÿåˆä½œçš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ç§æœºåˆ¶å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯å¯¹æ‰€æœ‰æˆå‘˜æ¨é€çš„ä»£ç è¿›è¡Œæ£€æŸ¥ï¼Œæ–½åŠ ç‰¹å®šçš„çº¦æŸï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° Pipelines äº†ã€‚&lt;/p>
&lt;h2 id="pipelines">Pipelines&lt;/h2>
&lt;p>é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ CI/CD è¿™ä¸€æ¦‚å¿µã€‚&lt;/p>
&lt;h3 id="cicd">CI/CD&lt;/h3>
&lt;p>CIï¼ˆContinuous Integrationï¼ŒæŒç»­é›†æˆï¼‰æ˜¯ä¸€ç§è½¯ä»¶å®è·µï¼Œå®ƒè¦æ±‚æˆ‘ä»¬é¢‘ç¹åœ°å‘å…±äº«ä»“åº“æäº¤ä»£ç ã€‚æ›´é¢‘ç¹åœ°æäº¤ä»£ç å¯ä»¥æ›´å¿«åœ°å‘ç°é”™è¯¯ï¼Œå‡å°‘æˆ‘ä»¬åœ¨å‘ç°é”™è¯¯æ—¶éœ€è¦è°ƒè¯•çš„ä»£ç é‡ï¼Œä¹Ÿä½¿å¾—å›¢é˜Ÿä¸åŒæˆå‘˜é—´çš„å˜æ›´æ›´å®¹æ˜“åˆå¹¶ã€‚CI å¯ä»¥èŠ‚çœæˆ‘ä»¬è°ƒè¯•é”™è¯¯æˆ–è§£å†³åˆå¹¶å†²çªçš„æ—¶é—´ï¼Œè®©æˆ‘ä»¬æœ‰æ›´å¤šçš„æ—¶é—´æ¥ç¼–å†™ä»£ç ã€‚&lt;/p>
&lt;p>å½“æäº¤ä»£ç åˆ°å…±äº«ä»“åº“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸€æ¬¡æäº¤çš„ä»£ç è¿›è¡Œæ„å»ºå’Œæµ‹è¯•ï¼Œä»¥ç¡®ä¿æäº¤ä¸ä¼šå¼•å…¥é”™è¯¯ã€‚è¿™äº›æµ‹è¯•æ—¢åŒ…æ‹¬ä¸Šæ–‡æåˆ°çš„ Linterï¼Œä¹ŸåŒ…æ‹¬å®‰å…¨æ€§æ£€æŸ¥ã€æµ‹è¯•è¦†ç›–ç‡ã€åŠŸèƒ½æµ‹è¯•å’Œå…¶ä»–è‡ªå®šä¹‰æ£€æŸ¥ã€‚æˆ‘ä»¬å°†éœ€è¦ä¸€ä¸ª CI æœåŠ¡å™¨ä½œä¸º Runner ä»¥è¿è¡Œå¯¹æäº¤ä»£ç çš„æ„å»ºå’Œæ£€æŸ¥ã€‚&lt;/p>
&lt;p>CDï¼ˆContinuous Deploymentï¼ŒæŒç»­éƒ¨ç½²ï¼‰æ˜¯ CI çš„ä¸‹ä¸€æ­¥ã€‚æˆ‘ä»¬ä¸ä»…åœ¨æ¯æ¬¡æ¨é€ä»£ç åˆ°å…±äº«ä»£ç åº“æ—¶è¿›è¡Œæ„å»ºå’Œæµ‹è¯•ï¼Œè¿˜ä¼šåœ¨ä¸éœ€è¦ä»»ä½•äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨éƒ¨ç½²ä»£ç åˆ°ç”Ÿäº§ç¯å¢ƒã€‚æ­¤å¤–è¿˜æœ‰Continuous Delivery ï¼ˆæŒç»­äº¤ä»˜ï¼‰ï¼Œå®ƒå’ŒæŒç»­éƒ¨ç½²çš„åŒºåˆ«åœ¨äºéœ€è¦äººå·¥å¹²é¢„æ‰ä¼šæ‰§è¡Œéƒ¨ç½²ã€‚&lt;/p>
&lt;h3 id="pipeline">Pipeline&lt;/h3>
&lt;p>Pipeline æ˜¯æŒç»­é›†æˆã€äº¤ä»˜å’Œéƒ¨ç½²çš„é¡¶å±‚å…·è±¡åŒ–ç»„ä»¶ï¼Œå®ƒç”±é¡ºåºæ‰§è¡Œçš„é˜¶æ®µï¼ˆstageï¼‰ä»¥åŠæ¯ä¸ªé˜¶æ®µä¸­å¹¶è¡Œçš„ä»»åŠ¡ï¼ˆjobï¼‰ç»„æˆã€‚ä¸€ä¸ªç®€å•çš„ pipeline å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-pipelines.png" alt="2020-01-04-pipelines">&lt;/p>
&lt;p>é¦–å…ˆå¹¶è¡Œåœ°æ‰§è¡Œ &lt;code>build&lt;/code> é˜¶æ®µçš„æ‰€æœ‰ä»»åŠ¡ï¼ˆ&lt;code>build_a&lt;/code> å’Œ &lt;code>build_b&lt;/code>ï¼‰ï¼Œæ‰€æœ‰ä»»åŠ¡æˆåŠŸåç»§ç»­æ‰§è¡Œä¸‹ä¸€é˜¶æ®µçš„ä»»åŠ¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚pipeline è¿˜èƒ½å®šä¹‰æˆæŒ‰æ›´å¤æ‚çš„é€»è¾‘è§„åˆ™è¿è¡Œã€‚&lt;/p>
&lt;p>ä¸‹é¢æˆ‘ä»¬ä»¥ GitLab CI ä¸ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•é…ç½®ä¸€ä¸ª pipelineï¼Œå¹¶åœ¨æµ‹è¯•é˜¶æ®µæ‰§è¡Œä¸Šæ–‡ä»‹ç»çš„æ£€æŸ¥å·¥å…·ï¼Œè§£å†³ä¸èƒ½å¯¹å›¢é˜Ÿæˆå‘˜æäº¤ä»£ç è¿›è¡Œå¼ºåˆ¶çº¦æŸçš„é—®é¢˜ã€‚&lt;/p>
&lt;h3 id="gitlab-ci-ç¤ºä¾‹">GitLab CI ç¤ºä¾‹&lt;/h3>
&lt;h4 id="é…ç½®-runner">é…ç½® Runner&lt;/h4>
&lt;p>é¦–å…ˆæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸ªè¿è¡Œä»»åŠ¡çš„æœåŠ¡å™¨ä½œä¸º Runnerï¼Œè¿™éœ€è¦æˆ‘ä»¬æœ‰å¯ç”¨çš„æœåŠ¡å™¨ä¸»æœºï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨æœ¬åœ°çš„å¼€å‘æœºå™¨æˆ–è´­ä¹° GitLab æä¾›çš„ Runnerï¼‰ã€‚é…ç½® Runner æ•´ä½“åˆ†ä¸¤æ­¥ï¼š&lt;/p>
&lt;ul>
&lt;li>åœ¨ä¸»æœºä¸Š&lt;a href="https://docs.gitlab.com/runner/install/">å®‰è£… GitLab Runner&lt;/a>ï¼ŒGitLab Runner æ˜¯ä¸€ä¸ªç”¨äº GitLab CI/CD å¹¶åœ¨ä¸»æœºä¸Šç®¡ç†ã€æ‰§è¡Œ pipeline ä»»åŠ¡çš„åº”ç”¨ã€‚å¯¹äºä¸åŒçš„æ“ä½œç³»ç»Ÿä¸æ¶æ„ï¼Œå…·ä½“çš„å®‰è£…æ­¥éª¤ä¹Ÿæœ‰å¾ˆå¤§åŒºåˆ«ï¼Œè¯¦æƒ…å‚è§æ–‡æ¡£ã€‚&lt;/li>
&lt;li>ä¸ºé¡¹ç›®ï¼ˆæˆ–é¡¹ç›®ç»„ï¼‰&lt;a href="https://docs.gitlab.com/runner/register/">æ³¨å†Œ Runner&lt;/a>ã€‚è¿™ä¸€æ­¥é¦–å…ˆéœ€è¦ä» GitLab é¡¹ç›®ä¸»é¡µçš„ &lt;strong>Settings &amp;gt; CI/CD&lt;/strong> &lt;strong>&amp;gt; Runners settings&lt;/strong> è·å–é¡¹ç›®çš„ URL å’Œæ³¨å†Œä»¤ç‰Œï¼Œç„¶ååœ¨ Runner æ‰€åœ¨çš„æœºå™¨è¿è¡Œ &lt;code>register&lt;/code> å‘½ä»¤ä½¿ç”¨ URL å’Œä»¤ç‰Œå®Œæˆæ³¨å†Œï¼Œå¹¶é€‰æ‹©åˆé€‚çš„ Runner ç±»å‹ï¼Œè¯¦ç»†æ­¥éª¤å‚è§æ–‡æ¡£ã€‚&lt;/li>
&lt;/ul>
&lt;p>é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬å°†å¯ä»¥åœ¨ &lt;strong>Runners settings&lt;/strong> é¡µé¢æŸ¥çœ‹å¯ç”¨çš„ Runner å’ŒçŠ¶æ€ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-runner-status.png" alt="2020-01-04-runner-status">&lt;/p>
&lt;h4 id="åˆ›å»º-gitlabyml">åˆ›å»º &lt;code>.gitlab.yml&lt;/code>&lt;/h4>
&lt;p>æˆ‘ä»¬å°†åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªé…ç½® pipeline çš„ &lt;code>.gitlab.yml&lt;/code> æ–‡ä»¶ï¼ŒGitLab å°†åœ¨æ¯ä¸€æ¬¡æˆ‘ä»¬æ¨é€ä»£ç åˆ°å…±äº«ä»“åº“æ—¶ï¼Œè¯»å–è¯¥æ–‡ä»¶ä¸­çš„å®šä¹‰å’ŒæŒ‡ä»¤ï¼Œåˆ›å»ºä¸€æ¡ä¸åŒé˜¶æ®µåŠä»»åŠ¡ç»„æˆçš„ pipelineï¼Œå¹¶å°†é˜¶æ®µä¸­çš„ä»»åŠ¡æ´¾å‘ç»™å¯ç”¨çš„ Runner æ‰§è¡Œã€‚æˆ‘ä»¬ä»¥å¦‚ä¸‹ &lt;code>.gitlab.yml&lt;/code> æ–‡ä»¶ä¸ºä¾‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">before_script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">python --version&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">pip install -r requirements-ci.txt&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">stages&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">Pre-commit Hooks&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">Static Analysis&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">pre-commit&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">stage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pre-commit Hooks&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">variables&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">PRE_COMMIT_HOME&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${CI_PROJECT_DIR}/.cache/pre-commit&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">cache&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">20201116dash&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">paths&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">${PRE_COMMIT_HOME}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">pre-commit run --all-files&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">mypy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">stage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Static Analysis&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">allow_failure&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">only&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">refs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">pwd&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">ls -l&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">python -m mypy app&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">flake8&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">stage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Static Analysis&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">pwd&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">python -m flake8&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">git-lint&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">stage&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Static Analysis&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">git log -1 --pretty=%B | gitlint --contrib=CT1 --ignore=body-is-missing&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ï¼š&lt;/p>
&lt;ul>
&lt;li>Runner åº”è¯¥æ‰§è¡Œçš„ä»»åŠ¡çš„ç»“æ„å’Œé¡ºåºã€‚&lt;/li>
&lt;li>é‡åˆ°ç‰¹å®šæ¡ä»¶æ—¶ï¼ŒRunner åº”åšå‡ºçš„å†³å®šã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸Šé¢çš„ç¤ºä¾‹å®šä¹‰äº†å¦‚ä¸‹ pipelineï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-pipeline-graph.png" alt="2020-01-04-pipeline-graph">&lt;/p>
&lt;ul>
&lt;li>&lt;code>before_script&lt;/code>å…³é”®å­—å®šä¹‰äº†åœ¨æ¯ä¸ªä»»åŠ¡å‰æ‰§è¡Œçš„ä¸€ç»„å‘½ä»¤ï¼Œæˆ‘ä»¬é€šè¿‡è¿™é‡Œè®¾ç½®çš„å‘½ä»¤å®‰è£…è¿è¡Œ pipeline æ‰€éœ€çš„ä¾èµ–ã€‚&lt;/li>
&lt;li>&lt;code>stage&lt;/code> å…³é”®å­—å®šä¹‰äº† &lt;code>Pre-commit Hooks&lt;/code> å’Œ &lt;code>Static Analysis&lt;/code> ä¸¤ä¸ªé˜¶æ®µã€‚&lt;/li>
&lt;li>ä¹‹ååˆ™å®šä¹‰äº† &lt;code>pre-commit&lt;/code> ã€ &lt;code>git-lint&lt;/code>ã€ &lt;code>mypy&lt;/code> å’Œ &lt;code>flake8&lt;/code> ç­‰å¤šä¸ªä»»åŠ¡åŠæ‰€å±é˜¶æ®µã€‚&lt;/li>
&lt;li>æ¯ä¸ªä»»åŠ¡ä¸­é€šè¿‡ &lt;code>script&lt;/code> å…³é”®å­—å®šä¹‰è¯¥ä»»åŠ¡æ‰€è¿è¡Œçš„è„šæœ¬å‘½ä»¤ã€‚&lt;/li>
&lt;li>åœ¨ &lt;code>pre-commit&lt;/code> ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†ä¸Šä¸€èŠ‚ä»‹ç»çš„ &lt;code>pre-commit&lt;/code> æ”¾åœ¨æœåŠ¡ç«¯è¿è¡Œï¼Œè¿™èƒ½ç¡®ä¿å¯¹ä»»ä½•äººæäº¤çš„ä»£ç éƒ½ä¼šè¿è¡ŒåŸå…ˆåªåœ¨æœ¬åœ°ç”Ÿæ•ˆçš„ &lt;code>pre-commit hooks&lt;/code>ã€‚æˆ‘ä»¬è¿˜é€šè¿‡&lt;a href="https://docs.gitlab.com/ee/ci/variables/predefined_variables.html">é¢„å®šä¹‰å˜é‡&lt;/a>å’Œ &lt;code>cache&lt;/code> å…³é”®å­—ç¼“å­˜è¿è¡Œä»»åŠ¡æ‰€éœ€çš„æ–‡ä»¶ä»¥åŠ å¿«æ‰§è¡Œé€Ÿåº¦ã€‚&lt;/li>
&lt;li>åœ¨ &lt;code>mypy&lt;/code> ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ &lt;code>allow_failure&lt;/code> å…³é”®å­—æ›´æ”¹äº†ä»»åŠ¡æˆåŠŸæ‰ä¼šè¿›å…¥ä¸‹ä¸€é˜¶æ®µè¿™ä¸€é»˜è®¤è¡Œä¸ºï¼Œå¹¶é€šè¿‡ &lt;code>only&lt;/code> å…³é”®å­—é™åˆ¶å…¶åªå¯¹ &lt;code>master&lt;/code> åˆ†æ”¯çš„æäº¤æ‰§è¡Œã€‚&lt;/li>
&lt;/ul>
&lt;p>å…³äº &lt;code>.gitlab.yml&lt;/code> çš„æ›´å¤šè¯´æ˜è¯·å‚é˜… &lt;a href="https://docs.gitlab.com/ee/ci/yaml/README.html">GitLab CI/CD pipeline é…ç½®å‚è€ƒæ‰‹å†Œ&lt;/a> ä»¥åŠ &lt;a href="https://docs.gitlab.com/ee/ci/examples/README.html">GitLab CI/CD ç¤ºä¾‹&lt;/a>ã€‚&lt;/p>
&lt;h4 id="æŸ¥çœ‹-pipeline-çš„è¿è¡ŒçŠ¶æ€">æŸ¥çœ‹ pipeline çš„è¿è¡ŒçŠ¶æ€&lt;/h4>
&lt;p>ç°åœ¨å½“æˆ‘ä»¬æ¨é€æ–°çš„ä»£ç åˆ°å…±äº«ä»“åº“æ—¶ï¼Œä¸€ä¸ªæ–°çš„ pipeline ä¼šè¢«è§¦å‘è¿è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹é€”å¾„åœ¨ GitLab ä»“åº“æŸ¥çœ‹ pipeline çš„è¿è¡ŒçŠ¶æ€ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>è¿›å…¥ &lt;strong>CI/CD &amp;gt; Pipelines&lt;/strong>ã€‚å°†å±•ç¤ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé˜¶æ®µçš„ pipelineï¼ˆå½“å‰çŠ¶æ€ä¸ºå·²é€šè¿‡ï¼‰ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-pipeline-entry.png" alt="2020-01-04-pipeline-entry">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç‚¹å‡» pipeline çš„ ID å³å¯æŸ¥çœ‹è¯¥ pipeline çš„è¿è¡Œç¤ºæ„å›¾ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-pipeline-graph.png" alt="2020-01-04-pipeline-graph">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç‚¹å‡»ä¸€ä¸ªä»»åŠ¡åç§°ï¼Œå¯æŸ¥çœ‹è¯¥ä»»åŠ¡çš„è¯¦ç»†è¿è¡Œä¿¡æ¯ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-job-detail.png" alt="2020-01-04-job-detail">&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ä»¥ä¸Šå³ä¸ºä¸€ä¸ªå®Œæ•´çš„ GitLab CI pipeline ç¤ºä¾‹ã€‚åœ¨è¯¥ pipeline ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¯ä¸€æ¬¡æäº¤ä»£ç åï¼š&lt;/p>
&lt;ul>
&lt;li>å¯¹æ‰€æœ‰æ–‡ä»¶è¿è¡Œé›†æˆäº†ä¼—å¤š &lt;code>hooks&lt;/code> çš„ &lt;code>pre-commit&lt;/code>ï¼Œç¡®ä¿ä»£ç å·²åœ¨æœ¬åœ°é€šè¿‡äº† &lt;code>pre-commit&lt;/code> æ£€æŸ¥ã€‚&lt;/li>
&lt;li>å•ç‹¬æ‰§è¡Œ &lt;code>mypy&lt;/code> ã€&lt;code>git-lint&lt;/code> ç­‰æ£€æŸ¥å·¥å…·ã€‚&lt;/li>
&lt;li>è¿˜èƒ½å¤Ÿæ‰§è¡Œæ‰“åŒ…ã€è¿è¡Œæµ‹è¯•ã€å®‰å…¨æ£€æŸ¥ç­‰æ›´å¤šæ›´å¤æ‚çš„ä»»åŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†é€šè¿‡ GitHub Actions ä¸ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•è¿è¡Œä¸€ä¸ªç®€å•çš„ CD pipelineã€‚&lt;/p>
&lt;h3 id="github-cd-ç¤ºä¾‹">Github CD ç¤ºä¾‹&lt;/h3>
&lt;h4 id="å’Œ-gitlab-cicd-çš„åŒºåˆ«">å’Œ GitLab CI/CD çš„åŒºåˆ«&lt;/h4>
&lt;p>GitHub Actions æ˜¯ GitHub åœ¨ 2018å¹´10æœˆæ¨å‡ºçš„æŒç»­é›†æˆæœåŠ¡ï¼Œå®ƒå’Œä¸Šæ–‡ä»‹ç»çš„ GitLab CI åŸç†å’Œä½¿ç”¨æ–¹æ³•åŸºæœ¬ç›¸åŒï¼Œä½†å­˜åœ¨ä»¥ä¸‹åŒºåˆ«ï¼š&lt;/p>
&lt;ul>
&lt;li>æœ¯è¯­å®šä¹‰æœ‰æ‰€ä¸åŒï¼ŒGitHub Actions æœ‰ä»¥ä¸‹ç»„æˆéƒ¨åˆ†ï¼š
&lt;ol>
&lt;li>&lt;strong>workflow&lt;/strong>Â ï¼ˆå·¥ä½œæµç¨‹ï¼‰ï¼šæŒç»­é›†æˆä¸€æ¬¡è¿è¡Œçš„è¿‡ç¨‹ï¼Œå³ GitLab ä¸­çš„ pipelineã€‚&lt;/li>
&lt;li>&lt;strong>job&lt;/strong>Â ï¼ˆä»»åŠ¡ï¼‰ï¼šä¸€ä¸ª workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª jobs æ„æˆï¼Œç±»ä¼¼äº GitLab ä¸­çš„ stageï¼Œä½†é»˜è®¤åœ¨ä¸åŒçš„ Runner å¹¶è¡Œæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºé¡ºåºæ‰§è¡Œã€‚&lt;/li>
&lt;li>&lt;strong>step&lt;/strong>ï¼ˆæ­¥éª¤ï¼‰ï¼šæ¯ä¸ª job ç”±å¤šä¸ª step æ„æˆï¼Œç±»ä¼¼äº GitLab ä¸­çš„ jobï¼Œä½† step è¦ä¹ˆæ˜¯ä¸€è¡Œå‘½ä»¤ï¼Œè¦ä¹ˆå°±æ˜¯ä¸€ä¸ªactionï¼Œstep ä¹‹é—´æŒ‰é¡ºåºæ‰§è¡Œä¸”èƒ½å¤Ÿå…±äº«æ•°æ®ã€‚&lt;/li>
&lt;li>&lt;strong>action&lt;/strong>Â ï¼ˆåŠ¨ä½œï¼‰ï¼šä½ å¯ä»¥å°†å¤šä¸ªè„šæœ¬å‘½ä»¤å°è£…æˆä¸€ä¸ª actionï¼Œé€šè¿‡ GitHub å¸‚åœºåˆ†äº«ç»™å…¶ä»–äººï¼Œç„¶ååœ¨ step ä¸­ä½¿ç”¨è‡ªå»ºæˆ–æ¥è‡ªç¤¾åŒºçš„ actionã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>GitHub å…è´¹æä¾›å¸¸è§ç±»å‹çš„ Runnerï¼Œå› æ­¤ä¸€èˆ¬æƒ…å†µä¸éœ€è¦å†è‡ªè¡Œé…ç½®æœåŠ¡å™¨åŠæ³¨å†Œã€‚&lt;/li>
&lt;li>workflow çš„é…ç½®æ–‡ä»¶ä¹Ÿæ˜¯ç±»ä¼¼äº &lt;code>.gitlab.yml&lt;/code> çš„ &lt;code>yaml&lt;/code> æ–‡ä»¶ï¼Œä½†éœ€è¦æ·»åŠ åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ &lt;code>.github/workflows&lt;/code> è·¯å¾„ä¸­ã€‚&lt;/li>
&lt;li>å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å…±äº«æˆ–ä½¿ç”¨ä»–äººåˆ›å»ºçš„è„šæœ¬å‘½ä»¤ï¼Œå³ actionã€‚&lt;/li>
&lt;/ul>
&lt;p>æ¥ä¸‹æ¥æˆ‘å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ GitHub Actions è‡ªåŠ¨å‘å¸ƒä¸€ä¸ª Hugo é™æ€ç«™ç‚¹åˆ° GitHub Pagesã€‚&lt;/p>
&lt;h4 id="ä½¿ç”¨-github-actions-è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹">ä½¿ç”¨ GitHub Actions è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹&lt;/h4>
&lt;p>å¤§è‡´çš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>åœ¨æœ¬åœ°å†…å®¹ä»“åº“å¼€å‘ç«™ç‚¹å†…å®¹ï¼Œå®Œæˆåå°†å†…å®¹æ¨é€åˆ°å…±äº«ä»“åº“ã€‚è¯¥å…±äº«ä»“åº“å¯èƒ½æ˜¯ç§æœ‰çš„ã€‚&lt;/li>
&lt;li>å…±äº«ä»“åº“æ¥å—æ¨é€åè§¦å‘ workflowï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
&lt;ol>
&lt;li>åœ¨ Runner ä¸­æ‹‰å–æäº¤çš„å†…å®¹ã€‚&lt;/li>
&lt;li>é…ç½®ç¯å¢ƒå¹¶å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Hugoã€‚&lt;/li>
&lt;li>è¿è¡Œ Hugo æ ¹æ®æäº¤å†…å®¹ç”Ÿæˆé™æ€ç«™ç‚¹ã€‚&lt;/li>
&lt;li>å°†é™æ€æ–‡ä»¶æ¨é€åˆ°å‘å¸ƒä»“åº“ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>å‘å¸ƒä»“åº“åœ¨æ¥æ”¶åˆ°æ¨é€å†…å®¹åä¼šè‡ªåŠ¨æ›´æ–° Pages é¡µé¢ã€‚&lt;/li>
&lt;/ol>
&lt;p>GitHub ä¸Šæœ‰è®¸å¤šè¿™ç±»è‡ªåŠ¨åŒ–éƒ¨ç½²ä»»åŠ¡çš„å¼€æº Actions é¡¹ç›®ï¼Œæˆ‘ä»¬é€‰æ‹©äº†å…¶ä¸­ä¸€ä¸ªç®€å•æ˜“ç”¨çš„Â &lt;a href="https://github.com/peaceiris/actions-hugo#getting-started">GitHub Actions for Hugo&lt;/a>ã€‚å…·ä½“çš„æ“ä½œæ­¥éª¤æˆªå›¾å’Œè¯¦ç»†é…ç½®é¡¹å¯ä»¥æŸ¥çœ‹è¯¥é¡¹ç›®çš„Â &lt;a href="https://github.com/peaceiris/actions-hugo#github-actions-for-hugo">README&lt;/a>ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸‹é…ç½®è¿‡ç¨‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>åœ¨æœ¬åœ°å†…å®¹ä»“åº“ä¸­æ·»åŠ ç›®å½•å’Œæ–‡ä»¶ï¼š&lt;code>.github/workflows/gh-pages.yml&lt;/code>ï¼Œ&lt;code>gh-pages.yml&lt;/code>Â æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">github pages&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">push&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">branches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">main &lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># æ¯æ¬¡æ¨é€åˆ° main åˆ†æ”¯éƒ½ä¼šè§¦å‘éƒ¨ç½²ä»»åŠ¡&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">deploy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-18.04&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">submodules&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Fetch Hugo themes (true OR recursive)&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fetch-depth&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Fetch all history for .GitInfo and .Lastmod&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Setup Hugo&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">peaceiris/actions-hugo@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hugo-version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;0.79.1&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">extended&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Build&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">hugo --minify&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Deploy&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">peaceiris/actions-gh-pages@v3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">deploy_key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.ACTIONS_DEPLOY_KEY }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">external_repository&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;USERNAME&amp;gt;/&amp;lt;USERNAME&amp;gt;.github.io &lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># å‘å¸ƒä»“åº“åç§°&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">publish_branch&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">main&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">publish_dir&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">./public&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†å¦‚ä¸‹çš„ workflowï¼š&lt;/p>
&lt;ol>
&lt;li>workflow åç§°ä¸º &lt;code>github pages&lt;/code>ã€‚&lt;/li>
&lt;li>ä»…åœ¨æ¨é€æäº¤åˆ° &lt;code>main&lt;/code> åˆ†æ”¯æ—¶æ‰§è¡Œã€‚&lt;/li>
&lt;li>å«æœ‰ä¸€ä¸ªåä¸º &lt;code>deploy&lt;/code> çš„ä»»åŠ¡ï¼Œå¹¶éœ€è¦åœ¨&lt;code>ubuntu-18.04&lt;/code>å¹³å°çš„ Runner æ‰§è¡Œã€‚&lt;/li>
&lt;li>ä»»åŠ¡ä¸­çš„ç¬¬ä¸€ä¸ªæ­¥éª¤ä½¿ç”¨äº†åä¸º &lt;code>actions/checkout@v2&lt;/code> çš„ &lt;code>action&lt;/code>ï¼Œä»¥æ‹‰å–æäº¤çš„å†…å®¹åˆ° Runnerã€‚&lt;/li>
&lt;li>ç¬¬äºŒä¸ªæ­¥éª¤ä½¿ç”¨ &lt;code>peaceiris/actions-hugo@v2&lt;/code> action é…ç½® Hugoï¼Œå¹¶æŒ‡å®šç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>ç¬¬ä¸‰ä¸ªæ­¥éª¤ç›´æ¥æ‰§è¡Œ &lt;code>hugo --minify&lt;/code> å‘½ä»¤ï¼Œç”Ÿæˆé™æ€ç«™ç‚¹ï¼ˆé»˜è®¤è¾“å‡ºæ–‡ä»¶åˆ° &lt;code>public&lt;/code> ç›®å½•ï¼‰&lt;/li>
&lt;li>ç¬¬å››ä¸ªæ­¥éª¤ä½¿ç”¨ &lt;code>peaceiris/actions-gh-pages@v3&lt;/code> action å°†ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ°æŒ‡å®šçš„å¤–éƒ¨ä»“åº“ã€‚&lt;/li>
&lt;/ol>
&lt;p>è¿™ä¸ªÂ &lt;code>workflow&lt;/code>Â åŸºäºå†…å®¹ä»“åº“è¿è¡Œï¼Œä½†æˆ‘ä»¬éœ€è¦å°†è¿è¡Œè¿‡ç¨‹ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ°å‘å¸ƒä»“åº“è¿›è¡Œå‘å¸ƒï¼Œå› æ­¤è¿˜éœ€è¦åœ¨ä¸¤ä¸ªä»“åº“ä¸­åˆ†åˆ«è®¾ç½®å¯†é’¥ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨æœ¬åœ°ç”Ÿæˆ SSH éƒ¨ç½²å¯†é’¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">ssh-keygen -t rsa -b &lt;span class="m">4096&lt;/span> -C &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>git config user.email&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -f gh-pages -N &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;span class="c1"># å°†åœ¨å½“å‰ç›®å½•ç”Ÿæˆå¦‚ä¸‹å¯†é’¥æ–‡ä»¶:&lt;/span>
&lt;span class="c1"># gh-pages.pub (å…¬é’¥)&lt;/span>
&lt;span class="c1"># gh-pages (ç§é’¥)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>åœ¨ GitHub åˆ†åˆ«è¿›å…¥å†…å®¹ä»“åº“å’Œå‘å¸ƒä»“åº“çš„Â &lt;code>Settings&lt;/code>Â é¡µé¢ï¼š&lt;/p>
&lt;ul>
&lt;li>å°†å…¬é’¥Â &lt;code>gh-pages.pub&lt;/code>Â ä½œä¸ºÂ &lt;code>Secret&lt;/code>Â æ·»åŠ åˆ°å†…å®¹ä»“åº“ï¼Œå¹¶è®¾ç½®Â &lt;code>Name&lt;/code>Â ä¸ºÂ &lt;code>ACTIONS_DEPLOY_KEY&lt;/code>ã€‚&lt;/li>
&lt;li>å°†ç§é’¥Â &lt;code>gh-pages&lt;/code>Â ä½œä¸ºÂ &lt;code>Deploy Key&lt;/code>Â æ·»åŠ åˆ°å‘å¸ƒä»“åº“ï¼Œå¹¶è®¾ç½®ä¸ºÂ &lt;code>Allow write access&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æ•ˆæœã€‚&lt;/p>
&lt;p>åœ¨æœ¬åœ°å†…å®¹ä»“åº“åšä¸€äº›æ›´æ”¹ï¼Œé¢„è§ˆæ•ˆæœåæäº¤å¹¶æ¨é€ï¼Œç„¶ååœ¨å…±äº«ä»“åº“çš„ &lt;strong>GitHub Actions&lt;/strong> é¡µé¢æ£€æŸ¥ç›¸åº”Â &lt;code>workflow&lt;/code>Â çš„è¿è¡ŒçŠ¶æ€ä¸è¯¦ç»†ç»“æœï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/2020-01-04-actions-page.png" alt="2020-01-04-actions-page">&lt;/p>
&lt;p>è¿è¡ŒæˆåŠŸåï¼Œå¾ˆå¿«å‘å¸ƒä»“åº“å°†æ–°å¢ä¸€ä¸ªç”±è¯¥Â &lt;code>workflow&lt;/code>Â åˆ›å»ºçš„æäº¤ï¼Œç›¸åº”çš„ GitHub Pages ä¹Ÿä¼šæ›´æ–°ç›¸åº”çš„å†…å®¹ã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å›´ç»•ä¿éšœä»£ç è´¨é‡è¿™ä¸€ç›®çš„ï¼š&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆä»‹ç»äº† Linterã€Static Type Checkerã€Autoformatter ä¸‰ç§å·¥å…·å¹¶å„å±•ç¤ºäº†ä¸€ä¸ªä»£è¡¨æ€§å·¥å…·çš„ä½¿ç”¨æ–¹æ³•ã€‚&lt;/li>
&lt;li>å°†è¿™äº›å·¥å…·é€šè¿‡ &lt;code>pre-commit&lt;/code> é›†æˆåˆ° &lt;code>git hooks&lt;/code> ä¸­ï¼Œåœ¨ä»£ç å¼€å‘å·¥ä½œæµä¸­è‡ªåŠ¨æ‰§è¡Œã€‚&lt;/li>
&lt;li>ä»‹ç»äº†CI/CDï¼Œå¹¶ä»¥ GitLab CI pipeline ä¸ºä¾‹å°†ä»¥ä¸Šæ£€æŸ¥éƒ¨ç½²åˆ°å…±äº«ä»“åº“ï¼Œåœ¨æ¯æ¬¡ä»£ç æäº¤åè‡ªåŠ¨æ‰§è¡Œã€‚&lt;/li>
&lt;li>é¡ºä¾¿ä»‹ç»äº†ä¸€ä¸ªé€šè¿‡ GitHub Actions å®ç°æŒç»­éƒ¨ç½²çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº† GitHub æŒç»­é›†æˆæœåŠ¡çš„åŸºæœ¬ç”¨æ³•ã€‚&lt;/li>
&lt;/ol>
&lt;p>ç»è¿‡ç®€å•å‡ æ­¥çš„ä¸€æ¬¡æ€§é…ç½®ï¼Œä½ å°±å¯ä»¥æ‹¥æœ‰ä¸€å¥—é«˜åº¦è‡ªåŠ¨åŒ–çš„ä»£ç è´¨é‡å·¥å…·å·¥ä½œæµç¨‹ã€‚ä½†å·¥å…·åªæ˜¯ä¿éšœä»£ç è´¨é‡ä¼—å¤šç¯èŠ‚ä¸­æœ€å®¹æ˜“å‘åŠ›ï¼Œè§æ•ˆå¿«ï¼Œä½†ä½œç”¨ä¹Ÿå¾ˆæœ‰é™çš„ä¸€ç¯ã€‚çœŸæ­£å®ç°ä¿è¯ä»£ç è´¨é‡è¿™ä¸€ç›®æ ‡ä»»é‡è€Œé“è¿œï¼Œè¿˜éœ€è¦æˆ‘ä»¬åœ¨ä¸ªäººå’Œå›¢é˜Ÿè¿™ä¸¤ä¸ªæ–¹é¢è®¤è¯†åˆ°ä»£ç è´¨é‡çš„é‡è¦æ€§ï¼Œå¹¶ä¸æ–­è·µè¡Œå„ç§ä»£ç è´¨é‡è®¾è®¡ä¸æ´»åŠ¨ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://en.wikipedia.org/wiki/Lint_(software)">Linter-Wikipedia&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://flake8.pycqa.org/en/latest/">Flake8&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://mypy.readthedocs.io/en/stable/">Mypy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://realpython.com/python-type-checking">Python Type Checking (Guide)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://black.readthedocs.io/en/stable/">Black&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">Customizing Git - Git Hooks&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://pre-commit.com/">pre-commit&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.github.com/en/free-pro-team@latest/actions/guides/about-continuous-integration">About continuous integration&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.gitlab.com/ee/ci/README.html">GitLab CI/CD&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.github.com/en/free-pro-team@latest/actions/quickstart">Quickstart for GitHub Actions&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.github.com/en/free-pro-team@latest/actions/learn-github-actions/introduction-to-github-actions">Introduction to GitHub Actions&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">GitHub Actions å…¥é—¨æ•™ç¨‹&lt;/a>&lt;/li>
&lt;/ul></description><category domain="https://www.waynerv.com/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</category><category domain="https://www.waynerv.com/tags/%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F/">ä»£ç è´¨é‡</category><category domain="https://www.waynerv.com/tags/ci/">CI</category></item><item><title>Git åˆå¹¶æ“ä½œæµ…æ</title><link>https://www.waynerv.com/posts/git-merge-intro/</link><guid isPermaLink="true">https://www.waynerv.com/posts/git-merge-intro/</guid><pubDate>Tue, 29 Dec 2020 07:17:23 +0800</pubDate><author>ampedee@gmail.com (Waynerv)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>åˆå¹¶åœ¨ Git ä¸­æ˜¯ä¸€ä¸ªååˆ†å¸¸è§çš„æ“ä½œï¼šæ•´åˆä¸åŒåˆ†æ”¯ä¹‹é—´çš„æ›´æ”¹ï¼Œæˆ–è€…å¯¹è¿œç¨‹åˆ†æ”¯æ‰§è¡Œ &lt;code>pull&lt;/code> åŠ &lt;code>push&lt;/code> æ“ä½œï¼Œéƒ½éœ€è¦è¿›è¡Œåˆå¹¶ã€‚&lt;/p>
&lt;p>ä½†å¯¹æ–°æ‰‹æ¥è¯´ï¼Œ &lt;code>git merge&lt;/code> è¿™ä¸€å‘½ä»¤æœ‰äº›ä»¤äººç”Ÿç•ï¼Œå› ä¸ºåœ¨ä¸åŒæƒ…å†µä¸‹ï¼Œæ‰§è¡Œ &lt;code>merge&lt;/code> å¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚è¿™ç§å¯¹äºç»“æœçš„ä¸ç¡®å®šæ€§ï¼Œä½¿æˆ‘å¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½ä¸æ•¢ä¸»åŠ¨å»ä½¿ç”¨å®ƒï¼Œè€Œæ˜¯ä¾èµ– GitHub çš„ &lt;code>Pull Request&lt;/code> æˆ–è€… GitLab çš„ &lt;code>Merge Request&lt;/code> ç­‰å¯è§†åŒ–ç•Œé¢æ‰‹åŠ¨åˆå¹¶ã€‚&lt;/p>
&lt;p>ä¸ºäº†ä»Šåå¯ä»¥æ”¾å¿ƒå¤§èƒ†çš„ &lt;code>merge&lt;/code>ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥å¯¹ &lt;code>merge&lt;/code> ä¸€æ¢ç©¶ç«Ÿã€‚&lt;/p>
&lt;h2 id="è®¤è¯†åˆå¹¶">è®¤è¯†åˆå¹¶&lt;/h2>
&lt;p>åœ¨ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ï¼Œåˆå¹¶æ˜¯å°†ä¸€ç»„æ–‡ä»¶ä¸­æ‰€å‘ç”Ÿçš„ä¸åŒæ›´æ”¹è¿›è¡Œæ•´åˆçš„åŸºç¡€æ“ä½œã€‚é€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ Git æ—¶ä¼šå»ºç«‹ä¸åŒçš„åˆ†æ”¯ï¼Œç”±ä¸åŒçš„äººå¯¹åŒä¸€ç»„æ–‡ä»¶æ‰§è¡Œæ–°å¢ã€ç¼–è¾‘ç­‰æ“ä½œï¼Œæœ€ç»ˆæˆ‘ä»¬éœ€è¦åˆå¹¶è¿™äº›åä½œçš„åˆ†æ”¯ï¼Œæ•´åˆæ‰€æœ‰çš„æ›´æ”¹å½¢æˆä¸€ä»½æ–‡ä»¶ç‰ˆæœ¬ã€‚&lt;/p>
&lt;p>åˆå¹¶ä¸€èˆ¬ç”± Git æ ¹æ®ç®—æ³•è‡ªåŠ¨æ‰§è¡Œï¼Œä½†å¦‚æœå‘ç”Ÿäº†å†²çªï¼Œæ¯”å¦‚å¯¹åŒä¸€æ–‡ä»¶çš„åŒä¸€å¤„å†…å®¹æ‰§è¡Œäº†ä¸åŒçš„æ›´æ”¹ï¼Œåˆ™éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨åˆå¹¶ã€‚&lt;/p>
&lt;h3 id="é€’å½’ä¸‰è·¯åˆå¹¶ç®—æ³•">é€’å½’ä¸‰è·¯åˆå¹¶ç®—æ³•&lt;/h3>
&lt;p>Git åœ¨è‡ªåŠ¨åˆå¹¶æ—¶ä¼šä½¿ç”¨ã€Œ&lt;a href="https://en.wikipedia.org/wiki/Merge_(version_control)#Recursive_three-way_merge">é€’å½’ä¸‰è·¯åˆå¹¶&lt;/a>ã€ç®—æ³•å¯¹ä¸åŒæ–‡ä»¶è¿›è¡Œå·®å¼‚åˆ†æï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹è¯¥ç®—æ³•ã€‚&lt;/p>
&lt;p>é¦–å…ˆä»ã€Œä¸‰è·¯åˆå¹¶ã€ç®—æ³•å¼€å§‹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹æäº¤å†å²ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Dec-29-2020-merge.gif" alt="Dec-29-2020 22-40-46">&lt;/p>
&lt;p>ä¸Šå›¾ä¸­æˆ‘ä»¬åœ¨ &lt;code>master&lt;/code> åˆå¹¶äº† &lt;code>feature&lt;/code> åˆ†æ”¯ï¼Œç°åœ¨æˆ‘ä»¬å›æº¯ä¸€ä¸‹åˆå¹¶çš„è¿‡ç¨‹ï¼š&lt;/p>
&lt;p>æ­¤æ—¶ &lt;code>master&lt;/code> æ­£æŒ‡å‘æäº¤ Cï¼ŒGit é¦–å…ˆæ‰¾åˆ°ä¸¤ä¸ªåˆ†æ”¯æœ€è¿‘çš„å”¯ä¸€å…±åŒç¥–å…ˆæäº¤ Aï¼Œç„¶ååˆ†åˆ«å¯¹ Aã€Cã€F æäº¤çš„æ–‡ä»¶å¿«ç…§è¿›è¡Œå¯¹æ¯”ï¼Œæˆ‘ä»¬ä¸‹æ–‡ç§°å‘¼å®ƒä»¬ä¸º Aã€Cã€F æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ Git å°†é€ã€Œè¡Œã€å¯¹ä¸‰ä¸ªæ–‡ä»¶çš„å†…å®¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸‰ä¸ªæ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶è¯¥è¡Œçš„å†…å®¹ä¸€è‡´ï¼Œåˆ™ä¸¢å¼ƒ A æ–‡ä»¶ä¸­è¯¥è¡Œçš„å†…å®¹ï¼Œä¿ç•™ä¸ A æ–‡ä»¶ä¸­ä¸åŒçš„å†…å®¹æ”¾åˆ°ç»“æœæ–‡ä»¶ä¸­ã€‚&lt;/p>
&lt;p>å…·ä½“æ¥è¯´ï¼Œå‡å¦‚ Aã€C å†…å®¹ä¸€è‡´ï¼Œè¯´æ˜è¿™æ˜¯åœ¨ F ä¸­æ›´æ”¹çš„å†…å®¹ï¼Œéœ€è¦ä¿ç•™è¯¥æ›´æ”¹ï¼›Aã€F å†…å®¹ä¸€è‡´åŒç†ï¼›å‡å¦‚ Cã€F å†…å®¹ä¸€è‡´ï¼Œè¯´æ˜ C å’Œ F éƒ½ç›¸å¯¹äº A åšäº†åŒæ ·çš„æ›´æ”¹ï¼ŒåŒæ ·éœ€è¦ä¿ç•™ã€‚é™¤æ­¤ä¹‹å¤–çš„å†…å®¹å·®å¼‚ä»…å‰©ä¸¤ç§æƒ…å†µï¼šå¦‚æœ Aã€Cã€F çš„å†…å®¹éƒ½ä¸€è‡´ï¼Œè¯´æ˜ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿï¼›å¦‚æœè¯¥è¡Œåœ¨ Aã€Cã€F çš„å†…å®¹éƒ½ä¸ä¸€è‡´ï¼Œè¯´æ˜å‘ç”Ÿäº†å†²çªï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨åˆå¹¶é€‰æ‹©éœ€è¦ä¿ç•™çš„å†…å®¹ã€‚&lt;/p>
&lt;p>ç»“æŸå¯¹æ¯”å Git ä¼šä»¥æœ€ç»ˆçš„ç»“æœæ–‡ä»¶å¿«ç…§åˆ›å»ºä¸€ä¸ªæ–°çš„ Merge æäº¤å¹¶æŒ‡å‘å®ƒã€‚&lt;/p>
&lt;p>ä¸‰è·¯åˆå¹¶ç®—æ³•çš„åŸºç¡€æ˜¯æ‰¾åˆ°è¢«åˆå¹¶æ–‡ä»¶çš„å…±åŒç¥–å…ˆï¼Œåœ¨ä¸€äº›ç®€å•çš„åœºæ™¯ä¸­è¿™è¿˜èƒ½è¡Œçš„é€šï¼Œä½†åœ¨é‡åˆ°&lt;a href="https://zh.wikipedia.org/wiki/%E5%90%88%E5%B9%B6_(%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6)#cite_note-2">åå­—äº¤å‰åˆå¹¶ï¼ˆcriss-cross mergeï¼‰&lt;/a>æ—¶ï¼Œä¸å­˜åœ¨å”¯ä¸€çš„æœ€è¿‘å…±åŒç¥–å…ˆï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/20201229152228-criss-cross-merge.png" alt="20201229152228-criss-cross-merge">&lt;/p>
&lt;p>ç°åœ¨æˆ‘ä»¬éœ€è¦ä» &lt;code>main&lt;/code> åˆ†æ”¯åˆå¹¶ &lt;code>feature&lt;/code> åˆ†æ”¯ï¼Œå³æŠŠ C7 åˆå¹¶åˆ° C8ï¼Œä¼šå‘ç° C8 å’Œ C7 æœ‰ä¸¤ä¸ªå…±åŒç¥–å…ˆï¼Œè¿™ä¸‹æ€ä¹ˆåŠå‘¢ï¼ŸGit é‡‡å–çš„æ˜¯é€’å½’ä¸‰è·¯åˆå¹¶ï¼ˆRecursive three-way mergeï¼‰ï¼Œä¼šå…ˆåˆå¹¶ C3 å’Œ C5 è¿™ä¸¤ä¸ªå…±åŒç¥–å…ˆåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„å”¯ä¸€æœ€è¿‘ç¥–å…ˆï¼ˆå‡è®¾ä¸º C9ï¼‰ï¼Œæ¥ç€åœ¨ C9ã€C7ã€C8 ä¹‹é—´æ‰§è¡Œä¸‰è·¯åˆå¹¶ï¼Œå¦‚æœåœ¨åˆå¹¶ C3 å’Œ C5 çš„è¿‡ç¨‹ä¸­åˆå‘ç”Ÿæ²¡æœ‰å”¯ä¸€å…±åŒç¥–å…ˆçš„æƒ…å†µï¼Œåˆ™é€’å½’æ‰§è¡Œä¸Šè¿°è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>å…³äºé€’å½’ä¸‰è·¯åˆå¹¶ç®—æ³•æˆ‘ä»¬å°±äº†è§£åˆ°è¿™é‡Œã€‚&lt;/p>
&lt;h3 id="åˆå¹¶å†²çª">åˆå¹¶å†²çª&lt;/h3>
&lt;p>å¦‚æœä½ åœ¨ä¸¤ä¸ªä¸åŒçš„åˆ†æ”¯ä¸­ï¼Œå¯¹åŒä¸€ä¸ªæ–‡ä»¶çš„åŒä¸€ä¸ªéƒ¨åˆ†è¿›è¡Œäº†ä¸åŒçš„ä¿®æ”¹ï¼ŒGit å°±æ— æ³•è‡ªåŠ¨åœ°åˆå¹¶å®ƒä»¬ï¼Œè€Œæ˜¯ä¼šæš‚åœåˆå¹¶è¿‡ç¨‹ï¼Œç­‰å¾…ä½ å»æ‰‹åŠ¨è§£å†³å†²çªã€‚&lt;/p>
&lt;p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¿™äº›éœ€è¦è§£å†³å†²çªçš„æ–‡ä»¶ï¼Œä½¿ç”¨ &lt;code>git status&lt;/code> å¯ä»¥æŸ¥çœ‹è¿™äº›å› åŒ…å«åˆå¹¶å†²çªè€Œå¤„äºæœªåˆå¹¶çŠ¶æ€çš„æ–‡ä»¶ï¼š&lt;/p>
&lt;pre>&lt;code>$ git status
On branch master
You have unmerged paths.
(fix conflicts and run &amp;quot;git commit&amp;quot;)
Unmerged paths:
(use &amp;quot;git add &amp;lt;file&amp;gt;...&amp;quot; to mark resolution)
both modified: main.py
no changes added to commit (use &amp;quot;git add&amp;quot; and/or &amp;quot;git commit -a&amp;quot;)
&lt;/code>&lt;/pre>&lt;p>æ‰‹åŠ¨è§£å†³å†²çªç±»ä¼¼äºäºŒé€‰ä¸€çš„è¿‡ç¨‹ï¼ŒGit ä¼šåœ¨æœ‰å†²çªçš„æ–‡ä»¶ä¸­åŠ å…¥ç‰¹æ®Šçš„æ ‡è®°ï¼Œçœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š&lt;/p>
&lt;pre>&lt;code>&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt; HEAD:main.py
print(&amp;quot;Hello World&amp;quot;)
=======
print(&amp;quot;World Hello&amp;quot;)
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt; feature:main.py
&lt;/code>&lt;/pre>&lt;p>é€šè¿‡ &lt;code>=======&lt;/code> è¿›è¡Œåˆ†å‰²ï¼Œä»¥ &lt;code>&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt; HEAD:main.py&lt;/code> æ ‡è®°ä¸ºä¸Šç•Œçš„ä¸ŠåŠéƒ¨åˆ†æ˜¯å½“å‰åˆ†æ”¯ &lt;code>master&lt;/code> æ‰€åšçš„æ›´æ”¹ï¼Œä»¥ &lt;code>&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt; feature:main.py&lt;/code> æ ‡è®°ä¸ºä¸‹ç•Œçš„ä¸‹åŠéƒ¨åˆ†æ˜¯è¦åˆå¹¶çš„ &lt;code>feature&lt;/code> å¯¹åŒä¸€å†…å®¹æ‰€åšçš„ä¸åŒæ›´æ”¹ã€‚æˆ‘ä»¬éœ€è¦ç¼–è¾‘æ–‡ä»¶åˆ é™¤è¿™äº›æ ‡è®°ï¼Œä»…ä¿ç•™æˆ‘ä»¬éœ€è¦çš„å†…å®¹ï¼š&lt;/p>
&lt;pre>&lt;code>print(&amp;quot;Hello World&amp;quot;)
&lt;/code>&lt;/pre>&lt;p>å½“ç„¶ä¹Ÿå¯ä»¥ä¸ä»ä¸­é€‰æ‹©ï¼Œè€Œæ˜¯ç”¨ä¸€æ®µå…¨æ–°çš„å†…å®¹å»æ›¿æ¢å®ƒã€‚&lt;/p>
&lt;p>åœ¨è§£å†³äº†æ‰€æœ‰æ–‡ä»¶é‡Œçš„å†²çªä¹‹åï¼Œéœ€è¦ä½¿ç”¨ &lt;code>git add&lt;/code> æš‚å­˜è¿™äº›æ–‡ä»¶æ¥å°†å…¶æ ‡è®°ä¸ºå†²çªå·²è§£å†³ã€‚ç„¶åå†æ‰§è¡Œ &lt;code>git commit&lt;/code> æ¥å®Œæˆåˆå¹¶æäº¤ã€‚ Git ä¼šå°†è§£å†³çš„è¿™äº›å†²çªï¼ŒåŠ å…¥åˆ°ä¸Šæ–‡æåˆ°çš„æ–°å¢çš„ Merge æäº¤é‡Œã€‚&lt;/p>
&lt;h3 id="å¿«è¿›åˆå¹¶">å¿«è¿›åˆå¹¶&lt;/h3>
&lt;p>ä¹Ÿæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œäº†åˆå¹¶æ“ä½œåï¼Œä¼šå‘ç°å¹¶æ²¡æœ‰å¢åŠ ä¸€ä¸ªæ–°çš„ Merge æäº¤ã€‚è¿™ç§æƒ…å†µæˆ‘ä»¬ç§°ä¹‹ä¸ºå¿«è¿›ï¼ˆfast-forwardï¼‰åˆå¹¶ã€‚&lt;/p>
&lt;p>å‡è®¾æˆ‘ä»¬åŸºäº &lt;code>master&lt;/code> åˆ›å»ºäº† &lt;code>feature&lt;/code> åˆ†æ”¯ï¼Œå¹¶æ–°å¢äº†ä¸€äº›æäº¤ã€‚ç°åœ¨æˆ‘ä»¬å°† &lt;code>feature&lt;/code> çš„æ›´æ”¹åˆå…¥ &lt;code>master&lt;/code> åˆ†æ”¯ï¼š&lt;/p>
&lt;pre>&lt;code>$ git checkout master
$ git merge feature
Updating f42c576..3a0874c
Fast-forward
main.py | 2 ++
task.py | 3 ++
worker.py | 1 ++
3 file changed, 6 insertions(+)
&lt;/code>&lt;/pre>&lt;p>è¿‡ç¨‹ç¤ºæ„å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Dec-29-2020-fast-forward.gif" alt="Dec-29-2020 22-50-28">&lt;/p>
&lt;p>ç”±äºæˆ‘ä»¬æƒ³è¦åˆå¹¶çš„åˆ†æ”¯ &lt;code>feature&lt;/code> æ‰€æŒ‡å‘çš„æäº¤ D æ˜¯ &lt;code>master&lt;/code> çš„ç›´æ¥åç»§ï¼Œ å› æ­¤ Git ä¼šç›´æ¥å°† &lt;code>HEAD&lt;/code> æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœé¡ºç€ä¸€ä¸ªåˆ†æ”¯èµ°ä¸‹å»ä¸€å®šèƒ½å¤Ÿåˆ°è¾¾å¦ä¸€ä¸ªåˆ†æ”¯ï¼Œé‚£ä¹ˆ Git åœ¨åˆå¹¶ä¸¤è€…æ—¶åªä¼šç®€å•çš„å°†æŒ‡é’ˆå‘å‰æ¨è¿›ï¼ˆå³ç§»ï¼‰ï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹çš„åˆå¹¶æ“ä½œæ²¡æœ‰éœ€è¦è§£å†³çš„åˆ†æ­§â€”â€”è¿™å°±å«åšå¿«è¿›ï¼ˆfast-forwardï¼‰ã€‚&lt;/p>
&lt;h2 id="git-çš„ä¸åŒåˆå¹¶ç­–ç•¥">Git çš„ä¸åŒåˆå¹¶ç­–ç•¥&lt;/h2>
&lt;p>æˆ‘ä»¬åœ¨ä½¿ç”¨ Git æ—¶ï¼Œé€šå¸¸ä¼šåŸºäºä¸»åˆ†æ”¯æ‹‰å‡ºè‹¥å¹²æ¡åŠŸèƒ½åˆ†æ”¯è¿›è¡Œå¼€å‘ï¼Œå¼€å‘å®Œæ¯•åå†å°†åŠŸèƒ½åˆ†æ”¯åˆå…¥ä¸»åˆ†æ”¯ã€‚æœ‰ä»¥ä¸‹ä¸åŒçš„åˆ†æ”¯åˆå¹¶ç­–ç•¥ï¼š&lt;/p>
&lt;ul>
&lt;li>é€šè¿‡ &lt;code>merge&lt;/code> æ˜¾å¼åˆå¹¶&lt;/li>
&lt;li>é€šè¿‡ &lt;code>rebase&lt;/code> æˆ– &lt;code>fast-forward&lt;/code> éšå¼åˆå¹¶&lt;/li>
&lt;li>&lt;code>squash&lt;/code> åéšå¼åˆå¹¶&lt;/li>
&lt;/ul>
&lt;h3 id="é€šè¿‡-merge-æ˜¾å¼åˆå¹¶">é€šè¿‡ &lt;code>merge&lt;/code> æ˜¾å¼åˆå¹¶&lt;/h3>
&lt;p>è¿™æ˜¯æœ€å¸¸è§å’Œæœ€ç›´æ¥çš„åˆå¹¶æ–¹å¼ï¼Œä¹Ÿæ˜¯ GitHub å’Œ GitLab ç­‰ä»£ç æ‰˜ç®¡å¹³å°çš„é»˜è®¤å®ç°æ–¹å¼ã€‚&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Dec-29-2020-merge.gif" alt="Dec-29-2020 22-40-46">&lt;/p>
&lt;p>å½“æˆ‘ä»¬å°†åŠŸèƒ½åˆ†æ”¯åˆå…¥ä¸»åˆ†æ”¯æ—¶ï¼ŒGit ä¼šå¯¹ä¸¤ä¸ªåˆ†æ”¯è¿›è¡Œé€’å½’ä¸‰è·¯åˆå¹¶ï¼Œå¹¶ä»¥åˆå¹¶ç»“æœåˆ›å»ºä¸€ä¸ªæ–°çš„ Merge æäº¤ã€‚è¿™ä¸ª Merge æäº¤å’Œæ™®é€šçš„æäº¤æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å®ƒæœ‰ä¸¤ä¸ªçˆ¶æäº¤ï¼š&lt;/p>
&lt;pre>&lt;code>$ git cat-file -p 44ba027
tree 5a1692ba62ef346b59e65e4aa441c731bebc51ff
parent 75bf5c59c2e7e493c98e026a415f16b8f0445e4a
parent bbbe6a4c02aa709299ac891779448daf8203df53
author xx &amp;lt;xx@xx.com&amp;gt; 1609141855 +0800
committer xx &amp;lt;xx@xx.com&amp;gt; 1609141855 +0800
Merge branch 'feature' into 'master'
&lt;/code>&lt;/pre>&lt;p>æˆ‘ä»¬èƒ½åœ¨æäº¤å†å²ä¸­ï¼Œå¾ˆæ˜äº†åœ°æ ¹æ® Merge æäº¤æŸ¥çœ‹å‘ç”Ÿçš„åˆå¹¶äº‹ä»¶ã€‚ä½†å¦ä¸€æ–¹é¢ï¼Œå¤§é‡çš„ Merge æäº¤ä¼šä½¿ä½ çš„æäº¤å†å²æœ‰å¾ˆå¤šåˆ†å‰ï¼Œç”šè‡³ååˆ†å‡Œä¹±ï¼Œæœ‰äº›å¼€å‘è€…æˆ–è€…å›¢é˜Ÿå¯èƒ½ä¼šæƒ³è¦ä¸€ä¸ªçœ‹ä¸Šå»æ›´åŠ æ•´æ´çš„çº¿æ€§æäº¤å†å²ã€‚&lt;/p>
&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ Git ä¸ä¼šåœ¨å¿«è¿›åˆå¹¶çš„æƒ…å†µä¸‹åˆ›å»ºå•ç‹¬çš„ Merge æäº¤ã€‚å‡å¦‚æˆ‘ä»¬æƒ³åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½åˆ›å»ºä¸€ä¸ª Merge æäº¤ï¼Œéœ€è¦åœ¨æ‰§è¡Œ &lt;code>git merge&lt;/code> å‘½ä»¤æ—¶æ·»åŠ  &lt;code>--no-ff&lt;/code> é€‰é¡¹ã€‚&lt;/p>
&lt;h3 id="é€šè¿‡-rebase-æˆ–-fast-forward-éšå¼åˆå¹¶">é€šè¿‡ &lt;code>rebase&lt;/code> æˆ– &lt;code>fast-forward&lt;/code> éšå¼åˆå¹¶&lt;/h3>
&lt;p>æˆ‘ä»¬å¯ä»¥ç”¨ &lt;code>rebase&lt;/code> æ›¿æ¢ &lt;code>merge&lt;/code> è¿›è¡Œåˆå¹¶ï¼Œæˆ‘åœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« &lt;a href="https://waynerv.github.io/posts/git-rebase-intro/">git-rebase æµ…æ&lt;/a>ä¸­è¯¦ç»†ä»‹ç»è¿‡ &lt;code>rebase&lt;/code> çš„åŸç†å’Œç”¨æ³•ï¼Œç®€å•æ¥è¯´ &lt;code>rebase&lt;/code> æ“ä½œä¼šæ‰¾åˆ°ä¸¤ä¸ªåˆ†æ”¯çš„æœ€è¿‘çš„ç¥–å…ˆæäº¤ï¼Œå¹¶åŸºäºç›®æ ‡åˆ†æ”¯æŒ‰é¡ºåºé‡æ–°åº”ç”¨å½“å‰åˆ†æ”¯åœ¨ç¥–å…ˆæäº¤ä¹‹åçš„æ›´æ”¹ã€‚å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹å›¾çš„ &lt;code>master&lt;/code> å’Œ &lt;code>feature&lt;/code> ä¸¤ä¸ªåˆ†æ”¯ï¼Œæ‰§è¡Œä¸‹åˆ—æ“ä½œï¼š&lt;/p>
&lt;pre>&lt;code>$ git checkout feature
$ git rebase master
$ git checkout master
$ git merge feature
&lt;/code>&lt;/pre>&lt;p>è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Dec-31-2020-rebase&amp;amp;fast-forfward.gif" alt="Dec-31-2020-rebase&amp;fast-forfward">&lt;/p>
&lt;p>æˆ‘ä»¬é¦–å…ˆç”¨ &lt;code>rebase&lt;/code> å°† &lt;code>master&lt;/code> åˆå¹¶åˆ°äº† &lt;code>feature&lt;/code>ï¼Œå³ä½¿ä¸¤ä¸ªåˆ†æ”¯éƒ½æœ‰ä¸åŒçš„æäº¤ï¼Œä¹Ÿå¾—åˆ°äº†ä¸€æ¡å®Œå…¨çº¿æ€§çš„ &lt;code>feature&lt;/code> åˆ†æ”¯ï¼Œè€Œä¸”æ²¡æœ‰é¢å¤–çš„ Merge æäº¤ã€‚&lt;/p>
&lt;p>æ¥ç€åˆåˆ‡æ¢åˆ° &lt;code>master&lt;/code> åˆ†æ”¯åˆå¹¶äº† &lt;code>feature&lt;/code>ã€‚&lt;code>rebase&lt;/code> ä¹‹åçš„ &lt;code>feature&lt;/code> åˆ†æ”¯ä¸Šï¼Œæ‰€æœ‰æäº¤éƒ½æ˜¯ &lt;code>master&lt;/code> çš„åç»§æäº¤ï¼Œå› æ­¤æˆ‘ä»¬å°†ç›´æ¥æ‰§è¡Œå¿«è¿›åˆå¹¶ã€‚å¿«è¿›åˆå¹¶åªæœ‰åœ¨ &lt;code>master&lt;/code> åˆ†æ”¯ä¸­æ²¡æœ‰æ¯” &lt;code>feature&lt;/code> æ›´æ–°çš„æäº¤æ—¶æ‰ä¼šå‘ç”Ÿï¼ˆä½¿ç”¨ &lt;code>rebase&lt;/code> èƒ½å¤Ÿç¡®ä¿è¯¥ç»“æœï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ&lt;code>master&lt;/code> çš„ &lt;code>HEAD&lt;/code> å¯ä»¥ç›´æ¥å³ç§»åˆ° &lt;code>feature&lt;/code> åˆ†æ”¯çš„æœ€æ–°æäº¤ã€‚è¿™æ ·åˆå¹¶ä¹Ÿä¸ä¼šç”Ÿæˆå•ç‹¬çš„ Merge æäº¤ï¼Œå®ƒåªæ˜¯å°†åˆ†æ”¯æ ‡ç­¾å¿«é€ŸæŒ‡å‘äº†æ–°çš„æäº¤ã€‚&lt;/p>
&lt;p>é€šè¿‡ &lt;code>rebase&lt;/code> æˆ– &lt;code>fast-forward&lt;/code> éšå¼çš„åˆå¹¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå¾—åˆ°ä¸€æ¡æ•´æ´çº¿æ€§çš„æäº¤å†å²ï¼Œä½†åŒæ—¶ä¹Ÿä¼šä¸¢å¤±è¿™äº›æäº¤æ›¾ç»çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚&lt;/p>
&lt;h3 id="squash-åéšå¼åˆå¹¶">&lt;code>squash&lt;/code> åéšå¼åˆå¹¶&lt;/h3>
&lt;p>è¿˜æœ‰ä¸€ç§åˆå¹¶å˜æ›´çš„ç­–ç•¥æ˜¯ï¼Œåœ¨æ‰§è¡Œå¿«è¿›åˆå¹¶æˆ– &lt;code>rebase&lt;/code> ä¹‹å‰ï¼Œå°†æ‰€æœ‰åŠŸèƒ½åˆ†æ”¯çš„æäº¤é€šè¿‡ &lt;code>rebase&lt;/code> äº¤äº’æ¨¡å¼çš„ &lt;code>squash&lt;/code> å‘½ä»¤å‹ç¼©æˆä¸€ä¸ªæäº¤ã€‚è¿™æ ·å¯ä»¥è¿›ä¸€æ­¥ä¿æŒä¸»åˆ†æ”¯æäº¤å†å²çš„çº¿æ€§å’Œæ•´æ´ã€‚å®ƒå°†ä¸€ä¸ªå®Œæ•´çš„åŠŸèƒ½å•ç‹¬ä¿å­˜åœ¨ä¸€æ¬¡æäº¤ä¸­ï¼Œä½†ä¹Ÿå¤±å»äº†å¯¹æ•´ä¸ªåŠŸèƒ½åˆ†æ”¯å¼€å‘è¿‡ç¨‹çš„è®°å½•å’Œç»†èŠ‚ã€‚å…·ä½“çš„æ“ä½œæ–¹æ³•å¯å‚è€ƒ&lt;a href="https://waynerv.github.io/posts/git-rebase-intro/#%E9%87%8D%E5%86%99%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2">é‡å†™æäº¤å†å²&lt;/a>ã€‚&lt;/p>
&lt;p>è¿™ä¸‰ç§ç­–ç•¥éƒ½æœ‰æ˜æ˜¾çš„ä¼˜ç¼ºç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å…·ä½“çš„åœºæ™¯ä»¥åŠè‡ªå·±çš„éœ€æ±‚è¿›è¡Œé€‰æ‹©ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Merge_(version_control)">Merge (version control)&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://git-scm.com/docs/git-merge">git-merge - Join two or more development histories together&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://blog.developer.atlassian.com/pull-request-merge-strategies-the-great-debate/#:~:text=And%20the%20merge%20can%20complete,of%20an%20earlier%20feature%20branch">Pull Request Merge Strategies: The Great Debate&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B0%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6">Git åˆ†æ”¯ - åˆ†æ”¯çš„æ–°å»ºä¸åˆå¹¶&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://segmentfault.com/a/1190000021712743">git mergeçš„åŸç†ï¼ˆé€’å½’ä¸‰è·¯åˆå¹¶ç®—æ³•ï¼‰&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul></description><category domain="https://www.waynerv.com/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</category><category domain="https://www.waynerv.com/tags/git/">Git</category></item><item><title>ä½¿ç”¨ Hugo å’Œ GitHub Pages éƒ¨ç½²ä¸ªäººåšå®¢</title><link>https://www.waynerv.com/posts/setup-blog-with-hugo-and-github-pages/</link><guid isPermaLink="true">https://www.waynerv.com/posts/setup-blog-with-hugo-and-github-pages/</guid><pubDate>Thu, 24 Dec 2020 21:47:50 +0800</pubDate><author>ampedee@gmail.com (Waynerv)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>ä½œä¸ºä¸€ä¸ªå·²ç»å…¥è¡Œäº†ä¸€å¹´å¤šçš„ï¼ˆè€ï¼‰æŠ€æœ¯äººï¼Œç»´æŠ¤ä¸€ä¸ªçœ‹å¾—è¿‡å»çš„ä¸ªäººåšå®¢æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚&lt;/p>
&lt;p>åˆšå­¦ç¼–ç¨‹çš„æ—¶å€™ï¼Œæˆ‘è¿˜å¼€æºè¿‡ä¸€ä¸ªåŸºäº Flask å’Œ MongoDB çš„&lt;a href="https://github.com/waynerv/originblog">åšå®¢é¡¹ç›®&lt;/a>ï¼Œä½†åé¢å°±æ²¡æ€ä¹ˆä½¿ç”¨å’Œç»´æŠ¤äº†ï¼Œé™¤å¼€ä¸»è§‚ä¸Šçš„æ‡’ï¼Œè¿˜å› ä¸ºï¼š&lt;/p>
&lt;ul>
&lt;li>è‡ªå»ºåšå®¢ç»•ä¸å¼€ä¸»æœºå’ŒåŸŸåï¼Œè¿™æ˜¯ä¸€ç¬”æŒç»­çš„ç»æµæˆæœ¬ã€‚å›½å†…çš„ä¸»æœºå¾€å¾€æ˜¯ç¬¬ä¸€å¹´å‰²è‚‰ç¬¬äºŒå¹´å®°çŒªï¼Œå›½å¤–çš„ä¸»æœºè®¿é—®å»¶è¿Ÿå¾ˆé«˜ã€‚&lt;/li>
&lt;li>å›½å†…ä¸»æœºæ›´éº»çƒ¦çš„æ˜¯è¿˜éœ€è¦å®šæœŸå¤‡æ¡ˆï¼Œç¬¬ä¸€ä¸ªåšå®¢å°±æ˜¯å› ä¸ºå¤‡æ¡ˆåˆ°æœŸä¸­æ–­äº†ã€‚&lt;/li>
&lt;li>åšå®¢åŠŸèƒ½çš„å®ç°æŠ€æœ¯éš¾åº¦ä¸å¤§ï¼Œå¼€å§‹è¿˜æœ‰ä¸€äº›æ–°é²œæ„Ÿï¼Œæœ‰äº†å·¥ä½œç»éªŒåå°±å¾ˆéš¾æœ‰å…´è¶£ç»§ç»­ç»´æŠ¤äº†ã€‚&lt;/li>
&lt;/ul>
&lt;p>åˆšå¥½æœ€è¿‘æœ‰å†™ä¸€äº›æ–‡ç« çš„æ‰“ç®—ï¼Œå†³å®šæ‰¾ä¸ªç®€å•ã€çœäº‹ï¼ˆæœ€åå‘ç°å¹¶æ²¡æœ‰ï¼‰ä¸”ä¸èŠ±é’±çš„è·¯å­æŠŠåšå®¢å†æèµ·æ¥ï¼Œç»è¿‡ä¸€ç•ªç ”ç©¶ï¼Œé€‰æ‹©äº†ç”Ÿæˆé™æ€ç«™ç‚¹å‘å¸ƒåˆ° GitHub Pages çš„æ–¹æ¡ˆã€‚&lt;/p>
&lt;h2 id="å·¥ä½œæµ">å·¥ä½œæµ&lt;/h2>
&lt;p>æ•´ä¸ªæ–¹æ¡ˆçš„æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>ç”¨ Markdown æ ¼å¼å†™ä½œæ–‡ç« ã€‚&lt;/li>
&lt;li>ä½¿ç”¨ç”Ÿæˆå™¨å°† markdown æ–‡ä»¶è½¬æ¢æˆé™æ€ç«™ç‚¹ã€‚&lt;/li>
&lt;li>å°†ç”Ÿæˆçš„ç«™ç‚¹å†…å®¹æ¨é€åˆ° GitHub å¹¶å‘å¸ƒã€‚&lt;/li>
&lt;/ol>
&lt;p>å†™ markdown æ²¡å•¥å¥½è¯´çš„ï¼Œä»€ä¹ˆç¼–è¾‘å™¨éƒ½å¯ä»¥ï¼Œæˆ‘ä¸€ç›´ç”¨çš„æ˜¯ Typoraã€‚&lt;/p>
&lt;p>é™æ€ç«™ç‚¹ç”Ÿæˆå™¨æˆ‘é€‰æ‹©äº† Hugoï¼ŒåŸå› æ˜¯æœ€è¿‘åˆšå¥½åœ¨å­¦ Goï¼Œæ­¤å¤–è¿˜æœ‰ Gatsbyã€Jekyllã€Hexoç­‰å¾ˆå¤šé€‰é¡¹ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥è¦åšçš„å·¥ä½œæ˜¯ç”Ÿæˆé™æ€ç«™ç‚¹å¹¶é€šè¿‡ GitHub Pages å‘å¸ƒã€‚&lt;/p>
&lt;h2 id="ç”Ÿæˆé™æ€ç«™ç‚¹">ç”Ÿæˆé™æ€ç«™ç‚¹&lt;/h2>
&lt;p>ä½¿ç”¨ Hugo ç”Ÿæˆé™æ€åšå®¢ç«™ç‚¹éå¸¸ç®€å•ï¼Œå…·ä½“çš„æ­¥éª¤å’Œç”¨æ³•å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£çš„ &lt;a href="https://gohugo.io/getting-started/quick-start/">Quick Start&lt;/a>ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å®‰è£… Hugoã€‚&lt;code>macOS&lt;/code> ä¸‹å¯ä»¥ç›´æ¥ä½¿ç”¨ &lt;code>homebrew&lt;/code>å®‰è£…ï¼š&lt;code>brew install hugo&lt;/code>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åˆ›å»ºä¸€ä¸ªæ–°çš„ç«™ç‚¹ã€‚è¿™ä¼šç”Ÿæˆä¸€ä¸ªç‰¹å®šç›®å½•ç»“æ„çš„é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œç”¨æ¥ç»´æŠ¤æ‰€æœ‰çš„ç«™ç‚¹å†…å®¹ã€‚å‡è®¾æˆ‘ä»¬æƒ³æŠŠå®ƒå‘½åä¸º &lt;code>hugo-blog&lt;/code>ï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºå¹¶åˆ‡æ¢åˆ°è¯¥ç›®å½•ï¼Œåç»­çš„æ“ä½œå’Œå‘½ä»¤éƒ½ä¼šåœ¨è¿™ä¸ªæ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š&lt;/p>
&lt;pre>&lt;code>hugo new site hugo-blog
cd hugo-blog
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>å®‰è£…ä¸€ä¸ªä¸»é¢˜ã€‚è¿™ä¸€æ­¥æ˜¯å¿…éœ€çš„ï¼Œå¦åˆ™ä¼šå› ä¸ºç¼ºå°‘åŸºç¡€æ¨¡æ¿æ— æ³•ç”Ÿæˆç«™ç‚¹ã€‚å®‰è£…ä¸»é¢˜æœ‰ 3 ç§æ–¹å¼ï¼Œä»¥ &lt;code>eureka&lt;/code> ä¸»é¢˜ä¸ºä¾‹ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ç›´æ¥ä¸‹è½½ä¸»é¢˜çš„å‹ç¼©æ–‡ä»¶ï¼Œå°†è§£å‹å¾—åˆ°çš„æ–‡ä»¶å¤¹é‡å‘½åä¸ºä¸»é¢˜åç§° &lt;code>eureka&lt;/code> æ”¾åˆ° &lt;code>themes/&lt;/code>ç›®å½•ä¸‹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ &lt;code>git submodule&lt;/code> å®‰è£…ï¼š&lt;/p>
&lt;pre>&lt;code>git init
git submodule add https://github.com/wangchucheng/hugo-eureka.git themes/eureka
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ &lt;code>Hugo Modules&lt;/code> å®‰è£…ï¼ˆè¿™ç§æ–¹å¼è¦æ±‚æœ¬æœºå®‰è£…æœ‰ &lt;a href="https://golang.org/dl/">Go 1.12&lt;/a> åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œä¸”åªæœ‰éƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰ï¼š&lt;/p>
&lt;pre>&lt;code>hugo mod init &amp;lt;module_name&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;code>&amp;lt;module_name&amp;gt;&lt;/code> å¹¶ä¸é‡è¦ï¼Œéšä¾¿èµ·ä¸ªåå­—å°±è¡Œã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>å®‰è£…åéœ€è¦å¯ç”¨ä¸»é¢˜ï¼Œæ–¹æ³•æ˜¯å°†ä¸»é¢˜åç§°å†™å…¥åˆ°æ ¹ç›®å½•ä¸‹çš„é»˜è®¤é…ç½®æ–‡ä»¶ &lt;code>config.yml&lt;/code> ä¸­ï¼š&lt;/p>
&lt;pre>&lt;code>echo 'theme = &amp;quot;eureka&amp;quot;' &amp;gt;&amp;gt; config.toml
&lt;/code>&lt;/pre>&lt;p>å¦‚æœæ˜¯é€šè¿‡ &lt;code>Hugo Modules&lt;/code> å®‰è£…ï¼Œéœ€è¦æŠŠä¸»é¢˜åç§°æ›¿æ¢æˆæ¨¡å—åç§°ï¼š&lt;/p>
&lt;pre>&lt;code>echo 'theme = &amp;quot;github.com/wangchucheng/hugo-eureka&amp;quot;' &amp;gt;&amp;gt; config.toml
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>æ·»åŠ ä¸€ç¯‡æ–‡ç« ã€‚å¯ä»¥ç›´æ¥åœ¨ &lt;code>content/posts&lt;/code> ç›®å½•ä¸‹åˆ›å»º markdown æ–‡ä»¶ï¼Œä½†éœ€è¦æ‰‹åŠ¨å†™å…¥ä¸€äº›å…ƒä¿¡æ¯ï¼Œå› æ­¤æ¨èä½¿ç”¨ Hugo è‡ªå¸¦çš„å‘½ä»¤ï¼š&lt;code>hugo new posts/my-first-post.md&lt;/code>ï¼Œæ·»åŠ çš„æ–‡ä»¶ä¼šä»¥å¦‚ä¸‹å…ƒä¿¡æ¯å¼€å¤´ï¼š&lt;/p>
&lt;pre>&lt;code>---
title: &amp;quot;My First Post&amp;quot;
date: 2019-03-26T08:47:11+01:00
draft: true
---
&lt;/code>&lt;/pre>&lt;p>åœ¨ä¸‹æ–¹æ¥ç€å†™å…¥æ–‡ç« å†…å®¹å³å¯ã€‚æ³¨æ„æ­¤æ—¶è¯¥æ–‡ä»¶ä¸ºè‰ç¨¿çŠ¶æ€ï¼Œå†™ä½œå®Œæˆåéœ€è¦æ”¹æˆ &lt;code>draft: false&lt;/code> æ‰èƒ½éƒ¨ç½²ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯åŠ¨ Hugo é¢„è§ˆæœåŠ¡å™¨ã€‚Hugo å¯ä»¥å¯åŠ¨ä¸€ä¸ª Web æœåŠ¡å™¨ï¼ŒåŒæ—¶æ„å»ºç«™ç‚¹å†…å®¹åˆ°å†…å­˜ä¸­å¹¶åœ¨æ£€æµ‹åˆ°æ–‡ä»¶æ›´æ”¹åé‡æ–°æ¸²æŸ“ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å¼€å‘ç¯å¢ƒå®æ—¶é¢„è§ˆå¯¹ç«™ç‚¹æ‰€åšçš„æ›´æ”¹ã€‚&lt;/p>
&lt;pre>&lt;code>hugo server -D
&lt;/code>&lt;/pre>&lt;p>æ·»åŠ  &lt;code>-D&lt;/code> é€‰é¡¹ä»¥è¾“å‡ºè‰ç¨¿çŠ¶æ€çš„æ–‡ç« ï¼Œæ‰§è¡ŒæˆåŠŸåå¯ä»¥é€šè¿‡ &lt;code>http://localhost:1313/&lt;/code> è®¿é—®ç«™ç‚¹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è‡ªå®šä¹‰ä¸»é¢˜é…ç½®ã€‚ç«™ç‚¹çš„é…ç½®é¡¹é»˜è®¤ä¿å­˜åœ¨æ ¹ç›®å½•çš„ &lt;code>config.toml&lt;/code> æ–‡ä»¶ä¸­ï¼Œé…ç½®é¡¹è¾ƒå¤šæ—¶é€šå¸¸ä¼šç”¨ä¸»é¢˜æä¾›çš„é¢„è®¾é…ç½®æ–‡ä»¶æ¥æ›¿æ¢è¯¥æ–‡ä»¶ï¼Œè¿˜å¯ä»¥é€šè¿‡&lt;code>config&lt;/code> ç›®å½•åŠ å¤šä¸ªæ–‡ä»¶çš„æ–¹å¼æ¥ç»„ç»‡é…ç½®ã€‚é»˜è®¤é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre>&lt;code>baseURL = &amp;quot;http://example.org/&amp;quot; # å‘å¸ƒåœ°å€ï¼Œç”±ä¸»æœºåä»¥åŠè·¯å¾„ç»„æˆ
languageCode = &amp;quot;en-us&amp;quot; # è¯­è¨€ä»£ç ï¼Œä¸­æ–‡å¯ä»¥è®¾ç½®ä¸º&amp;quot;zh&amp;quot;
title = &amp;quot;My New Hugo Site&amp;quot; # ç«™ç‚¹æ ‡é¢˜
&lt;/code>&lt;/pre>&lt;p>è¿™ä¸€æ­¥åº”è¯¥æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­æœ€éº»çƒ¦ä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºé—®é¢˜çš„ä¸€æ­¥ï¼Œè§†ä¹ä½ é€‰æ‹©çš„ä¸»é¢˜ä¸æƒ³è¦çš„åŠŸèƒ½ä¸åŒï¼Œéœ€è¦è‡ªå®šä¹‰çš„é…ç½®é¡¹ä¹Ÿä¸åŒï¼Œæ•°é‡ä»å‡ ä¸ªåˆ°ä¸Šç™¾ä¸ªä¸ç­‰ã€‚æœ‰äº›ä¸»é¢˜ä¼šæœ‰è¯¦ç»†çš„æ–‡æ¡£è§£é‡Šé…ç½®è¿‡ç¨‹ï¼Œæœ‰äº›åˆ™ä¸€ç¬”å¸¦è¿‡åªèƒ½è‡ªå·±å»æ‘¸ç´¢ï¼Œé…ç½®è¾ƒå¤šæ—¶ç›¸äº’é—´å¯èƒ½è¿˜æœ‰ä¾èµ–å…³ç³»ï¼Œæœ€å¥½æ›´æ”¹ä¸€ä¸ªé…ç½®å°±åˆ·æ–°ä¸€æ¬¡é¡µé¢ç¡®è®¤ä¸‹ç»“æœã€‚&lt;/p>
&lt;p>å»ºè®®èµ·æ­¥æ—¶ä¸€åˆ‡ä»ç®€ï¼ŒèŠ±å¤§æŠŠæ—¶é—´æå„ç§èŠ±é‡Œèƒ¡å“¨çš„æ ·å¼å’ŒåŠŸèƒ½ï¼Œè¿˜ä¸å¦‚å¤šå†™å‡ ç¯‡æ–‡ç« ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ„å»ºé™æ€é¡µé¢ã€‚ç«™ç‚¹é…ç½®æˆæˆ‘ä»¬ç†æƒ³çš„æ•ˆæœä¹‹åå°±å¯ä»¥æ„å»ºé™æ€é¡µé¢äº†ï¼š&lt;/p>
&lt;pre>&lt;code>hugo -D
&lt;/code>&lt;/pre>&lt;p>æ·»åŠ  &lt;code>-D&lt;/code> é€‰é¡¹å¯ä»¥åœ¨ç»“æœä¸­åŒ…æ‹¬è‰ç¨¿å†…å®¹ï¼Œé»˜è®¤æƒ…å†µä¸‹é™æ€é¡µé¢ä¼šè¾“å‡ºåˆ°æ ¹ç›®å½•ä¸‹çš„ &lt;code>public&lt;/code> æ–‡ä»¶å¤¹ä¸­ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="é€šè¿‡-github-pages-å‘å¸ƒ">é€šè¿‡ GitHub Pages å‘å¸ƒ&lt;/h2>
&lt;p>è¿™ä¸€æ­¥ Hugo çš„å®˜æ–¹æ–‡æ¡£åŒæ ·åœ¨ &lt;a href="https://gohugo.io/hosting-and-deployment/hosting-on-github/">Host on GitHub&lt;/a> ä¸­è¿›è¡Œäº†è¯¦ç»†çš„ä»‹ç»ï¼Œå¹¶ä¸”è¿˜å¾ˆè´´å¿ƒçš„æä¾›äº†è‡ªåŠ¨åŒ–æ“ä½œçš„ Shell è„šæœ¬ã€‚&lt;/p>
&lt;p>æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>é€šè¿‡ä¸ªäººä¸»é¡µå‘å¸ƒï¼šå¿…é¡»åˆ›å»ºä¸€ä¸ª &lt;code>&amp;lt;USERNAME&amp;gt;.github.io&lt;/code> ä»“åº“æ¥æ‰˜ç®¡ç”Ÿæˆçš„é™æ€å†…å®¹ï¼Œå‘å¸ƒåçš„åŸŸåä¸º &lt;code>https://&amp;lt;USERNAME&amp;gt;.github.io&lt;/code>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡é¡¹ç›®ä¸»é¡µå‘å¸ƒï¼šå¯ä»¥éšæ„åˆ›å»º &lt;code>&amp;lt;PROJECT_NAME&amp;gt;&lt;/code> ä»“åº“ï¼Œå‘å¸ƒåçš„åŸŸåä¸º &lt;code>https://&amp;lt;USERNAME&amp;gt;.github.io/&amp;lt;PROJECT_NAME&amp;gt;&lt;/code>ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>è§†é€‰æ‹©çš„å‘å¸ƒæ–¹å¼ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦å°† &lt;code>config.yml&lt;/code> ä¸­çš„ &lt;code>baseUrl&lt;/code> è®¾ç½®ä¸ºä¸åŒçš„å€¼ã€‚&lt;/p>
&lt;h3 id="é€šè¿‡ä¸ªäººä¸»é¡µå‘å¸ƒ">é€šè¿‡ä¸ªäººä¸»é¡µå‘å¸ƒ&lt;/h3>
&lt;p>å»ºè®®éç‰¹æ®Šæƒ…å†µä¸‹ä½¿ç”¨ç¬¬ 1 ç§æ–¹å¼ï¼ŒåŸå› æ˜¯è®¸å¤šä¸»é¢˜éƒ½ä¸èƒ½å¾ˆå¥½çš„æ”¯æŒç¬¬ 2 ç§ï¼Œå…·ä½“æ¥è¯´æ˜¯å°† &lt;code>config.toml&lt;/code> çš„ &lt;code>baseURL&lt;/code> è®¾ç½®ä¸ºå«å­è·¯å¾„çš„åœ°å€æ—¶ï¼Œä¸èƒ½æ­£ç¡®çš„å¤„ç†æ‰€æœ‰èµ„æºçš„æ„å»ºä½ç½®ã€‚æˆ‘å°è¯•äº† 3 ä¸ªä¸»é¢˜ï¼Œå‡é­é‡äº†ä¸åŒçš„é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>eureka&lt;/code>: æ„å»ºå¤±è´¥ï¼Œæç¤º :&lt;/p>
&lt;pre>&lt;code>Error: Error building site: POSTCSS: failed to transform &amp;quot;css/eureka.css&amp;quot; (text/css): resource &amp;quot;css/waynerv.github.io/css/eureka.css_fc3f76d7bee2760c3a903059afc3d9b2&amp;quot; not found in file cache
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>&lt;code>LoveIt&lt;/code>: æ„å»ºæˆåŠŸï¼Œä½†é™¤ä¸»é¡µä»¥å¤–çš„æ–‡ç« ã€åˆ†ç±»å’Œæ ‡ç­¾çš„é¡µé¢å‡æç¤º 404ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>MemE&lt;/code>: æ„å»ºæˆåŠŸï¼Œä½†æ–‡ç« ä¸­æ’å…¥çš„å›¾ç‰‡åŠ è½½ 404ï¼ˆæ”¾åœ¨åŒä¸€æ–‡ä»¶å¤¹çš„&lt;code>favicon&lt;/code> å´èƒ½æ­£å¸¸å±•ç¤ºï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>è¿™ä¸ªé—®é¢˜æˆ‘åœ¨ &lt;code>eureka&lt;/code> é¡¹ç›®æäº¤äº† issueï¼Œå¼€å‘è€…å›å¤å¯èƒ½æ˜¯ Hugo æœ¬èº«çš„æœºåˆ¶æ‰€å¯¼è‡´ï¼Œå¹¶å·²ç»åœ¨ Hugo è®ºå›ä¸­æå‡ºäº†æ­¤&lt;a href="https://discourse.gohugo.io/t/cached-resources-not-found-in-file-cache-when-baseurl-contains-subdirectory/30182/8">é—®é¢˜&lt;/a>ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å…³æ³¨åç»­è¿›å±•ã€‚&lt;/p>
&lt;h3 id="å‘å¸ƒæ­¥éª¤">å‘å¸ƒæ­¥éª¤&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>åœ¨ GitHub åˆ›å»ºä¸ªäººä¸»é¡µä»“åº“ï¼Œä»“åº“åç§°å¿…é¡»è®¾ç½®ä¸º &lt;code>&amp;lt;USERNAME&amp;gt;.github.io&lt;/code>ï¼Œè¿™ä¸ªä»“åº“ä»…å­˜æ”¾ç”Ÿæˆçš„é™æ€å†…å®¹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨ GitHub åˆ›å»ºä¸€ä¸ªé¡¹ç›®ä»“åº“ &lt;code>hugo-blog&lt;/code> å¹¶æ·»åŠ ä¸ºæˆ‘ä»¬æœ¬åœ°é¡¹ç›®æ–‡ä»¶å¤¹çš„è¿œç¨‹ä»“åº“ã€‚è¿™ä¸ªä»“åº“ç”¨æ¥ç»´æŠ¤ç«™ç‚¹é…ç½®å’ŒåŸå§‹çš„æ–‡ç« å†…å®¹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å‡è®¾æˆ‘ä»¬åœ¨å·²ç»é€šè¿‡ä¸Šæ–‡çš„æ­¥éª¤åœ¨ &lt;code>public&lt;/code> æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆäº†æƒ³å‘å¸ƒçš„é™æ€å†…å®¹ï¼Œè¿è¡Œï¼š&lt;/p>
&lt;pre>&lt;code>git submodule add -b main https://github.com/&amp;lt;USERNAME&amp;gt;/&amp;lt;USERNAME&amp;gt;.github.io.git public
&lt;/code>&lt;/pre>&lt;p>åœ¨ &lt;code>public&lt;/code> ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª git å­æ¨¡å—ï¼Œä¹‹åè¿™ä¸ªç›®å½•å°†ä»¥ &lt;code>https://github.com/&amp;lt;USERNAME&amp;gt;/&amp;lt;USERNAME&amp;gt;.github.io&lt;/code> ä½œä¸ºè¿œç¨‹ä»“åº“ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„ &lt;code>baseUrl&lt;/code> å·²ç»è®¾ç½®ä¸ºäº† &lt;code>&amp;lt;USERNAME&amp;gt;.github.io&lt;/code>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Hugo ä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥çš„éƒ¨ç½²æ“ä½œæä¾›äº†ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„ Shell è„šæœ¬ï¼š&lt;/p>
&lt;/li>
&lt;/ol>
&lt;pre>&lt;code>#!/bin/sh
# ä»»ä¸€æ­¥éª¤æ‰§è¡Œå¤±è´¥éƒ½ä¼šç»ˆæ­¢æ•´ä¸ªéƒ¨ç½²è¿‡ç¨‹
set -e
printf &amp;quot;\033[0;32mDeploying updates to GitHub...\033[0m\n&amp;quot;
# æ„å»ºé™æ€å†…å®¹
hugo # if using a theme, replace with `hugo -t &amp;lt;YOURTHEME&amp;gt;`
# åˆ‡æ¢åˆ° Public æ–‡ä»¶å¤¹
cd public
# æ·»åŠ æ›´æ”¹åˆ° git
git add .
# æäº¤æ›´æ”¹
msg=&amp;quot;rebuilding site $(date)&amp;quot;
if [ -n &amp;quot;$*&amp;quot; ]; then
msg=&amp;quot;$*&amp;quot;
fi
git commit -m &amp;quot;$msg&amp;quot;
# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin main
&lt;/code>&lt;/pre>&lt;p>å°†å¦‚ä¸Šå†…å®¹ä¿å­˜åˆ° &lt;code>deploy.sh&lt;/code> æ–‡ä»¶ä¸­ï¼Œå¹¶æ‰§è¡Œ &lt;code>chmod +x deploy.sh&lt;/code> ä¸ºå…¶æ·»åŠ å¯æ‰§è¡Œæƒé™ã€‚æ¥ç€æ‰§è¡Œéƒ¨ç½²è„šæœ¬ï¼š&lt;/p>
&lt;pre>&lt;code>./deploy.sh
&lt;/code>&lt;/pre>&lt;p>å¤§åŠŸå‘Šæˆï¼ç¨ç­‰å‡ åˆ†é’Ÿå°±å¯ä»¥åœ¨ &lt;code>https://&amp;lt;USERNAME&amp;gt;.github.io&lt;/code> çœ‹åˆ°æˆ‘ä»¬çš„ä¸ªäººåšå®¢äº†ã€‚&lt;/p>
&lt;h3 id="é€šè¿‡-github-actions-è‡ªåŠ¨éƒ¨ç½²">é€šè¿‡ GitHub Actions è‡ªåŠ¨éƒ¨ç½²&lt;/h3>
&lt;p>ç›®å‰æˆ‘ä»¬çš„ã€Œåˆ›ä½œ-å‘å¸ƒã€æµç¨‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>åœ¨é¡¹ç›®ä»“åº“ç¼–è¾‘åŸå§‹å†…å®¹å¹¶è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ‰§è¡Œè‡ªåŠ¨è„šæœ¬ç”Ÿæˆé™æ€ç«™ç‚¹å¹¶æ¨é€åˆ°ä¸ªäººä¸»é¡µä»“åº“å®Œæˆå‘å¸ƒã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>è¿™å¥—æµç¨‹å·²ç»å¾ˆæµç•…ï¼Œä½†è¿˜æœ‰ä¸€äº›æ”¹è¿›ç©ºé—´ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;a href="https://github.com/features/actions">GitHub Actions&lt;/a>ï¼Œåœ¨æ¯æ¬¡å‘è¿œç¨‹çš„é¡¹ç›®ä»“åº“æ¨é€åŸå§‹å†…å®¹æ›´æ”¹æ—¶è‡ªåŠ¨æ‰§è¡Œç¬¬ 2 æ­¥è¿›è¡Œå‘å¸ƒã€‚&lt;/p>
&lt;p>GitHub ä¸Šæœ‰è®¸å¤šè¿™ç±»è‡ªåŠ¨åŒ–éƒ¨ç½²ä»»åŠ¡çš„å¼€æº Actions é¡¹ç›®ï¼Œæˆ‘ä»¬é€‰æ‹©äº†å…¶ä¸­ä¸€ä¸ªç®€å•æ˜“ç”¨çš„ &lt;a href="https://github.com/peaceiris/actions-hugo#getting-started">GitHub Actions for Hugo&lt;/a>ã€‚å…·ä½“çš„æ“ä½œæ­¥éª¤æˆªå›¾å’Œè¯¦ç»†é…ç½®é¡¹å¯ä»¥æŸ¥çœ‹è¯¥é¡¹ç›®çš„ &lt;a href="https://github.com/peaceiris/actions-hugo#github-actions-for-hugo">README&lt;/a>ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸‹é…ç½®è¿‡ç¨‹ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­æ·»åŠ ç›®å½•å’Œæ–‡ä»¶ï¼š&lt;code>.github/workflows/gh-pages.yml&lt;/code>ï¼Œ&lt;code>gh-pages.yml&lt;/code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre>&lt;code>name: github pages
on:
push:
branches:
- main # æ¯æ¬¡æ¨é€åˆ° main åˆ†æ”¯éƒ½ä¼šè§¦å‘éƒ¨ç½²ä»»åŠ¡
jobs:
deploy:
runs-on: ubuntu-18.04
steps:
- uses: actions/checkout@v2
with:
submodules: true # Fetch Hugo themes (true OR recursive)
fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod
- name: Setup Hugo
uses: peaceiris/actions-hugo@v2
with:
hugo-version: '0.79.1'
extended: true
- name: Build
run: hugo --minify
- name: Deploy
uses: peaceiris/actions-gh-pages@v3
with:
deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }}
external_repository: &amp;lt;USERNAME&amp;gt;/&amp;lt;USERNAME&amp;gt;.github.io # æ›¿æ¢æˆä¸Šæ–‡æ‰€åˆ›å»ºçš„ä¸ªäººä¸»é¡µä»“åº“
publish_branch: main
publish_dir: ./public
&lt;/code>&lt;/pre>&lt;p>è¿™ä¸ªæ–‡ä»¶æ‰€å®šä¹‰çš„ &lt;code>workflow&lt;/code> åŸºäºé¡¹ç›®ä»“åº“è¿è¡Œï¼Œä½†æˆ‘ä»¬éœ€è¦å°†è¿è¡Œè¿‡ç¨‹ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ°ä¸ªäººä¸»é¡µä»“åº“ &lt;code>&amp;lt;USERNAME&amp;gt;.github.io&lt;/code> å®Œæˆå‘å¸ƒï¼Œå› æ­¤åœ¨ &lt;code>Deploy&lt;/code> ä»»åŠ¡ä¸­æŒ‰ç…§æ–‡æ¡£çš„ &lt;a href="https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-deploy-to-external-repository-external_repository">Deploy to external repository &lt;code>external_repository&lt;/code>&lt;/a> ä¸€èŠ‚åšäº†ä¸“é—¨çš„é…ç½®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨æœ¬åœ°ç”Ÿæˆ SSH éƒ¨ç½²å¯†é’¥ï¼š&lt;/p>
&lt;pre>&lt;code>ssh-keygen -t rsa -b 4096 -C &amp;quot;$(git config user.email)&amp;quot; -f gh-pages -N &amp;quot;&amp;quot;
# å°†åœ¨å½“å‰ç›®å½•ç”Ÿæˆå¦‚ä¸‹å¯†é’¥æ–‡ä»¶:
# gh-pages.pub (å…¬é’¥)
# gh-pages (ç§é’¥)
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>åœ¨ GitHub åˆ†åˆ«è¿›å…¥é¡¹ç›®ä»“åº“å’Œä¸ªäººä¸»é¡µä»“åº“çš„ &lt;code>Settings&lt;/code> é¡µé¢ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å°†å…¬é’¥ &lt;code>gh-pages.pub&lt;/code> ä½œä¸º &lt;code>Secret&lt;/code> æ·»åŠ åˆ°é¡¹ç›®ä»“åº“ï¼Œå¹¶è®¾ç½® &lt;code>Name&lt;/code> ä¸º &lt;code>ACTIONS_DEPLOY_KEY&lt;/code>ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°†ç§é’¥ &lt;code>gh-pages&lt;/code> ä½œä¸º &lt;code>Deploy Key&lt;/code> æ·»åŠ åˆ°ä¸ªäººä¸»é¡µä»“åº“ï¼Œå¹¶è®¾ç½®ä¸º &lt;code>Allow write access&lt;/code>ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æ•ˆæœã€‚&lt;/p>
&lt;p>åœ¨æœ¬åœ°åšä¸€äº›æ›´æ”¹ï¼Œé¢„è§ˆæ•ˆæœåæäº¤å¹¶æ¨é€ï¼Œç„¶ååœ¨é¡¹ç›®ä»“åº“çš„ GitHub Actions é¡µé¢æ£€æŸ¥ç›¸åº”çš„ &lt;code>workflow&lt;/code> æ˜¯å¦è¿è¡ŒæˆåŠŸã€‚ä¸å‡ºæ„å¤–çš„è¯ï¼Œå¾ˆå¿«ä¸ªäººä¸»é¡µä»“åº“å°†æ–°å¢ä¸€ä¸ªç”±è¯¥ &lt;code>workflow&lt;/code> åˆ›å»ºçš„æäº¤ï¼Œè®¿é—®ä¸ªäººåšå®¢é¡µé¢ä¹Ÿä¼šå‘ç°é¡µé¢å·²ç»æ›´æ–°ã€‚&lt;/p>
&lt;h2 id="ä¸ªäººä½“éªŒ">ä¸ªäººä½“éªŒ&lt;/h2>
&lt;p>ç”±äºå…ˆåé€‰æ‹©çš„ 3 ä¸ªä¸»é¢˜å‡é­é‡äº†ä¸Šè¿°å‘å¸ƒåœ°å€ä¸èƒ½åŒ…å«å­è·¯å¾„çš„é—®é¢˜ï¼Œæˆ‘åœ¨åŸºæœ¬æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æ“ä½œçš„å‰æä¸‹ï¼Œä¾ç„¶èŠ±äº†è¶…è¿‡ 10 ä¸ªå°æ—¶æ‰æŠŠ&lt;a href="https://waynerv.github.io/">åšå®¢&lt;/a>ä¸Šçº¿ï¼Œæµªè´¹äº†å¾ˆå¤šæ—¶é—´åœ¨é…ç½®ä¸»é¢˜ä»¥åŠå¯»æ‰¾é—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¸Šã€‚æœ¬ä»¥ä¸ºé€‰æ‹©äº†ä¸€ä¸ªç®€å•å¿«æ·çš„çœå¿ƒæ–¹æ¡ˆï¼Œç»“æœè¿˜æ˜¯å…ä¸äº†è¿‡ç¨‹çš„ä¸€é¡¿è¸©å‘å’ŒæŠ˜è…¾ã€‚&lt;/p>
&lt;p>è™½ç„¶æ­å»ºåšå®¢çš„æµç¨‹ä¸ç®—çœå¿ƒï¼Œä½†æˆ‘æ‰€é‡åˆ°çš„è¿™äº›é—®é¢˜ä¹Ÿç®—æ˜¯ä¸ªä¾‹ã€‚ä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œæˆ‘ä»¬å¯ä»¥åƒå†™ä»£ç ä¸€æ ·å†™åšå®¢ï¼Œå¯¹æ–‡ç« ä¿®æ”¹æäº¤å³è‡ªåŠ¨å‘å¸ƒï¼Œä¹Ÿä¸éœ€è¦è€ƒè™‘åšå®¢çš„æ ·å¼ã€åå°åŠŸèƒ½åŠä¸»æœºç»´æŠ¤ç­‰é—®é¢˜ï¼Œå¯¹æå‡å†™ä½œæ•ˆç‡ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œå¯ä»¥çœä¸‹æ¥å¾ˆå¤šçš„æ—¶é—´å’Œç²¾åŠ›ï¼Œç»¼åˆæ¥çœ‹ä½“éªŒè¿˜æ˜¯ä¸é”™çš„ã€‚&lt;/p></description><category domain="https://www.waynerv.com/categories/%E4%B8%AA%E4%BA%BA/">ä¸ªäºº</category><category domain="https://www.waynerv.com/tags/%E5%8D%9A%E5%AE%A2/">åšå®¢</category></item><item><title>Git Rebase æ“ä½œæµ…æ</title><link>https://www.waynerv.com/posts/git-rebase-intro/</link><guid isPermaLink="true">https://www.waynerv.com/posts/git-rebase-intro/</guid><pubDate>Wed, 23 Dec 2020 23:45:24 +0800</pubDate><author>ampedee@gmail.com (Waynerv)</author><copyright>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</copyright><description>&lt;p>ä¹‹æ‰€ä»¥å†™è¿™ç¯‡æ–‡ç« ï¼Œæ˜¯å› ä¸ºä¹‹å‰å¯¹ &lt;code>git rebase -i&lt;/code> çš„ç”¨æ³•ä¸€ç›´æ˜¯ä¸€çŸ¥åŠè§£ï¼Œä¸€æ¬¡åœ¨éœ€è¦åˆå¹¶å¤šä¸ªæäº¤æ—¶åˆšå¥½ç”¨åˆ°ï¼Œä¸€é¡¿æ“ä½œå·®ç‚¹æŠŠæäº¤éƒ½æä¸¢äº†ï¼Œå¹¸å¥½åé¢é¡ºåˆ©æ‰¾å›ï¼Œå› æ­¤è®°å½•ä¸€ä¸‹å­¦ä¹  &lt;code>rebase&lt;/code> å‘½ä»¤çš„è¿‡ç¨‹ã€‚&lt;/p>
&lt;h2 id="ç†è§£-rebase-å‘½ä»¤">ç†è§£ Rebase å‘½ä»¤&lt;/h2>
&lt;p>&lt;code>git rebase&lt;/code> å‘½ä»¤çš„æ–‡æ¡£æè¿°æ˜¯ &lt;code>Reapply commits on top of another base tip&lt;/code>ï¼Œä»å­—é¢ä¸Šç†è§£æ˜¯ã€Œåœ¨å¦ä¸€ä¸ªåŸºç«¯ä¹‹ä¸Šé‡æ–°åº”ç”¨æäº¤ã€ï¼Œè¿™ä¸ªå®šä¹‰å¬èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œæ¢ä¸ªè§’åº¦å¯ä»¥ç†è§£ä¸ºã€Œå°†åˆ†æ”¯çš„åŸºç¡€ä»ä¸€ä¸ªæäº¤æ”¹æˆå¦ä¸€ä¸ªæäº¤ï¼Œä½¿å…¶çœ‹èµ·æ¥å°±åƒæ˜¯ä»å¦ä¸€ä¸ªæäº¤ä¸­åˆ›å»ºäº†åˆ†æ”¯ä¸€æ ·ã€ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/git-rebase-visual.png" alt="git-rebase.png">&lt;/p>
&lt;p>å‡è®¾æˆ‘ä»¬ä» &lt;code>Master&lt;/code> çš„æäº¤ A åˆ›å»ºäº† &lt;code>Feature&lt;/code> åˆ†æ”¯è¿›è¡Œæ–°çš„åŠŸèƒ½å¼€å‘ï¼Œè¿™æ—¶ A å°±æ˜¯ &lt;code>Feature&lt;/code> çš„åŸºç«¯ã€‚æ¥ç€ &lt;code>Matser&lt;/code> æ–°å¢äº†ä¸¤ä¸ªæäº¤ B å’Œ Cï¼Œ &lt;code>Feature&lt;/code> æ–°å¢äº†ä¸¤ä¸ªæäº¤ D å’Œ Eã€‚ç°åœ¨æˆ‘ä»¬å‡ºäºæŸç§åŸå› ï¼Œæ¯”å¦‚æ–°åŠŸèƒ½çš„å¼€å‘ä¾èµ– Bã€C æäº¤ï¼Œéœ€è¦å°† &lt;code>Master&lt;/code> çš„ä¸¤ä¸ªæ–°æäº¤æ•´åˆåˆ° &lt;code>Feature&lt;/code> åˆ†æ”¯ï¼Œä¸ºäº†ä¿æŒæäº¤å†å²çš„æ•´æ´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ° &lt;code>Feature&lt;/code> åˆ†æ”¯æ‰§è¡Œ &lt;code>rebase&lt;/code> æ“ä½œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git rebase master
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>rebase&lt;/code> çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯é¦–å…ˆæ‰¾åˆ°è¿™ä¸¤ä¸ªåˆ†æ”¯ï¼ˆå³å½“å‰åˆ†æ”¯ &lt;code>Feature&lt;/code>ã€ &lt;code>rebase&lt;/code> æ“ä½œçš„ç›®æ ‡åŸºåº•åˆ†æ”¯ &lt;code>Master&lt;/code>ï¼‰ çš„æœ€è¿‘å…±åŒç¥–å…ˆæäº¤ Aï¼Œç„¶åå¯¹æ¯”å½“å‰åˆ†æ”¯ç›¸å¯¹äºè¯¥ç¥–å…ˆæäº¤çš„å†æ¬¡æäº¤ï¼ˆD å’Œ Eï¼‰ï¼Œæå–ç›¸åº”çš„ä¿®æ”¹å¹¶å­˜ä¸ºä¸´æ—¶æ–‡ä»¶ï¼Œç„¶åå°†å½“å‰åˆ†æ”¯æŒ‡å‘ç›®æ ‡åŸºåº• &lt;code>Master&lt;/code> æ‰€æŒ‡å‘çš„æäº¤ C, æœ€åä»¥æ­¤ä½œä¸ºæ–°çš„åŸºç«¯å°†ä¹‹å‰å¦å­˜ä¸ºä¸´æ—¶æ–‡ä»¶çš„ä¿®æ”¹ä¾åºåº”ç”¨ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰ä¸Šæ–‡ç†è§£æˆå°† &lt;code>Feature&lt;/code> åˆ†æ”¯çš„åŸºç¡€ä»æäº¤ A æ”¹æˆäº†æäº¤ Cï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯ä»æäº¤ C åˆ›å»ºäº†è¯¥åˆ†æ”¯ï¼Œå¹¶æäº¤äº† D å’Œ Eã€‚ä½†å®é™…ä¸Šè¿™åªæ˜¯ã€Œçœ‹èµ·æ¥ã€ï¼Œåœ¨å†…éƒ¨ Git å¤åˆ¶äº†æäº¤ D å’Œ E çš„å†…å®¹ï¼Œåˆ›å»ºæ–°çš„æäº¤ D' å’Œ E' å¹¶å°†å…¶åº”ç”¨åˆ°ç‰¹å®šåŸºç¡€ä¸Šï¼ˆAâ†’Bâ†’Cï¼‰ã€‚å°½ç®¡æ–°çš„ &lt;code>Feature&lt;/code> åˆ†æ”¯å’Œä¹‹å‰çœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œä½†å®ƒæ˜¯ç”±å…¨æ–°çš„æäº¤ç»„æˆçš„ã€‚&lt;/p>
&lt;p>&lt;code>rebase&lt;/code> æ“ä½œçš„å®è´¨æ˜¯ä¸¢å¼ƒä¸€äº›ç°æœ‰çš„æäº¤ï¼Œç„¶åç›¸åº”åœ°æ–°å»ºä¸€äº›å†…å®¹ä¸€æ ·ä½†å®é™…ä¸Šä¸åŒçš„æäº¤ã€‚&lt;/p>
&lt;h2 id="ä¸»è¦ç”¨é€”">ä¸»è¦ç”¨é€”&lt;/h2>
&lt;p>&lt;code>rebase&lt;/code> é€šå¸¸ç”¨äºé‡å†™æäº¤å†å²ã€‚ä¸‹é¢çš„ä½¿ç”¨åœºæ™¯åœ¨å¤§å¤šæ•° Git å·¥ä½œæµä¸­æ˜¯ååˆ†å¸¸è§çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>æˆ‘ä»¬ä» &lt;code>master&lt;/code> åˆ†æ”¯æ‹‰å–äº†ä¸€æ¡ &lt;code>feature&lt;/code> åˆ†æ”¯åœ¨æœ¬åœ°è¿›è¡ŒåŠŸèƒ½å¼€å‘&lt;/li>
&lt;li>è¿œç¨‹çš„ &lt;code>master&lt;/code> åˆ†æ”¯åœ¨ä¹‹ååˆåˆå¹¶äº†ä¸€äº›æ–°çš„æäº¤&lt;/li>
&lt;li>æˆ‘ä»¬æƒ³åœ¨ &lt;code>feature&lt;/code> åˆ†æ”¯é›†æˆ &lt;code>master&lt;/code> çš„æœ€æ–°æ›´æ”¹&lt;/li>
&lt;/ul>
&lt;h3 id="å’Œ-merge-çš„åŒºåˆ«">å’Œ &lt;code>merge&lt;/code> çš„åŒºåˆ«&lt;/h3>
&lt;p>ä»¥ä¸Šåœºæ™¯åŒæ ·å¯ä»¥ä½¿ç”¨ &lt;code>merge&lt;/code> æ¥è¾¾æˆç›®çš„ï¼Œä½†ä½¿ç”¨ &lt;code>rebase&lt;/code> å¯ä»¥ä½¿æˆ‘ä»¬ä¿æŒä¸€ä¸ªçº¿æ€§ä¸”æ›´åŠ æ•´æ´çš„æäº¤å†å²ã€‚å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹åˆ†æ”¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash"> D---E feature
/
A---B---C master
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç°åœ¨æˆ‘ä»¬å°†åˆ†åˆ«ä½¿ç”¨ &lt;code>merge&lt;/code> å’Œ &lt;code>rebase&lt;/code>ï¼ŒæŠŠ &lt;code>master&lt;/code> åˆ†æ”¯çš„ Bã€C æäº¤é›†æˆåˆ° &lt;code>feature&lt;/code> åˆ†æ”¯ï¼Œå¹¶åœ¨ &lt;code>feature&lt;/code> åˆ†æ”¯æ–°å¢ä¸€ä¸ªæäº¤ Fï¼Œç„¶åå†å°† &lt;code>feature&lt;/code> åˆ†æ”¯åˆå…¥ &lt;code>master&lt;/code> ï¼Œæœ€åå¯¹æ¯”ä¸¤ç§æ–¹æ³•æ‰€å½¢æˆçš„æäº¤å†å²çš„åŒºåˆ«ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ä½¿ç”¨ &lt;code>merge&lt;/code>&lt;/p>
&lt;ol>
&lt;li>åˆ‡æ¢åˆ° &lt;code>feature&lt;/code> åˆ†æ”¯ï¼š &lt;code>git checkout feature&lt;/code>ã€‚&lt;/li>
&lt;li>åˆå¹¶ &lt;code>master&lt;/code> åˆ†æ”¯çš„æ›´æ–°ï¼š &lt;code>git merge master&lt;/code>ã€‚&lt;/li>
&lt;li>æ–°å¢ä¸€ä¸ªæäº¤ Fï¼š &lt;code>git add . &amp;amp;&amp;amp; git commit -m &amp;quot;commit F&amp;quot;&lt;/code> ã€‚&lt;/li>
&lt;li>åˆ‡å› &lt;code>master&lt;/code> åˆ†æ”¯å¹¶æ‰§è¡Œå¿«è¿›åˆå¹¶ï¼š &lt;code>git chekcout master &amp;amp;&amp;amp; git merge feature&lt;/code>ã€‚&lt;/li>
&lt;/ol>
&lt;p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Dec-30-2020-merge-example.gif" alt="Dec-30-2020-merge-example">&lt;/p>
&lt;p>æˆ‘ä»¬å°†å¾—åˆ°å¦‚ä¸‹æäº¤å†å²ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">* 6fa5484 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master, feature&lt;span class="o">)&lt;/span> commit F
* 875906b Merge branch &lt;span class="s1">&amp;#39;master&amp;#39;&lt;/span> into feature
&lt;span class="p">|&lt;/span>&lt;span class="se">\ &lt;/span>
&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> 5b05585 commit E
&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> f5b0fc0 commit D
* * d017dff commit C
* * 9df916f commit B
&lt;span class="p">|&lt;/span>/
* cb932a6 commit A
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ä½¿ç”¨ &lt;code>rebase&lt;/code>&lt;/p>
&lt;p>æ­¥éª¤ä¸ä½¿ç”¨ &lt;code>merge&lt;/code> åŸºæœ¬ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ç¬¬ 2 æ­¥çš„å‘½ä»¤æ›¿æ¢æˆï¼š &lt;code>git rebase master&lt;/code>ã€‚&lt;/p>
&lt;p>æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;p>&lt;img src="https://www.waynerv.com/images/Dec-30-2020-rebase-example.gif" alt="Dec-30-2020-rebase-example">&lt;/p>
&lt;p>æˆ‘ä»¬å°†å¾—åˆ°å¦‚ä¸‹æäº¤å†å²ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">* 74199ce &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master, feature&lt;span class="o">)&lt;/span> commit F
* e7c7111 commit E
* d9623b0 commit D
* 73deeed commit C
* c50221f commit B
* ef13725 commit A
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ &lt;code>rebase&lt;/code> æ–¹æ³•å½¢æˆçš„æäº¤å†å²æ˜¯å®Œå…¨çº¿æ€§çš„ï¼ŒåŒæ—¶ç›¸æ¯” &lt;code>merge&lt;/code> æ–¹æ³•å°‘äº†ä¸€æ¬¡ &lt;code>merge&lt;/code> æäº¤ï¼Œçœ‹ä¸Šå»æ›´åŠ æ•´æ´ã€‚&lt;/p>
&lt;h3 id="ä¸ºä»€ä¹ˆè¦ä¿æŒæäº¤å†å²çš„æ•´æ´">ä¸ºä»€ä¹ˆè¦ä¿æŒæäº¤å†å²çš„æ•´æ´&lt;/h3>
&lt;p>ä¸€ä¸ªçœ‹ä¸Šæ›´æ•´æ´çš„æäº¤å†å²æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ&lt;/p>
&lt;ol>
&lt;li>æ»¡è¶³æŸäº›å¼€å‘è€…çš„æ´ç™–ã€‚&lt;/li>
&lt;li>å½“ä½ å› ä¸ºæŸäº› bug éœ€è¦å›æº¯æäº¤å†å²æ—¶ï¼Œæ›´å®¹æ˜“å®šä½åˆ° bug æ˜¯ä»å“ªä¸€ä¸ªæäº¤å¼•å…¥ã€‚å°¤å…¶æ˜¯å½“ä½ éœ€è¦é€šè¿‡ &lt;code>git bisect&lt;/code> ä»å‡ åä¸Šç™¾ä¸ªæäº¤ä¸­æ’æŸ¥ bugï¼Œæˆ–è€…æœ‰ä¸€äº›ä½“é‡è¾ƒå¤§çš„åŠŸèƒ½åˆ†æ”¯éœ€è¦é¢‘ç¹çš„ä»è¿œç¨‹çš„ä¸»åˆ†æ”¯æ‹‰å–æ›´æ–°æ—¶ã€‚&lt;/li>
&lt;/ol>
&lt;p>ä½¿ç”¨ &lt;code>rebase&lt;/code> æ¥å°†è¿œç¨‹çš„å˜æ›´æ•´åˆåˆ°æœ¬åœ°ä»“åº“æ˜¯ä¸€ç§æ›´å¥½çš„é€‰æ‹©ã€‚ç”¨ &lt;code>merge&lt;/code> æ‹‰å–è¿œç¨‹å˜æ›´çš„ç»“æœæ˜¯ï¼Œæ¯æ¬¡ä½ æƒ³è·å–é¡¹ç›®çš„æœ€æ–°è¿›å±•æ—¶ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªå¤šä½™çš„ &lt;code>merge&lt;/code> æäº¤ã€‚è€Œä½¿ç”¨ &lt;code>rebase&lt;/code> çš„ç»“æœæ›´ç¬¦åˆæˆ‘ä»¬çš„æœ¬æ„ï¼šæˆ‘æƒ³åœ¨å…¶ä»–äººçš„å·²å®Œæˆå·¥ä½œçš„åŸºç¡€ä¸Šè¿›è¡Œæˆ‘çš„æ›´æ”¹ã€‚&lt;/p>
&lt;h3 id="å…¶ä»–é‡å†™æäº¤å†å²çš„æ–¹æ³•">å…¶ä»–é‡å†™æäº¤å†å²çš„æ–¹æ³•&lt;/h3>
&lt;p>å½“æˆ‘ä»¬ä»…ä»…åªæƒ³ä¿®æ”¹æœ€è¿‘çš„ä¸€æ¬¡æäº¤æ—¶ï¼Œä½¿ç”¨ &lt;code>git commit --amend&lt;/code> ä¼šæ›´åŠ æ–¹ä¾¿ã€‚&lt;/p>
&lt;p>å®ƒé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>æˆ‘ä»¬åˆšåˆšå®Œæˆäº†ä¸€æ¬¡æäº¤ï¼Œä½†è¿˜æ²¡æœ‰æ¨é€åˆ°å…¬å…±çš„åˆ†æ”¯ã€‚&lt;/li>
&lt;li>çªç„¶å‘ç°ä¸Šä¸ªæäº¤è¿˜ç•™äº†äº›å°å°¾å·´æ²¡æœ‰å®Œæˆï¼Œæ¯”å¦‚ä¸€è¡Œå¿˜è®°åˆ é™¤çš„æ³¨é‡Šæˆ–è€…ä¸€ä¸ªå¾ˆå°çš„ç¬”è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¿«é€Ÿçš„å®Œæˆä¿®æ”¹ï¼Œä½†åˆä¸æƒ³å†æ–°å¢ä¸€ä¸ªå•ç‹¬çš„æäº¤ã€‚&lt;/li>
&lt;li>æˆ–è€…æˆ‘ä»¬åªæ˜¯è§‰å¾—ä¸Šä¸€æ¬¡æäº¤çš„æäº¤ä¿¡æ¯å†™çš„ä¸å¤Ÿå¥½ï¼Œæƒ³åšä¸€äº›ä¿®æ”¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥æ·»åŠ æ–°å¢çš„ä¿®æ”¹ï¼ˆæˆ–è·³è¿‡ï¼‰ï¼Œä½¿ç”¨ &lt;code>git commit --amend&lt;/code> å‘½ä»¤æ‰§è¡Œæäº¤ï¼Œæ‰§è¡Œåä¼šè¿›å…¥ä¸€ä¸ªæ–°çš„ç¼–è¾‘å™¨çª—å£ï¼Œå¯ä»¥å¯¹ä¸Šä¸€æ¬¡æäº¤çš„æäº¤ä¿¡æ¯è¿›è¡Œä¿®æ”¹ï¼Œä¿å­˜åå°±ä¼šå°†æ‰€åšçš„è¿™äº›æ›´æ”¹åº”ç”¨åˆ°ä¸Šä¸€æ¬¡æäº¤ã€‚&lt;/p>
&lt;p>å¦‚æœæˆ‘ä»¬å·²ç»å°†ä¸Šä¸€æ¬¡æäº¤æ¨é€åˆ°äº†è¿œç¨‹çš„åˆ†æ”¯ï¼Œç°åœ¨å†æ‰§è¡Œæ¨é€å°†ä¼šæç¤ºå‡ºé”™å¹¶è¢«æ‹’ç»ï¼Œåœ¨ç¡®ä¿è¯¥åˆ†æ”¯ä¸æ˜¯ä¸€ä¸ªå…¬å…±åˆ†æ”¯çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code>git push --force&lt;/code> å¼ºåˆ¶æ¨é€ã€‚&lt;/p>
&lt;p>æ³¨æ„ä¸ &lt;code>rebase&lt;/code> ä¸€æ ·ï¼ŒGit åœ¨å†…éƒ¨å¹¶ä¸ä¼šçœŸæ­£åœ°ä¿®æ”¹å¹¶æ›¿æ¢ä¸Šä¸€ä¸ªæäº¤ï¼Œè€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„æäº¤å¹¶é‡æ–°æŒ‡å‘è¿™ä¸ªæ–°çš„æäº¤ã€‚&lt;/p>
&lt;h2 id="ä½¿ç”¨-rebase-çš„äº¤äº’æ¨¡å¼é‡å†™æäº¤å†å²">ä½¿ç”¨ &lt;code>rebase&lt;/code> çš„äº¤äº’æ¨¡å¼é‡å†™æäº¤å†å²&lt;/h2>
&lt;p>&lt;code>git rebase&lt;/code> å‘½ä»¤æœ‰æ ‡å‡†å’Œäº¤äº’ä¸¤ç§æ¨¡å¼ï¼Œä¹‹å‰çš„ç¤ºä¾‹æˆ‘ä»¬ç”¨çš„éƒ½æ˜¯é»˜è®¤çš„æ ‡å‡†æ¨¡å¼ï¼Œåœ¨å‘½ä»¤åæ·»åŠ  &lt;code>-i&lt;/code> æˆ– &lt;code>--interactive&lt;/code> é€‰é¡¹å³å¯ä½¿ç”¨äº¤äº’æ¨¡å¼ã€‚&lt;/p>
&lt;h3 id="ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«">ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«&lt;/h3>
&lt;p>æˆ‘ä»¬å‰é¢æåˆ°ï¼Œ &lt;code>rebase&lt;/code> æ˜¯ã€Œåœ¨å¦ä¸€ä¸ªåŸºç«¯ä¹‹ä¸Šé‡æ–°åº”ç”¨æäº¤ã€ï¼Œè€Œåœ¨é‡æ–°åº”ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œè¿™äº›æäº¤ä¼šè¢«é‡æ–°åˆ›å»ºï¼Œè‡ªç„¶ä¹Ÿå¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚åœ¨ &lt;code>rebase&lt;/code> çš„æ ‡å‡†æ¨¡å¼ä¸‹ï¼Œå½“å‰å·¥ä½œåˆ†æ”¯çš„æäº¤ä¼šè¢«ç›´æ¥åº”ç”¨åˆ°ä¼ å…¥åˆ†æ”¯çš„é¡¶ç«¯ï¼›è€Œåœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œåˆ™å…è®¸æˆ‘ä»¬åœ¨é‡æ–°åº”ç”¨ä¹‹å‰é€šè¿‡ç¼–è¾‘å™¨ä»¥åŠç‰¹å®šçš„å‘½ä»¤è§„åˆ™å¯¹è¿™äº›æäº¤è¿›è¡Œåˆå¹¶ã€é‡æ–°æ’åºåŠåˆ é™¤ç­‰é‡å†™æ“ä½œã€‚&lt;/p>
&lt;p>ä¸¤è€…æœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯ä¹Ÿå› æ­¤æœ‰æ‰€ä¸åŒï¼š&lt;/p>
&lt;ol>
&lt;li>æ ‡å‡†æ¨¡å¼å¸¸ç”¨äºåœ¨å½“å‰åˆ†æ”¯ä¸­é›†æˆæ¥è‡ªå…¶ä»–åˆ†æ”¯çš„æœ€æ–°ä¿®æ”¹ã€‚&lt;/li>
&lt;li>äº¤äº’æ¨¡å¼å¸¸ç”¨äºå¯¹å½“å‰åˆ†æ”¯çš„æäº¤å†å²è¿›è¡Œç¼–è¾‘ï¼Œå¦‚å°†å¤šä¸ªå°æäº¤åˆå¹¶æˆå¤§çš„æäº¤ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="ä¸ä»…ä»…æ˜¯åˆ†æ”¯">ä¸ä»…ä»…æ˜¯åˆ†æ”¯&lt;/h3>
&lt;p>è™½ç„¶æˆ‘ä»¬ä¹‹å‰çš„ç¤ºä¾‹éƒ½æ˜¯åœ¨ä¸åŒçš„ä¸¤ä¸ªåˆ†æ”¯ä¹‹é—´æ‰§è¡Œ rebase æ“ä½œï¼Œä½†äº‹å®ä¸Š rebase å‘½ä»¤ä¼ å…¥çš„å‚æ•°å¹¶ä¸ä»…é™äºåˆ†æ”¯ã€‚&lt;/p>
&lt;p>ä»»ä½•çš„æäº¤å¼•ç”¨ï¼Œéƒ½å¯ä»¥è¢«è§†ä½œæœ‰æ•ˆçš„ &lt;code>rebase&lt;/code> åŸºåº•å¯¹è±¡ï¼ŒåŒ…æ‹¬ä¸€ä¸ªæäº¤ IDã€åˆ†æ”¯åç§°ã€æ ‡ç­¾åç§°æˆ– &lt;code>HEAD~1&lt;/code> è¿™æ ·çš„ç›¸å¯¹å¼•ç”¨ã€‚&lt;/p>
&lt;p>è‡ªç„¶åœ°ï¼Œå‡å¦‚æˆ‘ä»¬å¯¹å½“å‰åˆ†æ”¯çš„æŸæ¬¡å†å²æäº¤æ‰§è¡Œ &lt;code>rebase&lt;/code>ï¼Œå…¶ç»“æœå°±æ˜¯ä¼šå°†è¿™æ¬¡æäº¤ä¹‹åçš„æ‰€æœ‰æäº¤é‡æ–°åº”ç”¨åœ¨å½“å‰åˆ†æ”¯ï¼Œåœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œå³å…è®¸æˆ‘ä»¬å¯¹è¿™äº›æäº¤è¿›è¡Œæ›´æ”¹ã€‚&lt;/p>
&lt;h3 id="é‡å†™æäº¤å†å²">é‡å†™æäº¤å†å²&lt;/h3>
&lt;p>ç»ˆäºè¿›å…¥åˆ°æœ¬æ–‡çš„ä¸»é¢˜ï¼Œå‰é¢æåˆ°ï¼Œå‡å¦‚æˆ‘ä»¬åœ¨äº¤äº’æ¨¡å¼å¯¹å½“å‰åˆ†æ”¯çš„æŸæ¬¡æäº¤æ‰§è¡Œ &lt;code>rebase&lt;/code>ï¼Œå³ï¼ˆé—´æ¥ï¼‰å®ç°äº†å¯¹è¿™æ¬¡æäº¤ä¹‹åçš„æ‰€æœ‰æäº¤è¿›è¡Œé‡å†™ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†é€šè¿‡ä¸‹é¢çš„ç¤ºä¾‹è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚&lt;/p>
&lt;p>å‡è®¾æˆ‘ä»¬åœ¨ &lt;code>feature&lt;/code> åˆ†æ”¯æœ‰å¦‚ä¸‹æäº¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">74199cebdd34d107bb67b6da5533a2e405f4c330 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; feature&lt;span class="o">)&lt;/span> commit F
e7c7111d807c1d5209b97a9c75b09da5cd2810d4 commit E
d9623b0ef9d722b4a83d58a334e1ce85545ea524 commit D
73deeedaa944ef459b17d42601677c2fcc4c4703 commit C
c50221f93a39f3474ac59228d69732402556c93b commit B
ef1372522cdad136ce7e6dc3e02aab4d6ad73f79 commit A
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¦æ‰§è¡Œçš„æ“ä½œæ˜¯ï¼š&lt;/p>
&lt;ul>
&lt;li>å°† Bã€C åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„æäº¤ ï¼Œå¹¶ä»…ä¿ç•™åŸæäº¤ C çš„æäº¤ä¿¡æ¯&lt;/li>
&lt;li>åˆ é™¤æäº¤ D&lt;/li>
&lt;li>å°†æäº¤ E ç§»åŠ¨åˆ°æäº¤ F ä¹‹åå¹¶é‡æ–°å‘½åï¼ˆå³ä¿®æ”¹æäº¤ä¿¡æ¯ï¼‰ä¸ºæäº¤ H&lt;/li>
&lt;li>åœ¨æäº¤ F ä¸­åŠ å…¥ä¸€ä¸ªæ–°çš„æ–‡ä»¶æ›´æ”¹ï¼Œå¹¶é‡æ–°å‘½åä¸ºæäº¤ G&lt;/li>
&lt;/ul>
&lt;p>ç”±äºæˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„æäº¤æ˜¯ Bâ†’Câ†’Dâ†’Eï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†æäº¤ A ä½œä¸ºæ–°çš„ã€ŒåŸºç«¯ã€ï¼Œæäº¤ A ä¹‹åçš„æ‰€æœ‰æäº¤ä¼šè¢«é‡æ–°åº”ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git rebase -i ef1372522cdad136ce7e6dc3e02aab4d6ad73f79 &lt;span class="c1"># å‚æ•°æ˜¯æäº¤ A çš„ ID&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ¥ä¸‹æ¥ä¼šè¿›å…¥åˆ°å¦‚ä¸‹çš„ç¼–è¾‘å™¨ç•Œé¢ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">pick c50221f commit B
pick 73deeed commit C
pick d9623b0 commit D
pick e7c7111 commit E
pick 74199ce commit F
&lt;span class="c1"># å˜åŸº ef13725..74199ce åˆ° ef13725ï¼ˆ5 ä¸ªæäº¤ï¼‰&lt;/span>
&lt;span class="c1">#&lt;/span>
&lt;span class="c1"># å‘½ä»¤:&lt;/span>
&lt;span class="c1"># p, pick &amp;lt;æäº¤&amp;gt; = ä½¿ç”¨æäº¤&lt;/span>
&lt;span class="c1"># r, reword &amp;lt;æäº¤&amp;gt; = ä½¿ç”¨æäº¤ï¼Œä½†ä¿®æ”¹æäº¤è¯´æ˜&lt;/span>
&lt;span class="c1"># e, edit &amp;lt;æäº¤&amp;gt; = ä½¿ç”¨æäº¤ï¼Œè¿›å…¥ shell ä»¥ä¾¿è¿›è¡Œæäº¤ä¿®è¡¥&lt;/span>
&lt;span class="c1"># s, squash &amp;lt;æäº¤&amp;gt; = ä½¿ç”¨æäº¤ï¼Œä½†èåˆåˆ°å‰ä¸€ä¸ªæäº¤&lt;/span>
&lt;span class="c1"># f, fixup &amp;lt;æäº¤&amp;gt; = ç±»ä¼¼äº &amp;#34;squash&amp;#34;ï¼Œä½†ä¸¢å¼ƒæäº¤è¯´æ˜æ—¥å¿—&lt;/span>
&lt;span class="c1"># x, exec &amp;lt;å‘½ä»¤&amp;gt; = ä½¿ç”¨ shell è¿è¡Œå‘½ä»¤ï¼ˆæ­¤è¡Œå‰©ä½™éƒ¨åˆ†ï¼‰&lt;/span>
&lt;span class="c1"># b, break = åœ¨æ­¤å¤„åœæ­¢ï¼ˆä½¿ç”¨ &amp;#39;git rebase --continue&amp;#39; ç»§ç»­å˜åŸºï¼‰&lt;/span>
&lt;span class="c1"># d, drop &amp;lt;æäº¤&amp;gt; = åˆ é™¤æäº¤&lt;/span>
......
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ï¼ˆæ³¨æ„ä¸Šé¢æäº¤ ID ä¹‹åçš„æäº¤ä¿¡æ¯åªèµ·åˆ°æè¿°ä½œç”¨ï¼Œåœ¨è¿™é‡Œä¿®æ”¹å®ƒä»¬ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚ï¼‰&lt;/p>
&lt;p>å…·ä½“çš„æ“ä½œå‘½ä»¤åœ¨ç¼–è¾‘å™¨çš„æ³¨é‡Šä¸­å·²è§£é‡Šçš„ç›¸å½“è¯¦ç»†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å¯¹æäº¤ Bã€C ä½œå¦‚ä¸‹ä¿®æ”¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">pick c50221f commit B
f 73deeed commit C
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”±äºæäº¤ B æ˜¯è¿™äº›æäº¤ä¸­çš„ç¬¬ä¸€ä¸ªï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•å¯¹å…¶æ‰§è¡Œ &lt;code>squash&lt;/code> æˆ–è€… &lt;code>fixup&lt;/code> å‘½ä»¤ï¼ˆæ²¡æœ‰å‰ä¸€ä¸ªæäº¤äº†ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦å¯¹æäº¤ B æ‰§è¡Œ &lt;code>reword&lt;/code> å‘½ä»¤ä»¥ä¿®æ”¹å…¶æäº¤ä¿¡æ¯ï¼Œå› ä¸ºä¹‹ååœ¨å°†æäº¤ C èåˆåˆ°æäº¤ B ä¸­æ—¶ï¼Œä¼šå…è®¸æˆ‘ä»¬å¯¹èåˆä¹‹åçš„æäº¤ä¿¡æ¯è¿›è¡Œä¿®æ”¹ã€‚&lt;/p>
&lt;p>æ³¨æ„è¯¥ç•Œé¢æäº¤çš„å±•ç¤ºé¡ºåºæ˜¯ä»ä¸Šåˆ°ä¸‹ç”±æ—§åˆ°æ–°ï¼Œå› æ­¤æˆ‘ä»¬å°†æäº¤ C çš„å‘½ä»¤æ”¹ä¸º &lt;code>sï¼ˆæˆ– squashï¼‰&lt;/code> æˆ–è€… &lt;code>fï¼ˆæˆ– fixupï¼‰&lt;/code> ä¼šå°†å…¶èåˆåˆ°ï¼ˆä¸Šæ–¹çš„ï¼‰å‰ä¸€ä¸ªæäº¤ Bï¼Œä¸¤ä¸ªå‘½ä»¤çš„åŒºåˆ«ä¸ºæ˜¯å¦ä¿ç•™ C çš„æäº¤ä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åˆ é™¤æäº¤ Dï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">d d9623b0 commit D
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ç§»åŠ¨æäº¤ E åˆ°æäº¤ F ä¹‹åå¹¶ä¿®æ”¹å…¶æäº¤ä¿¡æ¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">pick 74199ce commit F
r e7c7111 commit E
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>åœ¨æäº¤ F ä¸­åŠ å…¥ä¸€ä¸ªæ–°çš„æ–‡ä»¶æ›´æ”¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">e 74199ce commit F
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ä¿å­˜é€€å‡ºã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>æ¥ä¸‹æ¥ä¼šæŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºä¾æ¬¡æ‰§è¡Œæˆ‘ä»¬å¯¹æ¯ä¸€ä¸ªæäº¤æ‰€ä¿®æ”¹æˆ–ä¿ç•™çš„å‘½ä»¤ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>å¯¹æäº¤ B çš„ &lt;code>pick&lt;/code> å‘½ä»¤ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œå› æ­¤ä¸éœ€è¦äº¤äº’ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ¥ç€æ‰§è¡Œå¯¹æäº¤ C çš„ &lt;code>squash&lt;/code> å‘½ä»¤ï¼Œä¼šè¿›å…¥ä¸€ä¸ªæ–°çš„ç¼–è¾‘å™¨ç•Œé¢å…è®¸æˆ‘ä»¬ä¿®æ”¹åˆå¹¶äº†Bã€C ä¹‹åçš„æäº¤ä¿¡æ¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># è¿™æ˜¯ä¸€ä¸ª 2 ä¸ªæäº¤çš„ç»„åˆã€‚&lt;/span>
&lt;span class="c1"># è¿™æ˜¯ç¬¬ä¸€ä¸ªæäº¤è¯´æ˜ï¼š&lt;/span>
commit B
&lt;span class="c1"># è¿™æ˜¯æäº¤è¯´æ˜ #2ï¼š&lt;/span>
commit C
......
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æˆ‘ä»¬å°† &lt;code>commit B&lt;/code> è¿™ä¸€è¡Œåˆ é™¤åä¿å­˜é€€å‡ºï¼Œèåˆä¹‹åçš„æäº¤å°†ä½¿ç”¨ &lt;code>commit C&lt;/code> ä½œä¸ºæäº¤ä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯¹æäº¤ D çš„ &lt;code>drop&lt;/code> æ“ä½œä¹Ÿä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ²¡æœ‰äº¤äº’æ­¥éª¤ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ‰§è¡Œ &lt;code>rebase&lt;/code> çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‘ç”Ÿå†²çªï¼Œè¿™æ—¶å€™ &lt;code>rebase&lt;/code> ä¼šæš‚æ—¶ä¸­æ­¢ï¼Œéœ€è¦æˆ‘ä»¬ç¼–è¾‘å†²çªçš„æ–‡ä»¶å»æ‰‹åŠ¨åˆå¹¶å†²çªã€‚è§£å†³å†²çªåé€šè¿‡ &lt;code>git add/rm &amp;lt;conflicted_files&amp;gt;&lt;/code> å°†å…¶æ ‡è®°ä¸ºå·²è§£å†³ï¼Œç„¶åæ‰§è¡Œ &lt;code>git rebase --continue&lt;/code> å¯ä»¥ç»§ç»­ä¹‹åçš„ &lt;code>rebase&lt;/code> æ­¥éª¤ï¼›æˆ–è€…ä¹Ÿå¯ä»¥æ‰§è¡Œ &lt;code>git rebase --abort&lt;/code> æ”¾å¼ƒ &lt;code>rebase&lt;/code> æ“ä½œå¹¶æ¢å¤åˆ°æ“ä½œä¹‹å‰çš„çŠ¶æ€ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”±äºæˆ‘ä»¬ä¸Šç§»äº†æäº¤ F çš„ä½ç½®ï¼Œå› æ­¤æ¥ä¸‹æ¥å°†æ‰§è¡Œå¯¹ F çš„ &lt;code>edit&lt;/code> æ“ä½œã€‚è¿™æ—¶å°†è¿›å…¥ä¸€ä¸ªæ–°çš„ Shell ä¼šè¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">åœæ­¢åœ¨ 74199ce... commit F
æ‚¨ç°åœ¨å¯ä»¥ä¿®è¡¥è¿™ä¸ªæäº¤ï¼Œä½¿ç”¨
git commit --amend
å½“æ‚¨å¯¹å˜æ›´æ„Ÿåˆ°æ»¡æ„ï¼Œæ‰§è¡Œ
git rebase --continue
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–°çš„ä»£ç æ–‡ä»¶å¹¶æ‰§è¡Œ &lt;code>git commit --amend&lt;/code> å°†å…¶åˆå¹¶åˆ°å½“å‰çš„ä¸Šä¸€ä¸ªæäº¤ï¼ˆå³ Fï¼‰ï¼Œç„¶ååœ¨ç¼–è¾‘å™¨ç•Œé¢ä¸­å°†å…¶æäº¤ä¿¡æ¯ä¿®æ”¹ä¸º &lt;code>commit G&lt;/code>ï¼Œæœ€åæ‰§è¡Œ &lt;code>git rebase --continue&lt;/code> ç»§ç»­ &lt;code>rebase&lt;/code> æ“ä½œã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœ€åæ‰§è¡Œå¯¹æäº¤ E çš„ &lt;code>reword&lt;/code> æ“ä½œï¼Œåœ¨ç¼–è¾‘å™¨ç•Œé¢ä¸­å°†å…¶æäº¤ä¿¡æ¯ä¿®æ”¹ä¸º &lt;code>commit H&lt;/code> ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>å¤§åŠŸå‘Šæˆï¼æœ€åè®©æˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹ &lt;code>rebase&lt;/code> ä¹‹åçš„æäº¤å†å²ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">64710dc88ef4fbe8fe7aac206ec2e3ef12e7bca9 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; feature&lt;span class="o">)&lt;/span> commit H
8ab4506a672dac5c1a55db34779a185f045d7dd3 commit G
1e186f890710291aab5b508a4999134044f6f846 commit C
ef1372522cdad136ce7e6dc3e02aab4d6ad73f79 commit A
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®Œå…¨ç¬¦åˆé¢„æœŸï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥çœ‹åˆ°æäº¤ Aä¹‹åçš„æ‰€æœ‰æäº¤ ID éƒ½å·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œè¿™ä¹Ÿå°è¯äº†æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„ Git é‡æ–°åˆ›å»ºäº†è¿™äº›æäº¤ã€‚&lt;/p>
&lt;h2 id="rebase-çš„è¿›é˜¶ç”¨æ³•">Rebase çš„è¿›é˜¶ç”¨æ³•&lt;/h2>
&lt;h3 id="åˆå¹¶ä¹‹å‰æ‰§è¡Œ-rebase">åˆå¹¶ä¹‹å‰æ‰§è¡Œ &lt;code>rebase&lt;/code>&lt;/h3>
&lt;p>å¦ä¸€ç§ä½¿ç”¨ &lt;code>rebase&lt;/code> çš„å¸¸è§åœºæ™¯æ˜¯åœ¨æ¨é€åˆ°è¿œç¨‹è¿›è¡Œåˆå¹¶ä¹‹å‰æ‰§è¡Œ &lt;code>rebase&lt;/code>ï¼Œä¸€èˆ¬è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿æäº¤å†å²çš„æ•´æ´ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬é¦–å…ˆåœ¨è‡ªå·±çš„åŠŸèƒ½åˆ†æ”¯é‡Œè¿›è¡Œå¼€å‘ï¼Œå½“å¼€å‘å®Œæˆæ—¶éœ€è¦å…ˆå°†å½“å‰åŠŸèƒ½åˆ†æ”¯ &lt;code>rebase&lt;/code> åˆ°æœ€æ–°çš„ä¸»åˆ†æ”¯ä¸Šï¼Œæå‰è§£å†³å¯èƒ½å‡ºç°çš„å†²çªï¼Œç„¶åå†å‘è¿œç¨‹æäº¤ä¿®æ”¹ã€‚ è¿™æ ·çš„è¯ï¼Œè¿œç¨‹ä»“åº“çš„ä¸»åˆ†æ”¯ç»´æŠ¤è€…å°±ä¸å†éœ€è¦è¿›è¡Œæ•´åˆä¸”åˆ›å»ºä¸€æ¡é¢å¤–çš„ &lt;code>merge&lt;/code> æäº¤ï¼Œåªéœ€è¦æ‰§è¡Œå¿«è¿›åˆå¹¶å³å¯ã€‚å³ä½¿æ˜¯åœ¨å¤šä¸ªåˆ†æ”¯å¹¶è¡Œå¼€å‘çš„æƒ…å†µï¼Œæœ€ç»ˆä¹Ÿèƒ½å¾—åˆ°ä¸€æ¡å®Œå…¨çº¿æ€§çš„æäº¤å†å²ã€‚&lt;/p>
&lt;h3 id="rebase-åˆ°å…¶ä»–åˆ†æ”¯">&lt;code>rebase&lt;/code> åˆ°å…¶ä»–åˆ†æ”¯&lt;/h3>
&lt;p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>rebase&lt;/code> å¯¹ä¸¤ä¸ªåˆ†æ”¯è¿›è¡Œå¯¹æ¯”ï¼Œå–å‡ºç›¸åº”çš„ä¿®æ”¹ï¼Œç„¶ååº”ç”¨åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ä¸Šã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash"> F---G patch
/
D---E feature
/
A---B---C master
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‡è®¾æˆ‘ä»¬åŸºäº &lt;code>feature&lt;/code> åˆ†æ”¯çš„æäº¤ D åˆ›å»ºäº†åˆ†æ”¯ &lt;code>patch&lt;/code>ï¼Œå¹¶ä¸”æ–°å¢äº†æäº¤ Fã€Gï¼Œç°åœ¨æˆ‘ä»¬æƒ³å°† &lt;code>patch&lt;/code> æ‰€åšçš„æ›´æ”¹åˆå¹¶åˆ° &lt;code>master&lt;/code> å¹¶å‘å¸ƒï¼Œä½†æš‚æ—¶è¿˜ä¸æƒ³åˆå¹¶ &lt;code>feature&lt;/code> ï¼Œè¿™ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ &lt;code>rebase&lt;/code> çš„ &lt;code>--onto &amp;lt;branch&amp;gt;&lt;/code> é€‰é¡¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git rebase â€”onto master feature patch
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä»¥ä¸Šæ“ä½œå°†å–å‡º &lt;code>patch&lt;/code> åˆ†æ”¯ï¼Œå¯¹æ¯”å®ƒåŸºäº &lt;code>feature&lt;/code> æ‰€åšçš„æ›´æ”¹ï¼Œ ç„¶åæŠŠè¿™äº›æ›´æ”¹åœ¨ &lt;code>master&lt;/code> åˆ†æ”¯ä¸Šé‡æ–°åº”ç”¨ï¼Œè®© &lt;code>patch&lt;/code> çœ‹èµ·æ¥å°±åƒç›´æ¥åŸºäº &lt;code>master&lt;/code> è¿›è¡Œæ›´æ”¹ä¸€æ ·ã€‚æ‰§è¡Œåçš„ &lt;code>patch&lt;/code> å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">A---B---C---F&lt;span class="s1">&amp;#39;---G&amp;#39;&lt;/span> patch
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç„¶åæˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ° &lt;code>master&lt;/code> åˆ†æ”¯ï¼Œå¹¶å¯¹ &lt;code>patch&lt;/code> æ‰§è¡Œå¿«è¿›åˆå¹¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git checkout master
git merge patch
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="é€šè¿‡-rebase-æ‰§è¡Œ-git-pull">é€šè¿‡ &lt;code>rebase&lt;/code> æ‰§è¡Œ &lt;code>git pull&lt;/code>&lt;/h3>
&lt;p>Git åœ¨æœ€è¿‘çš„æŸä¸ªç‰ˆæœ¬èµ·ï¼Œç›´æ¥è¿è¡Œ &lt;code>git pull&lt;/code> ä¼šæœ‰å¦‚ä¸‹æç¤ºæ¶ˆæ¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">warning: ä¸å»ºè®®åœ¨æ²¡æœ‰ä¸ºåç¦»åˆ†æ”¯æŒ‡å®šåˆå¹¶ç­–ç•¥æ—¶æ‰§è¡Œ pull æ“ä½œã€‚ æ‚¨å¯ä»¥åœ¨æ‰§è¡Œä¸‹ä¸€æ¬¡ pull æ“ä½œä¹‹å‰æ‰§è¡Œä¸‹é¢ä¸€æ¡å‘½ä»¤æ¥æŠ‘åˆ¶æœ¬æ¶ˆæ¯ï¼š
git config pull.rebase &lt;span class="nb">false&lt;/span> &lt;span class="c1"># åˆå¹¶ï¼ˆç¼ºçœç­–ç•¥ï¼‰&lt;/span>
git config pull.rebase &lt;span class="nb">true&lt;/span> &lt;span class="c1"># å˜åŸº&lt;/span>
git config pull.ff only &lt;span class="c1"># ä»…å¿«è¿›&lt;/span>
......
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åŸæ¥ &lt;code>git pull&lt;/code> æ—¶ä¹Ÿå¯ä»¥é€šè¿‡ &lt;code>rebase&lt;/code> æ¥è¿›è¡Œåˆå¹¶ï¼Œè¿™æ˜¯å› ä¸º &lt;code>git pull&lt;/code> å®é™…ä¸Šç­‰äº &lt;code>git fetch&lt;/code> + &lt;code>git merge&lt;/code> ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¬¬äºŒæ­¥ç›´æ¥ç”¨ &lt;code>git rebase&lt;/code> æ›¿æ¢ &lt;code>git merge&lt;/code>æ¥åˆå¹¶ &lt;code>fetch&lt;/code> å–å¾—çš„å˜æ›´ï¼Œä½œç”¨åŒæ ·æ˜¯é¿å…é¢å¤–çš„ &lt;code>merge&lt;/code> æäº¤ä»¥ä¿æŒçº¿æ€§çš„æäº¤å†å²ã€‚&lt;/p>
&lt;p>ä¸¤è€…çš„åŒºåˆ«åœ¨ä¸Šæ–‡ä¸­å·²è¿›è¡Œè¿‡å¯¹æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¯¹æ¯”ç¤ºä¾‹ä¸­çš„ &lt;code>Matser&lt;/code> åˆ†æ”¯å½“æˆè¿œç¨‹åˆ†æ”¯ï¼ŒæŠŠ &lt;code>Feature&lt;/code> åˆ†æ”¯å½“æˆæœ¬åœ°åˆ†æ”¯ï¼Œå½“æˆ‘ä»¬åœ¨æœ¬åœ°æ‰§è¡Œ &lt;code>git pull&lt;/code> æ—¶ï¼Œå…¶å®å°±æ˜¯æ‹‰å– &lt;code>Master&lt;/code> çš„æ›´æ”¹ç„¶ååˆå¹¶åˆ° &lt;code>Feature&lt;/code> åˆ†æ”¯ã€‚å¦‚æœä¸¤ä¸ªåˆ†æ”¯éƒ½æœ‰ä¸åŒçš„æäº¤ï¼Œé»˜è®¤çš„ &lt;code>git merge&lt;/code> æ–¹å¼ä¼šç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„ merge æäº¤ä»¥æ•´åˆè¿™äº›æäº¤ï¼›è€Œä½¿ç”¨ &lt;code>git rebase&lt;/code> åˆ™ç›¸å½“äºåŸºäºè¿œç¨‹åˆ†æ”¯çš„æœ€æ–°æäº¤é‡æ–°åˆ›å»ºæœ¬åœ°åˆ†æ”¯ï¼Œç„¶åå†é‡æ–°åº”ç”¨æœ¬åœ°æ‰€æ·»åŠ çš„æäº¤ã€‚&lt;/p>
&lt;p>å…·ä½“çš„ä½¿ç”¨æ–¹å¼æœ‰å¤šç§ï¼š&lt;/p>
&lt;ul>
&lt;li>æ¯æ¬¡æ‰§è¡Œ pull å‘½ä»¤æ—¶æ·»åŠ ç‰¹å®šé€‰é¡¹ï¼š &lt;code>git pull --rebase&lt;/code> ã€‚&lt;/li>
&lt;li>ä¸ºå½“å‰ä»“åº“è®¾å®šé…ç½®é¡¹ï¼š &lt;code>git config pull.rebase true&lt;/code>ï¼Œåœ¨ &lt;code>git config&lt;/code> åæ·»åŠ  &lt;code>--global&lt;/code> é€‰é¡¹å¯ä»¥ä½¿è¯¥é…ç½®é¡¹å¯¹æ‰€æœ‰ä»“åº“ç”Ÿæ•ˆã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ½œåœ¨å¼Šç«¯å’Œåå¯¹æ„è§">æ½œåœ¨å¼Šç«¯å’Œåå¯¹æ„è§&lt;/h2>
&lt;p>ä»ä»¥ä¸Šåœºæ™¯æ¥çœ‹ &lt;code>rebase&lt;/code> åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œä½†æˆ‘ä»¬ä¹Ÿéœ€è¦æ„è¯†åˆ°å®ƒä¸æ˜¯ä¸‡èƒ½çš„ï¼Œç”šè‡³å¯¹æ–°æ‰‹æ¥è¯´æœ‰äº›å±é™©ï¼Œç¨æœ‰ä¸æ…å°±ä¼šå‘ç° &lt;code>git log&lt;/code> é‡Œçš„æäº¤ä¸è§äº†ï¼Œæˆ–è€…å¡åœ¨ &lt;code>rebase&lt;/code> çš„æŸä¸ªæ­¥éª¤ä¸çŸ¥é“å¦‚ä½•æ¢å¤ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä¸Šé¢å·²ç»æåˆ°äº† &lt;code>rebase&lt;/code> æœ‰ä¿æŒæ•´æ´çš„çº¿æ€§æäº¤å†å²çš„ä¼˜ç‚¹ï¼Œä½†ä¹Ÿéœ€è¦æ„è¯†åˆ°å®ƒæœ‰ä»¥ä¸‹æ½œåœ¨çš„å¼Šç«¯ï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚æœæ¶‰åŠåˆ°å·²ç»æ¨é€è¿‡çš„æäº¤ï¼Œéœ€è¦å¼ºåˆ¶æ¨é€æ‰èƒ½å°†æœ¬åœ° &lt;code>rebase&lt;/code> åçš„æäº¤æ¨é€åˆ°è¿œç¨‹ã€‚å› æ­¤ç»å¯¹ä¸è¦åœ¨ä¸€ä¸ªå…¬å…±åˆ†æ”¯ï¼ˆä¹Ÿå°±æ˜¯è¯´è¿˜æœ‰å…¶ä»–äººåŸºäºè¿™ä¸ªåˆ†æ”¯è¿›è¡Œå¼€å‘ï¼‰æ‰§è¡Œ &lt;code>rebase&lt;/code>ï¼Œå¦åˆ™å…¶ä»–äººä¹‹åæ‰§è¡Œ &lt;code>git pull&lt;/code> ä¼šæŠŠä»–ä»¬æœ¬åœ°çš„æäº¤å†å²ä¹Ÿè¦†ç›–æ‰ï¼Œç”šè‡³å’Œä»–ä»¬å·²å®Œæˆçš„å·¥ä½œå‘ç”Ÿå†²çªï¼Œè¾ƒä¸¥é‡çš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¹ä½ çš„äººèº«å®‰å…¨å¸¦æ¥é£é™©ã€‚&lt;/li>
&lt;li>å¯¹æ–°æ‰‹ä¸å‹å¥½ï¼Œæ–°æ‰‹å¾ˆæœ‰å¯èƒ½åœ¨äº¤äº’æ¨¡å¼ä¸­è¯¯æ“ä½œã€Œä¸¢å¤±ã€æŸäº›æäº¤ï¼ˆä½†å…¶å®æ˜¯èƒ½å¤Ÿæ‰¾å›çš„ï¼‰ã€‚&lt;/li>
&lt;li>å‡å¦‚ä½ é¢‘ç¹çš„ä½¿ç”¨ &lt;code>rebase&lt;/code> æ¥é›†æˆä¸»åˆ†æ”¯çš„æ›´æ–°ï¼Œä¸€ä¸ªæ½œåœ¨çš„åæœæ˜¯ä½ ä¼šé‡åˆ°è¶Šæ¥è¶Šå¤šéœ€è¦åˆå¹¶çš„å†²çªã€‚å°½ç®¡ä½ å¯ä»¥åœ¨ &lt;code>rebase&lt;/code> è¿‡ç¨‹ä¸­å¤„ç†è¿™äº›å†²çªï¼Œä½†è¿™å¹¶éé•¿ä¹…ä¹‹è®¡ï¼Œæ›´æ¨èçš„åšæ³•æ˜¯é¢‘ç¹çš„åˆå…¥ä¸»åˆ†æ”¯ç„¶ååˆ›å»ºæ–°çš„åŠŸèƒ½åˆ†æ”¯ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸€ä¸ªé•¿æ—¶é—´å­˜åœ¨çš„åŠŸèƒ½åˆ†æ”¯ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¦å¤–æœ‰ä¸€äº›è§‚ç‚¹æ˜¯æˆ‘ä»¬åº”è¯¥å°½é‡é¿å…é‡å†™æäº¤å†å²ï¼š&lt;/p>
&lt;blockquote>
&lt;p>æœ‰ä¸€ç§è§‚ç‚¹è®¤ä¸ºï¼Œä»“åº“çš„æäº¤å†å²å³æ˜¯ è®°å½•å®é™…å‘ç”Ÿè¿‡ä»€ä¹ˆã€‚ å®ƒæ˜¯é’ˆå¯¹å†å²çš„æ–‡æ¡£ï¼Œæœ¬èº«å°±æœ‰ä»·å€¼ï¼Œä¸èƒ½ä¹±æ”¹ã€‚ ä»è¿™ä¸ªè§’åº¦çœ‹æ¥ï¼Œæ”¹å˜æäº¤å†å²æ˜¯ä¸€ç§äºµæ¸ï¼Œä½ ä½¿ç”¨ è°è¨€ æ©ç›–äº†å®é™…å‘ç”Ÿè¿‡çš„äº‹æƒ…ã€‚ å¦‚æœç”±åˆå¹¶äº§ç”Ÿçš„æäº¤å†å²æ˜¯ä¸€å›¢ç³Ÿæ€ä¹ˆåŠï¼Ÿ æ—¢ç„¶äº‹å®å°±æ˜¯å¦‚æ­¤ï¼Œé‚£ä¹ˆè¿™äº›ç—•è¿¹å°±åº”è¯¥è¢«ä¿ç•™ä¸‹æ¥ï¼Œè®©åäººèƒ½å¤ŸæŸ¥é˜…ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä»¥åŠé¢‘ç¹çš„ä½¿ç”¨ &lt;code>rebase&lt;/code> å¯èƒ½ä¼šä½¿ä»å†å²æäº¤ä¸­å®šä½ bug å˜å¾—æ›´åŠ å›°éš¾ï¼Œè¯¦è§ &lt;a href="https://medium.com/@fredrikmorken/why-you-should-stop-using-git-rebase-5552bee4fed1">https://medium.com/@fredrikmorken/why-you-should-stop-using-git-rebase-5552bee4fed1&lt;/a>ã€‚&lt;/p>
&lt;h2 id="æ‰¾å›ä¸¢å¤±çš„æäº¤">æ‰¾å›ä¸¢å¤±çš„æäº¤&lt;/h2>
&lt;p>åœ¨äº¤äº’å¼æ¨¡å¼ä¸‹è¿›è¡Œ &lt;code>rebase&lt;/code> å¹¶å¯¹æäº¤æ‰§è¡Œ &lt;code>squash&lt;/code> æˆ– &lt;code>drop&lt;/code> ç­‰å‘½ä»¤åï¼Œä¼šä»åˆ†æ”¯çš„ &lt;code>git log&lt;/code> ä¸­ç›´æ¥åˆ é™¤æäº¤ã€‚å¦‚æœä½ ä¸å°å¿ƒæ“ä½œå¤±è¯¯ï¼Œä¼šä»¥ä¸ºè¿™äº›æäº¤å·²ç»æ°¸ä¹…æ¶ˆå¤±äº†è€Œå“å‡ºä¸€èº«å†·æ±—ã€‚&lt;/p>
&lt;p>ä½†è¿™äº›æäº¤å¹¶æ²¡æœ‰çœŸæ­£åœ°è¢«åˆ é™¤ï¼Œå¦‚ä¸Šæ‰€è¯´ï¼ŒGit å¹¶ä¸ä¼šä¿®æ”¹ï¼ˆæˆ–åˆ é™¤ï¼‰åŸæ¥çš„æäº¤ï¼Œè€Œæ˜¯é‡æ–°åˆ›å»ºäº†ä¸€æ‰¹æ–°çš„æäº¤ï¼Œå¹¶å°†å½“å‰åˆ†æ”¯é¡¶ç«¯æŒ‡å‘äº†æ–°æäº¤ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code>git reflog&lt;/code> æ‰¾åˆ°å¹¶ä¸”é‡æ–°æŒ‡å‘åŸæ¥çš„æäº¤æ¥æ¢å¤å®ƒä»¬ï¼Œè¿™ä¼šæ’¤é”€æ•´ä¸ª &lt;code>rebase&lt;/code>ã€‚æ„Ÿè°¢ Git ï¼Œå³ä½¿ä½ æ‰§è¡Œ &lt;code>rebase&lt;/code> æˆ–è€… &lt;code>commit --amend&lt;/code> ç­‰é‡å†™æäº¤å†å²çš„æ“ä½œï¼Œå®ƒä¹Ÿä¸ä¼šçœŸæ­£åœ°ä¸¢å¤±ä»»ä½•æäº¤ã€‚&lt;/p>
&lt;h3 id="git-reflog">&lt;code>git reflog&lt;/code>&lt;/h3>
&lt;p>&lt;code>reflogs&lt;/code> æ˜¯ Git ç”¨æ¥è®°å½•æœ¬åœ°ä»“åº“åˆ†æ”¯é¡¶ç«¯çš„æ›´æ–°çš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒä¼šè®°å½•æ‰€æœ‰åˆ†æ”¯é¡¶ç«¯æ›¾ç»æŒ‡å‘è¿‡çš„æäº¤ï¼Œå› æ­¤ &lt;code>reflogs&lt;/code> å…è®¸æˆ‘ä»¬æ‰¾åˆ°å¹¶åˆ‡æ¢åˆ°ä¸€ä¸ªå½“å‰æ²¡æœ‰è¢«ä»»ä½•åˆ†æ”¯æˆ–æ ‡ç­¾å¼•ç”¨çš„æäº¤ã€‚&lt;/p>
&lt;p>æ¯å½“åˆ†æ”¯é¡¶ç«¯ç”±äºä»»ä½•åŸå› è¢«æ›´æ–°ï¼ˆé€šè¿‡åˆ‡æ¢åˆ†æ”¯ã€æ‹‰å–æ–°çš„å˜æ›´ã€é‡å†™å†å²æˆ–è€…æ·»åŠ æ–°çš„æäº¤ï¼‰ï¼Œä¸€æ¡æ–°çš„è®°å½•å°†è¢«æ·»åŠ åˆ° &lt;code>reflogs&lt;/code> ä¸­ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°æ‰€åˆ›å»ºè¿‡çš„æ¯ä¸€æ¬¡æäº¤éƒ½ä¸€å®šä¼šè¢«è®°å½•åœ¨ &lt;code>reflogs&lt;/code> ä¸­ã€‚å³ä½¿åœ¨é‡å†™äº†æäº¤å†å²ä¹‹åï¼Œ &lt;code>reflogs&lt;/code> ä¹Ÿä¼šåŒ…å«å…³äºåˆ†æ”¯çš„æ—§çŠ¶æ€çš„ä¿¡æ¯ï¼Œå¹¶å…è®¸æˆ‘ä»¬åœ¨éœ€è¦æ—¶æ¢å¤åˆ°è¯¥çŠ¶æ€ã€‚&lt;/p>
&lt;p>æ³¨æ„ &lt;code>reflogs&lt;/code> å¹¶ä¸ä¼šæ°¸ä¹…ä¿å­˜ï¼Œå®ƒæœ‰ 90 å¤©çš„è¿‡æœŸæ—¶é—´ã€‚&lt;/p>
&lt;h3 id="è¿˜åŸæäº¤å†å²">è¿˜åŸæäº¤å†å²&lt;/h3>
&lt;p>æˆ‘ä»¬ä»ä¸Šä¸€ä¸ªä¾‹å­ç»§ç»­ï¼Œå‡è®¾æˆ‘ä»¬æƒ³æ¢å¤ &lt;code>feature&lt;/code> åˆ†æ”¯åœ¨ &lt;code>rebase&lt;/code> ä¹‹å‰çš„ Aâ†’Bâ†’Câ†’Dâ†’Eâ†’F æäº¤å†å²ï¼Œä½†è¿™æ—¶å€™çš„ &lt;code>git log&lt;/code> ä¸­å·²ç»æ²¡æœ‰åé¢ 5 ä¸ªæäº¤ï¼Œæ‰€ä»¥éœ€è¦ä» &lt;code>reflogs&lt;/code> ä¸­å¯»æ‰¾ï¼Œè¿è¡Œ &lt;code>git reflog&lt;/code> ç»“æœå¦‚ä¸‹:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">64710dc &lt;span class="o">(&lt;/span>HEAD -&amp;gt; feature&lt;span class="o">)&lt;/span> HEAD@&lt;span class="o">{&lt;/span>0&lt;span class="o">}&lt;/span>: rebase &lt;span class="o">(&lt;/span>&lt;span class="k">continue&lt;/span>&lt;span class="o">)&lt;/span> &lt;span class="o">(&lt;/span>finish&lt;span class="o">)&lt;/span>: returning to refs/heads/feature
64710dc &lt;span class="o">(&lt;/span>HEAD -&amp;gt; feature&lt;span class="o">)&lt;/span> HEAD@&lt;span class="o">{&lt;/span>1&lt;span class="o">}&lt;/span>: rebase &lt;span class="o">(&lt;/span>&lt;span class="k">continue&lt;/span>&lt;span class="o">)&lt;/span>: commit H
8ab4506 HEAD@&lt;span class="o">{&lt;/span>2&lt;span class="o">}&lt;/span>: rebase &lt;span class="o">(&lt;/span>&lt;span class="k">continue&lt;/span>&lt;span class="o">)&lt;/span>: commit G
1e186f8 HEAD@&lt;span class="o">{&lt;/span>3&lt;span class="o">}&lt;/span>: rebase &lt;span class="o">(&lt;/span>squash&lt;span class="o">)&lt;/span>: commit C
c50221f HEAD@&lt;span class="o">{&lt;/span>4&lt;span class="o">}&lt;/span>: rebase &lt;span class="o">(&lt;/span>start&lt;span class="o">)&lt;/span>: checkout ef1372522cdad136ce7e6dc3e02aab4d6ad73f79
74199ce HEAD@&lt;span class="o">{&lt;/span>5&lt;span class="o">}&lt;/span>: checkout: moving from master to feature
......
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>reflogs&lt;/code> å®Œæ•´çš„è®°å½•äº†æˆ‘ä»¬åˆ‡æ¢åˆ†æ”¯å¹¶è¿›è¡Œ &lt;code>rebase&lt;/code> çš„å…¨è¿‡ç¨‹ï¼Œç»§ç»­å‘ä¸‹æ£€ç´¢ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä» &lt;code>git log&lt;/code> ä¸­æ¶ˆå¤±çš„æäº¤ F:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">74199ce HEAD@&lt;span class="o">{&lt;/span>15&lt;span class="o">}&lt;/span>: commit: commit F
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ &lt;code>git reset&lt;/code> å°† &lt;code>feature&lt;/code> åˆ†æ”¯çš„é¡¶ç«¯é‡æ–°æŒ‡å‘åŸæ¥çš„æäº¤ Fï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># æˆ‘ä»¬æƒ³å°†å·¥ä½œåŒºä¸­çš„æ–‡ä»¶ä¹Ÿä¸€å¹¶è¿˜åŸï¼Œå› æ­¤ä½¿ç”¨äº†--hardé€‰é¡¹ &lt;/span>
$ git reset --hard 74199ce
HEAD ç°åœ¨ä½äº 74199ce commit F
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å†è¿è¡Œ &lt;code>git log&lt;/code> ä¼šå‘ç°ä¸€åˆ‡åˆå›åˆ°äº†ä»å‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">74199cebdd34d107bb67b6da5533a2e405f4c330 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; feature&lt;span class="o">)&lt;/span> commit F
e7c7111d807c1d5209b97a9c75b09da5cd2810d4 commit E
d9623b0ef9d722b4a83d58a334e1ce85545ea524 commit D
73deeedaa944ef459b17d42601677c2fcc4c4703 commit C
c50221f93a39f3474ac59228d69732402556c93b commit B
ef1372522cdad136ce7e6dc3e02aab4d6ad73f79 commit A
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase">git rebase | Atlassian Git Tutorial&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.atlassian.com/git/tutorials/rewriting-history">git amend | Atlassian Git Tutorial&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.atlassian.com/git/tutorials/syncing/git-pull">Git Pull | Atlassian Git Tutorial&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA">Git - å˜åŸº&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://git-scm.com/docs/git-rebase">Git - git-rebase Documentation&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://git-scm.com/docs/git-reflog">Git - git-reflog Documentation&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://medium.com/@fredrikmorken/why-you-should-stop-using-git-rebase-5552bee4fed1">Why you should stop using Git rebase&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://medium.com/@fabisiakradoslaw/understand-how-does-git-rebase-work-and-compare-with-git-merge-and-git-interactive-rebase-cce2c9775e43">Understand how does git rebase work and compare with git merge and git interactive rebase&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul></description><category domain="https://www.waynerv.com/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</category><category domain="https://www.waynerv.com/tags/git/">Git</category></item></channel></rss>