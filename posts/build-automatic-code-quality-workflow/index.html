<!doctype html><html lang=zh-cn><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta name=generator content="Hugo 0.100.1"><meta name=theme-color content="#fff"><meta name=color-scheme content="light dark"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><title>æ„å»ºä¿éšœä»£ç è´¨é‡çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ | Shall We Code?</title><link rel=stylesheet href=/css/meme.min.cd79c6af060c6823eea89a5433402a7961859790ff86241745d771a9c4ffbf1e.css><script src=/js/meme.min.2cb78730e8e63f071866707545921d21d377ec9c2a6251a81f1ea14eaf03376f.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond&family=Fira+Code:wght@400;700&family=Noto+Serif+SC:wght@400;700&display=swap" media=print onload="this.media='all'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond&family=Fira+Code:wght@400;700&family=Noto+Serif+SC:wght@400;700&display=swap"></noscript><meta name=author content="Waynerv"><meta name=description content="ä»£ç è´¨é‡æ˜¯ç¨‹åºå‘˜çš„èŒä¸šåº•çº¿ï¼Œç»´æŠ¤åº•çº¿ä¸èƒ½å…¨é è‡ªè§‰ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•å°† flake8ã€blackã€pre-commit ç­‰å·¥å…·é›†æˆåˆ°æ—¥å¸¸çš„å·¥ä½œæµä¸­ï¼Œçœå¿ƒçœåŠ›çš„æŒç»­ä¿éšœä»£ç è´¨é‡ã€‚"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Shall We Code?"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="Shall We Code?"><meta name=msapplication-starturl content="../../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../../icons/mstile-150x150.png"><link rel=manifest href=/manifest.json><link rel=canonical href=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2021-01-04T11:28:01+08:00","dateModified":"2022-07-10T11:51:08+00:00","url":"https://www.waynerv.com/posts/build-automatic-code-quality-workflow/","headline":"æ„å»ºä¿éšœä»£ç è´¨é‡çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ","description":"ä»£ç è´¨é‡æ˜¯ç¨‹åºå‘˜çš„èŒä¸šåº•çº¿ï¼Œç»´æŠ¤åº•çº¿ä¸èƒ½å…¨é è‡ªè§‰ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•å°† flake8ã€blackã€pre-commit ç­‰å·¥å…·é›†æˆåˆ°æ—¥å¸¸çš„å·¥ä½œæµä¸­ï¼Œçœå¿ƒçœåŠ›çš„æŒç»­ä¿éšœä»£ç è´¨é‡ã€‚","inLanguage":"zh-CN","articleSection":"posts","wordCount":7529,"image":["https://www.waynerv.com/2020-01-04-pre-commit-workflow.png","https://www.waynerv.com/2020-01-04-pipelines.png","https://www.waynerv.com/2020-01-04-runner-status.png","https://www.waynerv.com/2020-01-04-pipeline-graph.png","https://www.waynerv.com/2020-01-04-pipeline-entry.png","https://www.waynerv.com/2020-01-04-job-detail.png","https://www.waynerv.com/2020-01-04-actions-page.png"],"author":{"@type":"Person","description":"Viva La Vida","email":"ampedee@gmail.com","image":"https://www.waynerv.com/icons/apple-touch-icon.png","url":"https://www.waynerv.com","name":"Waynerv"},"license":"[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)","publisher":{"@type":"Organization","name":"Shall We Code?","logo":{"@type":"ImageObject","url":"https://www.waynerv.com/icons/apple-touch-icon.png"},"url":"https://www.waynerv.com/"},"mainEntityOfPage":{"@type":"WebSite","@id":"https://www.waynerv.com/"}}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@waynerv77"><meta name=twitter:creator content="@waynerv77"><meta property="og:title" content="æ„å»ºä¿éšœä»£ç è´¨é‡çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ"><meta property="og:description" content="ä»£ç è´¨é‡æ˜¯ç¨‹åºå‘˜çš„èŒä¸šåº•çº¿ï¼Œç»´æŠ¤åº•çº¿ä¸èƒ½å…¨é è‡ªè§‰ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•å°† flake8ã€blackã€pre-commit ç­‰å·¥å…·é›†æˆåˆ°æ—¥å¸¸çš„å·¥ä½œæµä¸­ï¼Œçœå¿ƒçœåŠ›çš„æŒç»­ä¿éšœä»£ç è´¨é‡ã€‚"><meta property="og:url" content="https://www.waynerv.com/posts/build-automatic-code-quality-workflow/"><meta property="og:site_name" content="Shall We Code?"><meta property="og:locale" content="zh"><meta property="og:image" content="https://www.waynerv.com/2020-01-04-pre-commit-workflow.png"><meta property="og:type" content="article"><meta property="article:published_time" content="2021-01-04T11:28:01+08:00"><meta property="article:modified_time" content="2022-07-10T11:51:08+00:00"><meta property="article:section" content="posts"><link rel=preconnect href=https://www.google-analytics.com crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKX36RHBD0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-SKX36RHBD0')</script></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=/ class=brand>Shall We Code?</a></div><nav class=nav><ul class=menu id=menu><li class=menu-item><a href=/posts/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7.0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6.0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6.0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3.0 64v48c0 8.8 7.2 16 16 16h480c8.8.0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class=menu-item-name>æ–‡ç« </span></a></li><li class=menu-item><a href=/categories/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon th"><path d="M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255.0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255.0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255.0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256.0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255.0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255.0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255.0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256.0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255.0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255.0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255.0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255.0-24 10.745-24 24zm386.667-56H488c13.255.0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255.0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255.0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255.0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255.0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255.0-24 10.745-24 24z"/></svg><span class=menu-item-name>åˆ†ç±»</span></a></li><li class=menu-item><a href=/tags/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon tags"><path d="M497.941 225.941 286.059 14.059A48 48 0 00252.118.0H48C21.49.0.0 21.49.0 48v204.118a48 48 0 0014.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882.0l204.118-204.118c18.745-18.745 18.745-49.137.0-67.882zM112 160c-26.51.0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882.0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397.0h48.721a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882z"/></svg><span class=menu-item-name>æ ‡ç­¾</span></a></li><li class=menu-item><a href=/friends/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon link"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg><span class=menu-item-name>å‹é“¾</span></a></li><li class=menu-item><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon user-circle"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6.0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7.0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4.0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9s28-2.7 40.9-6.9c2.3-.7 4.7-1.1 7.1-1.1 42.9.0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><span class=menu-item-name>å…³äº</span></a></li><li class=menu-item><a id=theme-switcher href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5 242 7a18 18 0 0128 0l48.8 97.5L422.2 70A18 18 0 01442 89.8l-34.5 103.4L505 242a18 18 0 010 28l-97.5 48.8L442 422.2A18 18 0 01422.2 442l-103.4-34.5L270 505a18 18 0 01-28 0l-48.8-97.5L89.8 442A18 18 0 0170 422.2l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8L70 89.8A18 18 0 0189.8 70zM256 128a128 128 0 10.01.0M256 160a96 96 0 10.01.0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412A256 256 0 10181 5a11.5 11.5.0 00-5 20A201.5 201.5.0 0142 399a11.5 11.5.0 00-15 13"/></svg></a></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=justify data-type=posts data-toc-num=true><h1 class="post-title p-name">æ„å»ºä¿éšœä»£ç è´¨é‡çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ</h1><div class=post-meta><time datetime=2021-01-04T11:28:01+08:00 class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;2021.1.4</time>
<span class="post-meta-item category"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>&nbsp;<a href=/categories/%E5%B7%A5%E5%85%B7/ class="category-link p-category">å·¥å…·</a></span>
<span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;7529</span>
<span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;16&nbsp;åˆ†é’Ÿ</span>
<span class="post-meta-item busuanzi-page-pv" id=busuanzi_container_page_pv><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="icon post-meta-icon"><path d="M288 144a110.94 110.94.0 00-31.24 5 55.4 55.4.0 017.24 27 56 56 0 01-56 56 55.4 55.4.0 01-27-7.24A111.71 111.71.0 10288 144zm284.52 97.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35.0 000 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35.0 000-29.19zM288 4e2c-98.65.0-189.09-55-237.93-144C98.91 167 189.34 112 288 112s189.09 55 237.93 144C477.1 345 386.66 4e2 288 4e2z"/></svg>&nbsp;<span id=busuanzi_value_page_pv></span></span></div><nav class=contents><h2 id=contents class=contents-title>ç›®å½•</h2><ol class=toc><li><a id=contents:linter href=#linter>Linter</a><ol><li><a id=contents:ä¸ºä½•è¦ä½¿ç”¨-linter href=#ä¸ºä½•è¦ä½¿ç”¨-linter>ä¸ºä½•è¦ä½¿ç”¨ Linter</a></li><li><a id=contents:flake8-ä½¿ç”¨ç¤ºä¾‹ href=#flake8-ä½¿ç”¨ç¤ºä¾‹><code>flake8</code> ä½¿ç”¨ç¤ºä¾‹</a></li></ol></li><li><a id=contents:static-type-checker href=#static-type-checker>Static Type Checker</a><ol><li><a id=contents:ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„ href=#ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„>ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„</a></li></ol></li><li><a id=contents:autoformatter href=#autoformatter>Autoformatter</a><ol><li><a id=contents:ide-çš„è‡ªå¸¦å·¥å…· href=#ide-çš„è‡ªå¸¦å·¥å…·>IDE çš„è‡ªå¸¦å·¥å…·</a></li></ol></li><li><a id=contents:hooks href=#hooks>Hooks</a><ol><li><a id=contents:git-hooks href=#git-hooks>Git Hooks</a></li><li><a id=contents:pre-commit href=#pre-commit>pre-commit</a></li><li><a id=contents:pre-commit-hooks-çš„é™åˆ¶ href=#pre-commit-hooks-çš„é™åˆ¶><code>pre-commit hooks</code> çš„é™åˆ¶</a></li></ol></li><li><a id=contents:pipelines href=#pipelines>Pipelines</a><ol><li><a id=contents:cicd href=#cicd>CI/CD</a></li><li><a id=contents:pipeline href=#pipeline>Pipeline</a></li><li><a id=contents:gitlab-ci-ç¤ºä¾‹ href=#gitlab-ci-ç¤ºä¾‹>GitLab CI ç¤ºä¾‹</a><ol><li><a id=contents:é…ç½®-runner href=#é…ç½®-runner>é…ç½® Runner</a></li><li><a id=contents:åˆ›å»º-gitlabyml href=#åˆ›å»º-gitlabyml>åˆ›å»º <code>.gitlab.yml</code></a></li><li><a id=contents:æŸ¥çœ‹-pipeline-çš„è¿è¡ŒçŠ¶æ€ href=#æŸ¥çœ‹-pipeline-çš„è¿è¡ŒçŠ¶æ€>æŸ¥çœ‹ pipeline çš„è¿è¡ŒçŠ¶æ€</a></li></ol></li><li><a id=contents:github-cd-ç¤ºä¾‹ href=#github-cd-ç¤ºä¾‹>GitHub CD ç¤ºä¾‹</a><ol><li><a id=contents:å’Œ-gitlab-cicd-çš„åŒºåˆ« href=#å’Œ-gitlab-cicd-çš„åŒºåˆ«>å’Œ GitLab CI/CD çš„åŒºåˆ«</a></li><li><a id=contents:ä½¿ç”¨-github-actions-è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹ href=#ä½¿ç”¨-github-actions-è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹>ä½¿ç”¨ GitHub Actions è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹</a></li></ol></li></ol></li><li><a id=contents:æ€»ç»“ href=#æ€»ç»“>æ€»ç»“</a></li><li><a id=contents:å‚è€ƒé“¾æ¥ href=#å‚è€ƒé“¾æ¥>å‚è€ƒé“¾æ¥</a></li></ol></nav><div class="post-body e-content"><p>åœ¨æˆ‘çœ‹æ¥ï¼Œä»£ç è´¨é‡å°±æ˜¯ç¨‹åºå‘˜çš„èŒä¸šåº•çº¿ã€‚ç»´æŠ¤åº•çº¿ä¸èƒ½å…¨é è‡ªè§‰ï¼Œå› æ­¤æœ¬æ–‡å°†ä»‹ç»å‡ ç§è‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œå¹¶å±•ç¤ºå¦‚ä½•å°†å®ƒä»¬é›†æˆåˆ°æ—¥å¸¸çš„å·¥ä½œæµä¸­ï¼Œçœå¿ƒçœåŠ›çš„æŒç»­ä¿éšœä»£ç è´¨é‡ã€‚</p><h2 id=linter><a href=#linter class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:linter class=headings>Linter</a></h2><p>Linter æ˜¯ä¸€ç±»ç”¨äºæ ‡è®°ç¨‹åºé”™è¯¯ã€bugã€é£æ ¼é”™è¯¯å’Œå¯ç–‘ç»“æ„çš„é™æ€ä»£ç åˆ†æå·¥å…·ï¼Œæ¯”å¦‚ Python ä¸­çš„ <code>Pylint</code>ã€ <code>flake8</code>ï¼ŒJavaScript ä¸­çš„ <code>EsLint</code>ï¼Œè¿™ç±»å·¥å…·ä¼šæ‰¾åˆ°ä½ ä»£ç ä¸­çš„é”™è¯¯ï¼Œå¹¶ç»™å‡ºå¦‚ä½•ä¿®å¤çš„æç¤ºã€‚</p><h3 id=ä¸ºä½•è¦ä½¿ç”¨-linter><a href=#ä¸ºä½•è¦ä½¿ç”¨-linter class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:ä¸ºä½•è¦ä½¿ç”¨-linter class=headings>ä¸ºä½•è¦ä½¿ç”¨ Linter</a></h3><p>äººæ€»æ˜¯ä¼šç²—å¿ƒå’ŒçŠ¯é”™ï¼Œå€ŸåŠ© Linter æˆ‘ä»¬å¯ä»¥å‘ç°ä»£ç ä¸­ä¸æ˜“å¯Ÿè§‰æˆ–é—æ¼çš„é”™è¯¯ï¼Œå¹¶è¿›è¡Œçº æ­£ã€‚ä½¿ç”¨ Linter æœ‰ä»¥ä¸‹å¥½å¤„ï¼š</p><ul><li>æ ¹æ® <a href=https://www.python.org/dev/peps/pep-0008/ target=_blank rel=noopener>PEP8</a> ç­‰è¯­è¨€è§„èŒƒæŒç»­çš„æç¤ºä¸çº æ­£ï¼Œå¸®åŠ©ä½ å†™å‡ºæ›´å¥½çš„ä»£ç </li><li>å‡å°‘ä»£ç ä¸­çš„æ ¼å¼é”™è¯¯ã€ç¬”è¯¯åŠç³Ÿç³•çš„é£æ ¼ç­‰ä½çº§é”™è¯¯</li><li>èŠ‚çœå›¢é˜Ÿæˆå‘˜ review ä½ ä»£ç çš„æ—¶é—´ï¼Œæé«˜åä½œæ•ˆç‡</li><li>é…ç½®ç®€å•ï¼Œä»…éœ€å‡ æ­¥å³å¯ä¸Šæ‰‹</li></ul><h3 id=flake8-ä½¿ç”¨ç¤ºä¾‹><a href=#flake8-ä½¿ç”¨ç¤ºä¾‹ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:flake8-ä½¿ç”¨ç¤ºä¾‹ class=headings><code>flake8</code> ä½¿ç”¨ç¤ºä¾‹</a></h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»¥ Python ä¸­çš„ <code>flake8</code> ä¸ºä¾‹ï¼Œä»‹ç»å…¶ç”¨æ³•ã€‚</p><p>é¦–å…ˆé€šè¿‡ <code>pip</code> å®‰è£… <code>flake8</code>:</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pip install flake8
</span></span></code></pre></td></tr></table></div></div></div><p><code>flake8</code> çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œç›´æ¥ä»¥éœ€è¦æ£€æŸ¥çš„æ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•çš„è·¯å¾„ä½œä¸º <code>flake8</code> å‘½ä»¤çš„å‚æ•°ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ flake8 .  <span class=c1># æ£€æŸ¥å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>./__init__.py:4:1: E402 module level import not at top of file
</span></span><span class=line><span class=cl>./__init__.py:4:1: F401 <span class=s1>&#39;.md_toc.main&#39;</span> imported but unused
</span></span><span class=line><span class=cl>./__init__.py:4:25: W292 no newline at end of file
</span></span><span class=line><span class=cl>./md_toc.py:6:18: E999 SyntaxError: non-default argument follows default argument
</span></span><span class=line><span class=cl>./md_toc.py:28:80: E501 line too long <span class=o>(</span><span class=m>108</span> &gt; <span class=m>79</span> characters<span class=o>)</span>
</span></span><span class=line><span class=cl>./md_toc.py:48:80: E501 line too long <span class=o>(</span><span class=m>113</span> &gt; <span class=m>79</span> characters<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div></div><p>åœ¨è¿è¡Œç»“æœä¸­ï¼Œ <code>flake8</code> ä¸ä»…æŒ‡å‡ºäº†å…·ä½“çš„é”™è¯¯åŸå› ï¼Œè¿˜ç»™å‡ºäº†å‡ºé”™çš„æ–‡ä»¶ä½ç½®åŠä»£ç æ‰€åœ¨è¡Œæ•°ã€‚</p><p>æ›´å¤šå…¶ä»–çš„é€‰é¡¹å¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–å¸®åŠ©ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ flake8 --help
</span></span></code></pre></td></tr></table></div></div></div><p><code>flake8</code> çš„å¯è‡ªå®šä¹‰ç¨‹åº¦å¾ˆé«˜ï¼Œé™¤äº†åœ¨è¿è¡Œæ—¶æ·»åŠ å‘½ä»¤é€‰é¡¹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æ¥è‡ªå®šä¹‰æ£€æŸ¥è§„åˆ™ã€‚æ–¹æ³•æ˜¯åœ¨è¿è¡Œ <code>flake8</code> çš„é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  <code>.flake8</code> æ–‡ä»¶ï¼Œå¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[flake8]</span>
</span></span><span class=line><span class=cl><span class=na>max-line-length</span> <span class=o>=</span> <span class=s>120      # é€‚å½“æé«˜æœ€å¤§è¡Œé•¿åº¦</span>
</span></span><span class=line><span class=cl><span class=na>max-complexity</span> <span class=o>=</span> <span class=s>24        # è®¾ç½®æœ€å¤§å¤æ‚åº¦ä¸º24</span>
</span></span><span class=line><span class=cl><span class=na>ignore</span> <span class=o>=</span> <span class=s>F401, W503, E203  # å¿½ç•¥è¿™äº›é”™è¯¯ç±»å‹</span>
</span></span><span class=line><span class=cl><span class=na>exclude</span> <span class=o>=</span>                  <span class=s># å¿½ç•¥ä»¥ä¸‹æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=s>    .git,
</span></span></span><span class=line><span class=cl><span class=s>    __pycache__,
</span></span></span><span class=line><span class=cl><span class=s>    scripts,
</span></span></span><span class=line><span class=cl><span class=s>    logs,
</span></span></span><span class=line><span class=cl><span class=s>    upload,
</span></span></span><span class=line><span class=cl><span class=s>    build,
</span></span></span><span class=line><span class=cl><span class=s>    dist,
</span></span></span><span class=line><span class=cl><span class=s>    docs,
</span></span></span><span class=line><span class=cl><span class=s>    migrations</span>
</span></span></code></pre></td></tr></table></div></div></div><p><code>flake8</code> è¿˜å¯ä»¥æ·»åŠ æ’ä»¶å®ç°æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³å¼ºåˆ¶è¦æ±‚ç¼–å†™å‡½æ•° <code>docstring</code>ï¼Œå¯ä»¥å®‰è£… <code>flake8-docstrings</code> :</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pip install flake8-docstrings
</span></span></code></pre></td></tr></table></div></div></div><p>é‡æ–°è¿è¡Œæ£€æŸ¥åï¼Œä¼šå‘ç°ç»“æœä¸­å¤šå‡ºäº†å¦‚ä¸‹é”™è¯¯ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./__init__.py:1:1: D104 Missing docstring in public package
</span></span><span class=line><span class=cl>./md_toc.py:6:1: D103 Missing docstring in public <span class=k>function</span>
</span></span></code></pre></td></tr></table></div></div></div><p>æ›´å¤šå…¶ä»–åŠŸèƒ½å’Œæ’ä»¶å¯æŸ¥çœ‹ <code>flake8</code> çš„<a href=https://flake8.pycqa.org/en/latest/index.html target=_blank rel=noopener>æ–‡æ¡£</a>ã€‚</p><p>é™¤äº† <code>flake8</code> ä»¥å¤–ï¼ŒPython è¿˜æœ‰ä»¥ä¸‹ Linter å¯ä¾›é€‰æ‹©ï¼Œå®ƒä»¬çš„ç”¨æ³•å¤§åŒå°å¼‚ï¼Œä½†åœ¨æ£€æŸ¥èŒƒå›´ã€å®¹å¿åº¦ç­‰æ–¹é¢æœ‰æ‰€åŒºåˆ«ï¼š</p><ul><li><a href=https://github.com/PyCQA/pylint target=_blank rel=noopener>Pylint</a></li><li><a href=https://github.com/PyCQA/pyflakes target=_blank rel=noopener>Pyflakes</a></li><li><a href=https://pypi.python.org/pypi/PyChecker target=_blank rel=noopener>Pychecker</a></li><li><a href=https://pypi.python.org/pypi/pep8 target=_blank rel=noopener>Pep8</a></li></ul><h2 id=static-type-checker><a href=#static-type-checker class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:static-type-checker class=headings>Static Type Checker</a></h2><p>Python ä» <a href=https://www.python.org/dev/peps/pep-0484/ target=_blank rel=noopener>PEP 484</a> å¼•å…¥ <code>Type Hints</code> ï¼ˆç±»å‹æç¤ºï¼‰ä»¥æ¥ï¼Œé…å¥—çš„å·¥å…·é“¾ç”Ÿæ€ä¹Ÿåœ¨é€æ¸æˆç†Ÿï¼Œå‡ºç°äº†å¦‚ <code>mypy</code>ã€ <code>pyright</code> ç­‰é™æ€ç±»å‹æ£€æŸ¥å·¥å…·ã€‚</p><p>å®ƒä»¬å¯ä»¥æ ¹æ® Python ä»£ç ä¸­çš„ç±»å‹æç¤ºè¿›è¡Œé™æ€ç±»å‹æ£€æŸ¥ï¼Œä¸éœ€è¦è¿è¡Œç¨‹åºå°±å¯ä»¥æ‰¾åˆ°ç¨‹åºä¸­çš„é”™è¯¯ã€‚è€Œä¸”å¦‚æœæœ‰é—ç•™ä»£ç ä¸å¥½å¤„ç†ï¼Œè¿˜å¯ä»¥åœ¨ç¨‹åºä¸­æ··åˆä½¿ç”¨åŠ¨æ€å’Œé™æ€ç±»å‹ã€‚</p><p>æˆ‘ä»¬ä»¥ <code>mypy</code> åšç®€å•ç¤ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ä»£ç ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># test_mypy.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>greeting</span><span class=p>(</span><span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;Hello &#39;</span> <span class=o>+</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>greeting</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div><p>é€šè¿‡ <code>pip</code> å®‰è£… <code>mypy</code> :</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pip install mypy
</span></span></code></pre></td></tr></table></div></div></div><p>å¯¹è¯¥æ–‡ä»¶è¿è¡Œæ£€æŸ¥ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mypy test_mypy.py
</span></span><span class=line><span class=cl>test_mypy.py:4: error: Argument <span class=m>1</span> to <span class=s2>&#34;greeting&#34;</span> has incompatible <span class=nb>type</span> <span class=s2>&#34;int&#34;</span><span class=p>;</span> expected <span class=s2>&#34;str&#34;</span>
</span></span><span class=line><span class=cl>Found <span class=m>1</span> error in <span class=m>1</span> file <span class=o>(</span>checked <span class=m>1</span> <span class=nb>source</span> file<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div></div><p>åœ¨æ£€æŸ¥ç»“æœä¸­ï¼Œ <code>mypy</code> æç¤ºæˆ‘ä»¬åœ¨è°ƒç”¨ <code>greeting()</code> æ—¶ä¼ å…¥çš„å‚æ•°ç±»å‹å‡ºé”™ã€‚</p><h3 id=ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„><a href=#ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„ class=headings>ç±»å‹æç¤ºå¸¦æ¥çš„å¥½å¤„</a></h3><p>é™æ€ç±»å‹æ£€æŸ¥å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬åƒé™æ€è¯­è¨€ä¸€æ ·åœ¨è¿è¡Œä»£ç ä¹‹å‰å°±æ•è·åˆ°æŸäº›é”™è¯¯ï¼Œä½†éœ€è¦æˆ‘ä»¬åœ¨ç¨‹åºä¸­åŠ å…¥å¤§é‡çš„ç±»å‹æç¤ºæ‰èƒ½å®Œæ•´å‘æŒ¥å…¶ä½œç”¨ã€‚è™½ç„¶ç¨å¾®åŠ å¤§äº†å·¥ä½œé‡ï¼Œä½†å¼•å…¥ç±»å‹æç¤ºè¿˜ä¼šå¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š</p><ul><li>ç›¸æ¯”ä¼ ç»Ÿçš„Â <a href="https://link.zhihu.com/?target=https%3A//realpython.com/documenting-python-code/" target=_blank rel=noopener>docstrings</a>ï¼Œç±»å‹æç¤ºé…åˆè‰¯å¥½çš„å‘½åæ—¢èƒ½ä½œä¸ºè§£é‡Šæ–‡æ¡£ï¼Œä¹Ÿèƒ½ç”¨äºè‡ªåŠ¨æ£€æŸ¥ã€‚</li><li>å¯ä»¥ä½¿ IDE é€šè¿‡ç±»å‹æ¨æ–­æä¾›æ›´å¥½çš„ä»£ç è¡¥å…¨å’Œæç¤ºåŠŸèƒ½ã€‚</li><li>å¼ºåˆ¶ä½ å»æ€è€ƒåŠ¨æ€è¯­è¨€ç¨‹åºçš„ç±»å‹å¯èƒ½ä¼šå¸®åŠ©ä½ æ„å»ºæ›´æ¸…æ™°çš„ä»£ç æ¶æ„ã€‚</li></ul><h2 id=autoformatter><a href=#autoformatter class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:autoformatter class=headings>Autoformatter</a></h2><p>Autoformatter ï¼ˆè‡ªåŠ¨æ ¼å¼åŒ–å™¨ï¼‰é¡¾åæ€ä¹‰æ˜¯å¯ä»¥å°†ä»£ç æŒ‰ç‰¹å®šè§„åˆ™è‡ªåŠ¨æ ¼å¼åŒ–çš„ä¸€ç±»å·¥å…·ã€‚Linter å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘ç°ä»£ç ä¸­çš„æ ¼å¼é”™è¯¯å’Œé£æ ¼é—®é¢˜ï¼Œä½†å¹¶ä¸ä¼šè‡ªåŠ¨çº æ­£ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å€ŸåŠ©è‡ªåŠ¨æ ¼å¼åŒ–å™¨ï¼Œè¿›ä¸€æ­¥å°†æˆ‘ä»¬ä»é‡å¤çç¢çš„æ‰‹åŠ¨ä¿®æ”¹ä¸­è§£æ”¾å‡ºæ¥ã€‚</p><p>Python ä¸­æœ‰ <code>black</code> ã€ <code>yapf</code>ã€ <code>autopep8</code>ã€ <code>isort</code> ç­‰ä¼—å¤šæ ¼å¼åŒ–å·¥å…·ï¼Œé™¤äº†æ•´ä½“ä¸Šéµå¾ª PEP8 ä»¥å¤–ï¼Œå„è‡ªéƒ½æœ‰ä¸åŒçš„é£æ ¼è§„èŒƒå’Œé€‚ç”¨èŒƒå›´ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½è¿›è¡Œé€‰æ‹©ã€‚</p><p>ä»¥ <code>black</code> å’Œä¸‹é¢è¿™æ®µä»£ç ä¸ºä¾‹ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># test_black.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span>  <span class=p>(</span>   <span class=n>a</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span> <span class=nb>int</span> <span class=p>])</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span>      <span class=mi>37</span><span class=o>-</span><span class=n>a</span><span class=p>[</span><span class=mi>42</span><span class=o>-</span><span class=n>u</span> <span class=p>:</span>  <span class=n>y</span><span class=o>**</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>very_important_function</span><span class=p>(</span><span class=n>template</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span><span class=o>*</span><span class=n>variables</span><span class=p>,</span><span class=n>file</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>PathLike</span><span class=p>,</span><span class=n>debug</span><span class=p>:</span><span class=nb>bool</span><span class=o>=</span><span class=kc>False</span><span class=p>,):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Applies `variables` to the `template` and writes to `file`.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div></div><p>é¦–å…ˆé€šè¿‡ <code>pip</code> å®‰è£… <code>black</code>ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pip install black
</span></span></code></pre></td></tr></table></div></div></div><p>ç„¶åå¯¹éœ€è¦æ ¼å¼åŒ–çš„æ–‡ä»¶æˆ–æ•´ä¸ªç›®å½•çš„è·¯å¾„æ‰§è¡Œ <code>black</code> å‘½ä»¤ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ black test_black.py
</span></span><span class=line><span class=cl>reformatted /Users/waynerv/Repos/github-markdown-toc/gfm_toc/__init__.py
</span></span><span class=line><span class=cl>reformatted /Users/waynerv/Repos/github-markdown-toc/gfm_toc/md_toc.py
</span></span><span class=line><span class=cl>All <span class=k>done</span>! âœ¨ ğŸ° âœ¨
</span></span><span class=line><span class=cl><span class=m>2</span> files reformatted.
</span></span></code></pre></td></tr></table></div></div></div><p><code>black</code> ä¼šé¦–å…ˆæ£€æŸ¥å‡ºä¸ç¬¦åˆå…¶è§„èŒƒçš„æ–‡ä»¶ï¼Œç„¶åç¼–è¾‘æ–‡ä»¶å®Œæˆä¿®æ”¹ï¼Œå¹¶è¾“å‡ºä¿®æ”¹çš„æ–‡ä»¶è·¯å¾„åŠæ•°é‡ã€‚æ ¼å¼åŒ–åçš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># test_black.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>a</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>37</span> <span class=o>-</span> <span class=n>a</span><span class=p>[</span><span class=mi>42</span> <span class=o>-</span> <span class=n>u</span> <span class=p>:</span> <span class=n>y</span> <span class=o>**</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>very_important_function</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>template</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>variables</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>PathLike</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>debug</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Applies `variables` to the `template` and writes to `file`.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div></div><p><code>black</code> å·ç§°ã€Œä¸å¦¥åçš„ä»£ç æ ¼å¼åŒ–å™¨ã€ï¼Œå…¶ä¸å¦¥åä½“ç°åœ¨åŸºæœ¬æ²¡æœ‰å¯ä¾›è‡ªå®šä¹‰çš„é€‰é¡¹ï¼Œè¦ä¹ˆå…¨ç›˜æ¥å—å®ƒçš„ä»£ç é£æ ¼ï¼Œè¦ä¹ˆå°±ä¸ç”¨å®ƒã€‚å¦‚æœä½ æˆ–è€…ä½ çš„å›¢é˜Ÿèƒ½å¤Ÿæ¥å—å®ƒçš„é£æ ¼ï¼Œä½¿ç”¨ <code>black</code> å¯ä»¥èŠ‚çœå¾ˆå¤šèŠ±åœ¨ä»£ç é£æ ¼ä¸Šçš„ç²¾åŠ›å’Œæ—¶é—´ï¼ˆå†ä¹Ÿä¸ç”¨äº‰è®ºæŸç§é£æ ¼å­°ä¼˜å­°åŠ£äº†ï¼‰ã€‚</p><p>å®è·µä¸­æˆ‘ä»¬å¯ä»¥å¯¹æœ€å¤§è¡Œé•¿åº¦ä»¥åŠå¼•å·æ ¼å¼åŒ–é€‰é¡¹åšä¸€äº›è°ƒæ•´ï¼Œæ–¹æ³•æ˜¯åœ¨æ‰§è¡Œ <code>black</code> çš„é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  <code>pyproject.tomal</code> æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹:</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[tool.black]</span>
</span></span><span class=line><span class=cl><span class=na>line-length</span> <span class=o>=</span> <span class=s>120</span>
</span></span><span class=line><span class=cl><span class=na>skip-string-normalization</span> <span class=o>=</span> <span class=s>true</span>
</span></span></code></pre></td></tr></table></div></div></div><h3 id=ide-çš„è‡ªå¸¦å·¥å…·><a href=#ide-çš„è‡ªå¸¦å·¥å…· class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:ide-çš„è‡ªå¸¦å·¥å…· class=headings>IDE çš„è‡ªå¸¦å·¥å…·</a></h3><p>ç°ä»£çš„ IDE å’Œç¼–è¾‘å™¨åŸºæœ¬éƒ½ä¼šè‡ªå¸¦ Linter å’Œæ ¼å¼åŒ–ç­‰åŠŸèƒ½ï¼Œæ¯”å¦‚ <code>PyCharm</code> å°±å¯ä»¥é€šè¿‡ <code>âŒ¥ âŒ˜ L</code> å¿«æ·é”®æ ¼å¼åŒ–å½“å‰æ–‡ä»¶çš„ä»£ç ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬è¿˜æœ‰å¿…è¦æ‰‹åŠ¨é›†æˆè¿™äº›ç¬¬ä¸‰æ–¹å·¥å…·å—ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯æœ‰å¿…è¦ï¼Œæˆ‘ä»¬ä»¥ç¬¬ä¸‰æ–¹å’Œ IDE è‡ªå¸¦çš„ä»£ç å·¥å…·ä½œå¯¹æ¯”ï¼š</p><ul><li>è‡ªå¸¦å·¥å…·å¯¹ç¯å¢ƒä¾èµ–ç¨‹åº¦å¾ˆé«˜ï¼Œå¿…é¡»è¦æœ‰ç‰¹å®šçš„äºŒè¿›åˆ¶åŒ…åŠé…ç½®æ–‡ä»¶æ‰èƒ½æ‰§è¡Œï¼›è€Œä½¿ç”¨ä¸é¡¹ç›®ç›¸åŒè¯­è¨€å®ç°çš„ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼Œé…ç½®ä¹Ÿèƒ½å¾ˆæ–¹ä¾¿åœ°æ•´åˆåˆ°é¡¹ç›®æœ¬èº«çš„é…ç½®æ–‡ä»¶ä¸­ï¼ˆå¦‚<code>pyproject.toml</code>ã€<code>tox.ini</code>ç­‰ï¼‰ï¼Œä¸”é€šå¸¸éƒ½å¯ä»¥å¾ˆå¿«åœ°é›†æˆåˆ°ä¸åŒ IDE ä¸­ã€‚</li><li>è‡ªå¸¦å·¥å…·åªèƒ½åœ¨ IDE çš„å›¾å½¢ç•Œé¢ä¸­æ‰‹åŠ¨æ‰§è¡Œï¼›è€Œç¬¬ä¸‰æ–¹å·¥å…·åªè¦æœ‰åŸºç¡€çš„ä»£ç è¿è¡Œç¯å¢ƒå°±å¯ä»¥æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬å¾ˆæ–¹ä¾¿çš„é›†æˆåˆ° Hooksã€CI ä¸­è‡ªåŠ¨åŒ–æ‰§è¡Œã€‚</li><li>è‡ªå¸¦å·¥å…·å¹¶ä¸ä¸€å®šä¸¥æ ¼éµå¾ª PEP8 ç­‰é€šç”¨è§„èŒƒï¼Œè€Œä¸”ä¸æ–¹ä¾¿åœ¨åä½œæˆå‘˜ä¸­åˆ†äº«é…ç½®ï¼Œè¯è¯´å›æ¥ï¼Œå‡å¦‚ä½ ç”¨ <code>PyCharm</code> ä½†ä½ çš„åŒäº‹ç”¨ <code>VSCode</code> å‘¢ï¼Ÿ</li></ul><p>åœ¨æ¥ä¸‹æ¥çš„ Hooks å’Œ Pipeline ä¸¤èŠ‚å†…å®¹ä¸­ï¼Œä½ å°†è¿›ä¸€æ­¥è®¤è¯†åˆ°é›†æˆç¬¬ä¸‰æ–¹å·¥å…·å¸¦æ¥çš„ä¼˜åŠ¿ã€‚</p><h2 id=hooks><a href=#hooks class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:hooks class=headings>Hooks</a></h2><p>åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬ä»‹ç»äº†å¾ˆå¤šä¿éšœè´¨é‡çš„å·¥å…·ï¼Œä½†åœ¨æ—¥å¸¸ç¼–ç ä¸­ï¼Œæˆ‘ä»¬æ€»ä¸èƒ½æ¯ä¸€æ¬¡æäº¤ä»£ç å‰ï¼Œéƒ½æŠŠè¿™äº›å·¥å…·æ‰‹åŠ¨æ‰§è¡Œä¸€éå§ï¼Ÿè¿™çœ‹ä¸Šå»ä¸æ˜¯é«˜æ•ˆçš„åšæ³•ï¼Œåº†å¹¸åœ°æ˜¯æˆ‘ä»¬æœ‰ç°æˆé€”å¾„è§£å†³è¿™äº›é—®é¢˜ã€‚</p><h3 id=git-hooks><a href=#git-hooks class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:git-hooks class=headings>Git Hooks</a></h3><p>Git å¯ä»¥åœ¨ä»“åº“ä¸­å‘ç”Ÿç‰¹å®šäº‹ä»¶æ—¶è‡ªåŠ¨è¿è¡Œè‡ªå®šä¹‰çš„è„šæœ¬ï¼Œè¿™äº›è‡ªå®šä¹‰è„šæœ¬å³ç§°ä¸º <code>hooks</code>ã€‚ å®ƒä»¬è®©ä½ å¯ä»¥åœ¨å¼€å‘å‘¨æœŸçš„å…³é”®ç‚¹è§¦å‘å¯å®šåˆ¶çš„åŠ¨ä½œï¼Œæ¯”å¦‚æ¯æ¬¡æ‰§è¡Œæäº¤å‰éƒ½æ‰§è¡Œä¸€æ¬¡ <code>flake8</code> å‘½ä»¤ã€‚å¤§éƒ¨åˆ†å…¶ä»–çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¹Ÿä¼šæä¾›ç±»ä¼¼çš„åŠŸèƒ½ã€‚</p><p><code>hooks</code> ä¿å­˜åœ¨ Git ä»“åº“çš„ <code>.git/hooks</code> ç›®å½•ä¸­ï¼Œå®ƒå¯ä»¥æ˜¯æ™®é€šçš„ shell è„šæœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯ Pythonã€Ruby ç­‰è¯­è¨€çš„å¯æ‰§è¡Œè„šæœ¬ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†å¸¸ç”¨å·¥å…·é›†æˆåˆ° <code>hooks</code> ä¸­ã€‚ <code>hooks</code> é€šå¸¸æŒ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå¸¸ç”¨çš„å®¢æˆ·ç«¯ç±»æœ‰ <code>pre-commit</code> ã€ <code>prepare-commit-msg</code>ã€ <code>commit-msg</code>ã€ <code>post-commit</code>ã€ <code>pre-rebase</code> ç­‰ <code>hooks</code>ï¼Œå®ƒä»¬åˆ†åˆ«åœ¨åç§°æ‰€ä»£è¡¨çš„äº‹ä»¶è§¦å‘æ—¶è¿è¡Œã€‚</p><p>ä»¥ <code>pre-commit</code> ä¸ºä¾‹ï¼Œè¯¥ <code>hooks</code> åœ¨è¾“å…¥æäº¤ä¿¡æ¯å‰è¿è¡Œã€‚ å®ƒå¯ä»¥æ£€æŸ¥å³å°†æäº¤çš„å¿«ç…§ï¼Œå¦‚æœè¯¥ <code>hooks</code> ä»¥éé›¶å€¼é€€å‡ºï¼ŒGit å°†æ”¾å¼ƒæ­¤æ¬¡æäº¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥æ£€æŸ¥æäº¤çš„ä»£ç é£æ ¼æ˜¯å¦æ­£ç¡®ï¼ˆè¿è¡Œä¾‹å¦‚ <code>flake8</code>ã€ <code>black</code> ç­‰ç¨‹åºï¼‰ã€æ˜¯å¦å¼•å…¥å®‰å…¨é£é™©ç­‰ç­‰ã€‚æ•´ä¸ªæµç¨‹ç¤ºæ„å¦‚ä¸‹ï¼š</p><p><img src=2020-01-04-pre-commit-workflow.png alt=2020-01-04-pre-commit-workflow></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å±•ç¤ºï¼Œå¦‚ä½•å°†ä¸Šæ–‡ä»‹ç»çš„ä¼—å¤šå·¥å…·å¿«é€Ÿåœ°é›†æˆåˆ° <code>pre-commit hooks</code> ä¸­ã€‚</p><h3 id=pre-commit><a href=#pre-commit class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:pre-commit class=headings>pre-commit</a></h3><p><code>pre-commit</code> æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å’Œç»´æŠ¤å¤šç§è¯­è¨€ <code>pre-commit hooks</code> çš„æ¡†æ¶ï¼Œå°±åƒ Python çš„åŒ…ç®¡ç†å™¨ <code>pip</code> ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>pre-commit</code> å°†ä»–äººåˆ›å»ºå¹¶åˆ†äº«çš„ <code>pre-commit hooks</code> å®‰è£…åˆ°è‡ªå·±çš„é¡¹ç›®ä»“åº“ä¸­ã€‚ <code>pre-commit</code> å¤§å¤§å‡å°‘äº†æˆ‘ä»¬ä½¿ç”¨ <code>git hooks</code> çš„éš¾åº¦ï¼Œä½ åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šæƒ³è¦çš„ <code>hooks</code>ï¼Œå®ƒä¼šæ›¿ä½ å®‰è£…ä»»æ„è¯­è¨€ç¼–å†™çš„ <code>hooks</code> å¹¶è§£å†³ç¯å¢ƒä¾èµ–é—®é¢˜ï¼Œç„¶ååœ¨æ¯æ¬¡æäº¤å‰æ‰§è¡Œã€‚</p><p><code>pre-commit</code> çš„ç®€å•ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li><p>é€šè¿‡ <code>pip</code> å®‰è£… <code>pre-commit</code>:</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pip install pre-commit
</span></span></code></pre></td></tr></table></div></div></div><p><code>pre-commit</code> æ˜¯é¢å‘å¤šè¯­è¨€çš„ï¼Œå› æ­¤å®ƒè¿˜æ”¯æŒé€šè¿‡ <code>homebrew</code> ç­‰æ–¹å¼å®‰è£…ã€‚</p></li><li><p>æ·»åŠ é…ç½®æ–‡ä»¶ã€‚</p><p>ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º <code>.pre-commit-config.yml</code> çš„æ–‡ä»¶ï¼Œé€šå¸¸æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æˆ‘ä»¬æŒ‰ç‰¹å®šæ ¼å¼æ·»åŠ éœ€è¦è¿è¡Œçš„ <code>hooks</code> å¹¶æŒ‡å®šå‚æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>repos</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/psf/black</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rev</span><span class=p>:</span><span class=w> </span><span class=m>20.</span><span class=l>8b1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>black</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>language_version</span><span class=p>:</span><span class=w> </span><span class=l>python3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>exclude</span><span class=p>:</span><span class=w> </span><span class=l>^migrations/|^uploads/|^scripts/|^logs/|^docs/|^dist/|^build/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/pycqa/flake8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rev</span><span class=p>:</span><span class=w> </span><span class=m>3.8.4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>flake8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>exclude</span><span class=p>:</span><span class=w> </span><span class=l>^migrations/|^uploads/|^scripts/|^logs/|^docs/|^dist/|^build/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/pre-commit/pre-commit-hooks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rev</span><span class=p>:</span><span class=w> </span><span class=l>v3.3.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>hooks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>check-added-large-files</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span>--<span class=l>maxkb=512 ]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></div><p>åœ¨è¯¥ç¤ºä¾‹æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº† <code>black</code> ã€ <code>flake8</code> ä»¥åŠä¸€ä¸ªæ£€æŸ¥æ˜¯å¦æ·»åŠ äº†å¤§ä½“ç§¯æ–‡ä»¶åˆ° Git çš„ <code>hooks</code>ï¼Œè¿˜åˆ†åˆ«æŒ‡å®šäº†è¯­è¨€ç‰ˆæœ¬ã€è·³è¿‡æ£€æŸ¥è·¯å¾„ç­‰é€‰é¡¹ã€‚</p><p>é…ç½®æ–‡ä»¶çš„é€‰é¡¹å«ä¹‰å‚è§ <a href=https://pre-commit.com/#plugins target=_blank rel=noopener>https://pre-commit.com/#plugins</a>ï¼Œæ‰€æœ‰æ”¯æŒå®‰è£…çš„ <code>hooks</code> åˆ—è¡¨å‚è§<a href=https://pre-commit.com/hooks.html target=_blank rel=noopener>https://pre-commit.com/hooks.html</a>ã€‚</p></li><li><p>å®‰è£… <code>git hook</code> è„šæœ¬ã€‚åœ¨é…ç½®æ–‡ä»¶æ‰€åœ¨çš„æ ¹ç›®å½•è¿è¡Œå‘½ä»¤ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pre-commit install
</span></span><span class=line><span class=cl>pre-commit installed at .git/hooks/pre-commit
</span></span></code></pre></td></tr></table></div></div></div><p>è¿™ä¼šåœ¨ <code>.git/hooks</code> æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª <code>pre-commit</code> è„šæœ¬æ–‡ä»¶ï¼Œå¹¶åœ¨æ¥ä¸‹æ¥ä½ æ¯ä¸€æ¬¡æäº¤ä¹‹å‰è¿è¡Œï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥å°è¯•æäº¤ä¸€æ¬¡ä»£ç äº†ã€‚</p></li><li><p>ï¼ˆå¯é€‰æ­¥éª¤ï¼‰å¯¹æ‰€æœ‰æ–‡ä»¶è¿è¡Œ <code>hooks</code>ã€‚</p><p>é€šå¸¸ <code>pre-commit</code> åªä¼šåœ¨è§¦å‘ <code>git hooks</code> æ—¶å¯¹å‘ç”Ÿæ›´æ”¹çš„æ–‡ä»¶è¿è¡Œï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¯¹å½“å‰ä»“åº“çš„æ‰€æœ‰æ–‡ä»¶è¿è¡Œï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ pre-commit run --all-files
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Initializing environment <span class=k>for</span> https://github.com/psf/black.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Initializing environment <span class=k>for</span> https://github.com/pycqa/flake8.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Initializing environment <span class=k>for</span> https://github.com/pre-commit/pre-commit-hooks.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Installing environment <span class=k>for</span> https://github.com/psf/black.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Once installed this environment will be reused.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> This may take a few minutes...
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Installing environment <span class=k>for</span> https://github.com/pycqa/flake8.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Once installed this environment will be reused.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> This may take a few minutes...
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Installing environment <span class=k>for</span> https://github.com/pre-commit/pre-commit-hooks.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Once installed this environment will be reused.
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> This may take a few minutes...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>black....................................................................Failed
</span></span><span class=line><span class=cl>- hook id: black
</span></span><span class=line><span class=cl>- files were modified by this hook
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>reformatted /.../setup.py
</span></span><span class=line><span class=cl>reformatted /.../test/generate_toc_test.py
</span></span><span class=line><span class=cl>All <span class=k>done</span>! âœ¨ ğŸ° âœ¨
</span></span><span class=line><span class=cl><span class=m>2</span> files reformatted, <span class=m>2</span> files left unchanged.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>flake8...................................................................Passed
</span></span><span class=line><span class=cl>Check <span class=k>for</span> added large files..............................................Passed
</span></span></code></pre></td></tr></table></div></div></div><p>ç»“æœæ˜¾ç¤ºæˆ‘ä»¬æœ‰æ–‡ä»¶æœªé€šè¿‡ <code>black</code> æ£€æŸ¥ï¼Œä½† <code>black</code> åŒæ—¶ä¹Ÿå¸®æˆ‘ä»¬è‡ªåŠ¨è¿›è¡Œäº†æ ¼å¼åŒ–ï¼Œå› æ­¤åªéœ€è¦æš‚å­˜å¹¶é‡æ–°æäº¤è¿™äº›æ–‡ä»¶å³å¯ã€‚</p></li></ol><h3 id=pre-commit-hooks-çš„é™åˆ¶><a href=#pre-commit-hooks-çš„é™åˆ¶ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:pre-commit-hooks-çš„é™åˆ¶ class=headings><code>pre-commit hooks</code> çš„é™åˆ¶</a></h3><p>ä½¿ç”¨ <code>pre-commit</code> ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ä¸°å¯Œå¤šæ ·çš„ä»£ç å·¥å…·é›†æˆåˆ° Git çš„å·¥ä½œæµä¸­ï¼Œè¿™å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜äº†æˆ‘ä»¬çš„æ•ˆç‡ï¼Œä½† <code>pre-commit hooks</code> æœ¬èº«å­˜åœ¨ä»¥ä¸‹é™åˆ¶ï¼š</p><ul><li>å®¢æˆ·ç«¯ <code>hooks</code> å¹¶ä¸ä¼šéšä»£ç åº“ä¸€èµ·è¢«å¤åˆ¶ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æœ¬åœ°ä»“åº“é€šè¿‡ <code>pre-commit install</code> æ‰§è¡Œå®‰è£…ä¹‹å <code>hooks</code> æ‰ä¼šç”Ÿæ•ˆã€‚</li><li>ä½¿ç”¨ <code>git commit --no-verify</code> å³å¯ç»•è¿‡æ‰€æœ‰çš„ <code>pre-commit hooks</code>ã€‚</li></ul><p><code>pre-commit</code> è§£å†³äº†åœ¨æœ¬åœ°é›†æˆä»£ç å·¥å…·çš„é—®é¢˜ï¼Œä½†åœ¨å›¢é˜Ÿåˆä½œçš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ç§æœºåˆ¶å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯å¯¹æ‰€æœ‰æˆå‘˜æ¨é€çš„ä»£ç è¿›è¡Œæ£€æŸ¥ï¼Œæ–½åŠ ç‰¹å®šçš„çº¦æŸï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° Pipelines äº†ã€‚</p><h2 id=pipelines><a href=#pipelines class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:pipelines class=headings>Pipelines</a></h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ CI/CD è¿™ä¸€æ¦‚å¿µã€‚</p><h3 id=cicd><a href=#cicd class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:cicd class=headings>CI/CD</a></h3><p>CIï¼ˆContinuous Integrationï¼ŒæŒç»­é›†æˆï¼‰æ˜¯ä¸€ç§è½¯ä»¶å®è·µï¼Œå®ƒè¦æ±‚æˆ‘ä»¬é¢‘ç¹åœ°å‘å…±äº«ä»“åº“æäº¤ä»£ç ã€‚æ›´é¢‘ç¹åœ°æäº¤ä»£ç å¯ä»¥æ›´å¿«åœ°å‘ç°é”™è¯¯ï¼Œå‡å°‘æˆ‘ä»¬åœ¨å‘ç°é”™è¯¯æ—¶éœ€è¦è°ƒè¯•çš„ä»£ç é‡ï¼Œä¹Ÿä½¿å¾—å›¢é˜Ÿä¸åŒæˆå‘˜é—´çš„å˜æ›´æ›´å®¹æ˜“åˆå¹¶ã€‚CI å¯ä»¥èŠ‚çœæˆ‘ä»¬è°ƒè¯•é”™è¯¯æˆ–è§£å†³åˆå¹¶å†²çªçš„æ—¶é—´ï¼Œè®©æˆ‘ä»¬æœ‰æ›´å¤šçš„æ—¶é—´æ¥ç¼–å†™ä»£ç ã€‚</p><p>å½“æäº¤ä»£ç åˆ°å…±äº«ä»“åº“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸€æ¬¡æäº¤çš„ä»£ç è¿›è¡Œæ„å»ºå’Œæµ‹è¯•ï¼Œä»¥ç¡®ä¿æäº¤ä¸ä¼šå¼•å…¥é”™è¯¯ã€‚è¿™äº›æµ‹è¯•æ—¢åŒ…æ‹¬ä¸Šæ–‡æåˆ°çš„ Linterï¼Œä¹ŸåŒ…æ‹¬å®‰å…¨æ€§æ£€æŸ¥ã€æµ‹è¯•è¦†ç›–ç‡ã€åŠŸèƒ½æµ‹è¯•å’Œå…¶ä»–è‡ªå®šä¹‰æ£€æŸ¥ã€‚æˆ‘ä»¬å°†éœ€è¦ä¸€ä¸ª CI æœåŠ¡å™¨ä½œä¸º Runner ä»¥è¿è¡Œå¯¹æäº¤ä»£ç çš„æ„å»ºå’Œæ£€æŸ¥ã€‚</p><p>CDï¼ˆContinuous Deploymentï¼ŒæŒç»­éƒ¨ç½²ï¼‰æ˜¯ CI çš„ä¸‹ä¸€æ­¥ã€‚æˆ‘ä»¬ä¸ä»…åœ¨æ¯æ¬¡æ¨é€ä»£ç åˆ°å…±äº«ä»£ç åº“æ—¶è¿›è¡Œæ„å»ºå’Œæµ‹è¯•ï¼Œè¿˜ä¼šåœ¨ä¸éœ€è¦ä»»ä½•äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨éƒ¨ç½²ä»£ç åˆ°ç”Ÿäº§ç¯å¢ƒã€‚æ­¤å¤–è¿˜æœ‰Continuous Delivery ï¼ˆæŒç»­äº¤ä»˜ï¼‰ï¼Œå®ƒå’ŒæŒç»­éƒ¨ç½²çš„åŒºåˆ«åœ¨äºéœ€è¦äººå·¥å¹²é¢„æ‰ä¼šæ‰§è¡Œéƒ¨ç½²ã€‚</p><h3 id=pipeline><a href=#pipeline class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:pipeline class=headings>Pipeline</a></h3><p>Pipeline æ˜¯æŒç»­é›†æˆã€äº¤ä»˜å’Œéƒ¨ç½²çš„é¡¶å±‚å…·è±¡åŒ–ç»„ä»¶ï¼Œå®ƒç”±é¡ºåºæ‰§è¡Œçš„é˜¶æ®µï¼ˆstageï¼‰ä»¥åŠæ¯ä¸ªé˜¶æ®µä¸­å¹¶è¡Œçš„ä»»åŠ¡ï¼ˆjobï¼‰ç»„æˆã€‚ä¸€ä¸ªç®€å•çš„ pipeline å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=2020-01-04-pipelines.png alt=2020-01-04-pipelines></p><p>é¦–å…ˆå¹¶è¡Œåœ°æ‰§è¡Œ <code>build</code> é˜¶æ®µçš„æ‰€æœ‰ä»»åŠ¡ï¼ˆ<code>build_a</code> å’Œ <code>build_b</code>ï¼‰ï¼Œæ‰€æœ‰ä»»åŠ¡æˆåŠŸåç»§ç»­æ‰§è¡Œä¸‹ä¸€é˜¶æ®µçš„ä»»åŠ¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚pipeline è¿˜èƒ½å®šä¹‰æˆæŒ‰æ›´å¤æ‚çš„é€»è¾‘è§„åˆ™è¿è¡Œã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä»¥ GitLab CI ä¸ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•é…ç½®ä¸€ä¸ª pipelineï¼Œå¹¶åœ¨æµ‹è¯•é˜¶æ®µæ‰§è¡Œä¸Šæ–‡ä»‹ç»çš„æ£€æŸ¥å·¥å…·ï¼Œè§£å†³ä¸èƒ½å¯¹å›¢é˜Ÿæˆå‘˜æäº¤ä»£ç è¿›è¡Œå¼ºåˆ¶çº¦æŸçš„é—®é¢˜ã€‚</p><h3 id=gitlab-ci-ç¤ºä¾‹><a href=#gitlab-ci-ç¤ºä¾‹ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:gitlab-ci-ç¤ºä¾‹ class=headings>GitLab CI ç¤ºä¾‹</a></h3><h4 id=é…ç½®-runner><a href=#é…ç½®-runner class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:é…ç½®-runner class=headings>é…ç½® Runner</a></h4><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸ªè¿è¡Œä»»åŠ¡çš„æœåŠ¡å™¨ä½œä¸º Runnerï¼Œè¿™éœ€è¦æˆ‘ä»¬æœ‰å¯ç”¨çš„æœåŠ¡å™¨ä¸»æœºï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨æœ¬åœ°çš„å¼€å‘æœºå™¨æˆ–è´­ä¹° GitLab æä¾›çš„ Runnerï¼‰ã€‚é…ç½® Runner æ•´ä½“åˆ†ä¸¤æ­¥ï¼š</p><ul><li>åœ¨ä¸»æœºä¸Š<a href=https://docs.gitlab.com/runner/install/ target=_blank rel=noopener>å®‰è£… GitLab Runner</a>ï¼ŒGitLab Runner æ˜¯ä¸€ä¸ªç”¨äº GitLab CI/CD å¹¶åœ¨ä¸»æœºä¸Šç®¡ç†ã€æ‰§è¡Œ pipeline ä»»åŠ¡çš„åº”ç”¨ã€‚å¯¹äºä¸åŒçš„æ“ä½œç³»ç»Ÿä¸æ¶æ„ï¼Œå…·ä½“çš„å®‰è£…æ­¥éª¤ä¹Ÿæœ‰å¾ˆå¤§åŒºåˆ«ï¼Œè¯¦æƒ…å‚è§æ–‡æ¡£ã€‚</li><li>ä¸ºé¡¹ç›®ï¼ˆæˆ–é¡¹ç›®ç»„ï¼‰<a href=https://docs.gitlab.com/runner/register/ target=_blank rel=noopener>æ³¨å†Œ Runner</a>ã€‚è¿™ä¸€æ­¥é¦–å…ˆéœ€è¦ä» GitLab é¡¹ç›®ä¸»é¡µçš„ <strong>Settings > CI/CD</strong> <strong>> Runners settings</strong> è·å–é¡¹ç›®çš„ URL å’Œæ³¨å†Œä»¤ç‰Œï¼Œç„¶ååœ¨ Runner æ‰€åœ¨çš„æœºå™¨è¿è¡Œ <code>register</code> å‘½ä»¤ä½¿ç”¨ URL å’Œä»¤ç‰Œå®Œæˆæ³¨å†Œï¼Œå¹¶é€‰æ‹©åˆé€‚çš„ Runner ç±»å‹ï¼Œè¯¦ç»†æ­¥éª¤å‚è§æ–‡æ¡£ã€‚</li></ul><p>é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬å°†å¯ä»¥åœ¨ <strong>Runners settings</strong> é¡µé¢æŸ¥çœ‹å¯ç”¨çš„ Runner å’ŒçŠ¶æ€ï¼š</p><p><img src=2020-01-04-runner-status.png alt=2020-01-04-runner-status></p><h4 id=åˆ›å»º-gitlabyml><a href=#åˆ›å»º-gitlabyml class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:åˆ›å»º-gitlabyml class=headings>åˆ›å»º <code>.gitlab.yml</code></a></h4><p>æˆ‘ä»¬å°†åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªé…ç½® pipeline çš„ <code>.gitlab.yml</code> æ–‡ä»¶ï¼ŒGitLab å°†åœ¨æ¯ä¸€æ¬¡æˆ‘ä»¬æ¨é€ä»£ç åˆ°å…±äº«ä»“åº“æ—¶ï¼Œè¯»å–è¯¥æ–‡ä»¶ä¸­çš„å®šä¹‰å’ŒæŒ‡ä»¤ï¼Œåˆ›å»ºä¸€æ¡ä¸åŒé˜¶æ®µåŠä»»åŠ¡ç»„æˆçš„ pipelineï¼Œå¹¶å°†é˜¶æ®µä¸­çš„ä»»åŠ¡æ´¾å‘ç»™å¯ç”¨çš„ Runner æ‰§è¡Œã€‚æˆ‘ä»¬ä»¥å¦‚ä¸‹ <code>.gitlab.yml</code> æ–‡ä»¶ä¸ºä¾‹ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>before_script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>python --version</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>pip install -r requirements-ci.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>Pre-commit Hooks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>Static Analysis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>pre-commit</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>Pre-commit Hooks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>variables</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>PRE_COMMIT_HOME</span><span class=p>:</span><span class=w> </span><span class=l>${CI_PROJECT_DIR}/.cache/pre-commit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cache</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>20201116dash</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>${PRE_COMMIT_HOME}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pre-commit run --all-files</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>mypy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>Static Analysis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>allow_failure</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>refs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pwd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>ls -l</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>python -m mypy app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>flake8</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>Static Analysis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pwd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>python -m flake8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>git-lint</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>Static Analysis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>git log -1 --pretty=%B | gitlint --contrib=CT1 --ignore=body-is-missing</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></div><p>åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ï¼š</p><ul><li>Runner åº”è¯¥æ‰§è¡Œçš„ä»»åŠ¡çš„ç»“æ„å’Œé¡ºåºã€‚</li><li>é‡åˆ°ç‰¹å®šæ¡ä»¶æ—¶ï¼ŒRunner åº”åšå‡ºçš„å†³å®šã€‚</li></ul><p>ä¸Šé¢çš„ç¤ºä¾‹å®šä¹‰äº†å¦‚ä¸‹ pipelineï¼š</p><p><img src=2020-01-04-pipeline-graph.png alt=2020-01-04-pipeline-graph></p><ul><li><code>before_script</code>å…³é”®å­—å®šä¹‰äº†åœ¨æ¯ä¸ªä»»åŠ¡å‰æ‰§è¡Œçš„ä¸€ç»„å‘½ä»¤ï¼Œæˆ‘ä»¬é€šè¿‡è¿™é‡Œè®¾ç½®çš„å‘½ä»¤å®‰è£…è¿è¡Œ pipeline æ‰€éœ€çš„ä¾èµ–ã€‚</li><li><code>stage</code> å…³é”®å­—å®šä¹‰äº† <code>Pre-commit Hooks</code> å’Œ <code>Static Analysis</code> ä¸¤ä¸ªé˜¶æ®µã€‚</li><li>ä¹‹ååˆ™å®šä¹‰äº† <code>pre-commit</code> ã€ <code>git-lint</code>ã€ <code>mypy</code> å’Œ <code>flake8</code> ç­‰å¤šä¸ªä»»åŠ¡åŠæ‰€å±é˜¶æ®µã€‚</li><li>æ¯ä¸ªä»»åŠ¡ä¸­é€šè¿‡ <code>script</code> å…³é”®å­—å®šä¹‰è¯¥ä»»åŠ¡æ‰€è¿è¡Œçš„è„šæœ¬å‘½ä»¤ã€‚</li><li>åœ¨ <code>pre-commit</code> ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†ä¸Šä¸€èŠ‚ä»‹ç»çš„ <code>pre-commit</code> æ”¾åœ¨æœåŠ¡ç«¯è¿è¡Œï¼Œè¿™èƒ½ç¡®ä¿å¯¹ä»»ä½•äººæäº¤çš„ä»£ç éƒ½ä¼šè¿è¡ŒåŸå…ˆåªåœ¨æœ¬åœ°ç”Ÿæ•ˆçš„ <code>pre-commit hooks</code>ã€‚æˆ‘ä»¬è¿˜é€šè¿‡<a href=https://docs.gitlab.com/ee/ci/variables/predefined_variables.html target=_blank rel=noopener>é¢„å®šä¹‰å˜é‡</a>å’Œ <code>cache</code> å…³é”®å­—ç¼“å­˜è¿è¡Œä»»åŠ¡æ‰€éœ€çš„æ–‡ä»¶ä»¥åŠ å¿«æ‰§è¡Œé€Ÿåº¦ã€‚</li><li>åœ¨ <code>mypy</code> ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ <code>allow_failure</code> å…³é”®å­—æ›´æ”¹äº†ä»»åŠ¡æˆåŠŸæ‰ä¼šè¿›å…¥ä¸‹ä¸€é˜¶æ®µè¿™ä¸€é»˜è®¤è¡Œä¸ºï¼Œå¹¶é€šè¿‡ <code>only</code> å…³é”®å­—é™åˆ¶å…¶åªå¯¹ <code>master</code> åˆ†æ”¯çš„æäº¤æ‰§è¡Œã€‚</li></ul><p>å…³äº <code>.gitlab.yml</code> çš„æ›´å¤šè¯´æ˜è¯·å‚é˜… <a href=https://docs.gitlab.com/ee/ci/yaml/README.html target=_blank rel=noopener>GitLab CI/CD pipeline é…ç½®å‚è€ƒæ‰‹å†Œ</a> ä»¥åŠ <a href=https://docs.gitlab.com/ee/ci/examples/README.html target=_blank rel=noopener>GitLab CI/CD ç¤ºä¾‹</a>ã€‚</p><h4 id=æŸ¥çœ‹-pipeline-çš„è¿è¡ŒçŠ¶æ€><a href=#æŸ¥çœ‹-pipeline-çš„è¿è¡ŒçŠ¶æ€ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:æŸ¥çœ‹-pipeline-çš„è¿è¡ŒçŠ¶æ€ class=headings>æŸ¥çœ‹ pipeline çš„è¿è¡ŒçŠ¶æ€</a></h4><p>ç°åœ¨å½“æˆ‘ä»¬æ¨é€æ–°çš„ä»£ç åˆ°å…±äº«ä»“åº“æ—¶ï¼Œä¸€ä¸ªæ–°çš„ pipeline ä¼šè¢«è§¦å‘è¿è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹é€”å¾„åœ¨ GitLab ä»“åº“æŸ¥çœ‹ pipeline çš„è¿è¡ŒçŠ¶æ€ï¼š</p><ul><li><p>è¿›å…¥ <strong>CI/CD > Pipelines</strong>ã€‚å°†å±•ç¤ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé˜¶æ®µçš„ pipelineï¼ˆå½“å‰çŠ¶æ€ä¸ºå·²é€šè¿‡ï¼‰ã€‚</p><p><img src=2020-01-04-pipeline-entry.png alt=2020-01-04-pipeline-entry></p></li><li><p>ç‚¹å‡» pipeline çš„ ID å³å¯æŸ¥çœ‹è¯¥ pipeline çš„è¿è¡Œç¤ºæ„å›¾ï¼š</p><p><img src=2020-01-04-pipeline-graph.png alt=2020-01-04-pipeline-graph></p></li><li><p>ç‚¹å‡»ä¸€ä¸ªä»»åŠ¡åç§°ï¼Œå¯æŸ¥çœ‹è¯¥ä»»åŠ¡çš„è¯¦ç»†è¿è¡Œä¿¡æ¯ï¼š</p><p><img src=2020-01-04-job-detail.png alt=2020-01-04-job-detail></p></li></ul><p>ä»¥ä¸Šå³ä¸ºä¸€ä¸ªå®Œæ•´çš„ GitLab CI pipeline ç¤ºä¾‹ã€‚åœ¨è¯¥ pipeline ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¯ä¸€æ¬¡æäº¤ä»£ç åï¼š</p><ul><li>å¯¹æ‰€æœ‰æ–‡ä»¶è¿è¡Œé›†æˆäº†ä¼—å¤š <code>hooks</code> çš„ <code>pre-commit</code>ï¼Œç¡®ä¿ä»£ç å·²åœ¨æœ¬åœ°é€šè¿‡äº† <code>pre-commit</code> æ£€æŸ¥ã€‚</li><li>å•ç‹¬æ‰§è¡Œ <code>mypy</code> ã€<code>git-lint</code> ç­‰æ£€æŸ¥å·¥å…·ã€‚</li><li>è¿˜èƒ½å¤Ÿæ‰§è¡Œæ‰“åŒ…ã€è¿è¡Œæµ‹è¯•ã€å®‰å…¨æ£€æŸ¥ç­‰æ›´å¤šæ›´å¤æ‚çš„ä»»åŠ¡ã€‚</li></ul><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†é€šè¿‡ GitHub Actions ä¸ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•è¿è¡Œä¸€ä¸ªç®€å•çš„ CD pipelineã€‚</p><h3 id=github-cd-ç¤ºä¾‹><a href=#github-cd-ç¤ºä¾‹ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:github-cd-ç¤ºä¾‹ class=headings>GitHub CD ç¤ºä¾‹</a></h3><h4 id=å’Œ-gitlab-cicd-çš„åŒºåˆ«><a href=#å’Œ-gitlab-cicd-çš„åŒºåˆ« class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:å’Œ-gitlab-cicd-çš„åŒºåˆ« class=headings>å’Œ GitLab CI/CD çš„åŒºåˆ«</a></h4><p>GitHub Actions æ˜¯ GitHub åœ¨ 2018å¹´10æœˆæ¨å‡ºçš„æŒç»­é›†æˆæœåŠ¡ï¼Œå®ƒå’Œä¸Šæ–‡ä»‹ç»çš„ GitLab CI åŸç†å’Œä½¿ç”¨æ–¹æ³•åŸºæœ¬ç›¸åŒï¼Œä½†å­˜åœ¨ä»¥ä¸‹åŒºåˆ«ï¼š</p><ul><li>æœ¯è¯­å®šä¹‰æœ‰æ‰€ä¸åŒï¼ŒGitHub Actions æœ‰ä»¥ä¸‹ç»„æˆéƒ¨åˆ†ï¼š<ol><li><strong>workflow</strong>Â ï¼ˆå·¥ä½œæµç¨‹ï¼‰ï¼šæŒç»­é›†æˆä¸€æ¬¡è¿è¡Œçš„è¿‡ç¨‹ï¼Œå³ GitLab ä¸­çš„ pipelineã€‚</li><li><strong>job</strong>Â ï¼ˆä»»åŠ¡ï¼‰ï¼šä¸€ä¸ª workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª jobs æ„æˆï¼Œç±»ä¼¼äº GitLab ä¸­çš„ stageï¼Œä½†é»˜è®¤åœ¨ä¸åŒçš„ Runner å¹¶è¡Œæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºé¡ºåºæ‰§è¡Œã€‚</li><li><strong>step</strong>ï¼ˆæ­¥éª¤ï¼‰ï¼šæ¯ä¸ª job ç”±å¤šä¸ª step æ„æˆï¼Œç±»ä¼¼äº GitLab ä¸­çš„ jobï¼Œä½† step è¦ä¹ˆæ˜¯ä¸€è¡Œå‘½ä»¤ï¼Œè¦ä¹ˆå°±æ˜¯ä¸€ä¸ªactionï¼Œstep ä¹‹é—´æŒ‰é¡ºåºæ‰§è¡Œä¸”èƒ½å¤Ÿå…±äº«æ•°æ®ã€‚</li><li><strong>action</strong>Â ï¼ˆåŠ¨ä½œï¼‰ï¼šä½ å¯ä»¥å°†å¤šä¸ªè„šæœ¬å‘½ä»¤å°è£…æˆä¸€ä¸ª actionï¼Œé€šè¿‡ GitHub å¸‚åœºåˆ†äº«ç»™å…¶ä»–äººï¼Œç„¶ååœ¨ step ä¸­ä½¿ç”¨è‡ªå»ºæˆ–æ¥è‡ªç¤¾åŒºçš„ actionã€‚</li></ol></li><li>GitHub å…è´¹æä¾›å¸¸è§ç±»å‹çš„ Runnerï¼Œå› æ­¤ä¸€èˆ¬æƒ…å†µä¸éœ€è¦å†è‡ªè¡Œé…ç½®æœåŠ¡å™¨åŠæ³¨å†Œã€‚</li><li>workflow çš„é…ç½®æ–‡ä»¶ä¹Ÿæ˜¯ç±»ä¼¼äº <code>.gitlab.yml</code> çš„ <code>yaml</code> æ–‡ä»¶ï¼Œä½†éœ€è¦æ·»åŠ åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ <code>.github/workflows</code> è·¯å¾„ä¸­ã€‚</li><li>å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å…±äº«æˆ–ä½¿ç”¨ä»–äººåˆ›å»ºçš„è„šæœ¬å‘½ä»¤ï¼Œå³ actionã€‚</li></ul><p>æ¥ä¸‹æ¥æˆ‘å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ GitHub Actions è‡ªåŠ¨å‘å¸ƒä¸€ä¸ª Hugo é™æ€ç«™ç‚¹åˆ° GitHub Pagesã€‚</p><h4 id=ä½¿ç”¨-github-actions-è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹><a href=#ä½¿ç”¨-github-actions-è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:ä½¿ç”¨-github-actions-è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹ class=headings>ä½¿ç”¨ GitHub Actions è‡ªåŠ¨å‘å¸ƒé™æ€ç«™ç‚¹</a></h4><p>å¤§è‡´çš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>åœ¨æœ¬åœ°å†…å®¹ä»“åº“å¼€å‘ç«™ç‚¹å†…å®¹ï¼Œå®Œæˆåå°†å†…å®¹æ¨é€åˆ°å…±äº«ä»“åº“ã€‚è¯¥å…±äº«ä»“åº“å¯èƒ½æ˜¯ç§æœ‰çš„ã€‚</li><li>å…±äº«ä»“åº“æ¥å—æ¨é€åè§¦å‘ workflowï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š<ol><li>åœ¨ Runner ä¸­æ‹‰å–æäº¤çš„å†…å®¹ã€‚</li><li>é…ç½®ç¯å¢ƒå¹¶å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Hugoã€‚</li><li>è¿è¡Œ Hugo æ ¹æ®æäº¤å†…å®¹ç”Ÿæˆé™æ€ç«™ç‚¹ã€‚</li><li>å°†é™æ€æ–‡ä»¶æ¨é€åˆ°å‘å¸ƒä»“åº“ã€‚</li></ol></li><li>å‘å¸ƒä»“åº“åœ¨æ¥æ”¶åˆ°æ¨é€å†…å®¹åä¼šè‡ªåŠ¨æ›´æ–° Pages é¡µé¢ã€‚</li></ol><p>GitHub ä¸Šæœ‰è®¸å¤šè¿™ç±»è‡ªåŠ¨åŒ–éƒ¨ç½²ä»»åŠ¡çš„å¼€æº Actions é¡¹ç›®ï¼Œæˆ‘ä»¬é€‰æ‹©äº†å…¶ä¸­ä¸€ä¸ªç®€å•æ˜“ç”¨çš„Â <a href=https://github.com/peaceiris/actions-hugo#getting-started target=_blank rel=noopener>GitHub Actions for Hugo</a>ã€‚å…·ä½“çš„æ“ä½œæ­¥éª¤æˆªå›¾å’Œè¯¦ç»†é…ç½®é¡¹å¯ä»¥æŸ¥çœ‹è¯¥é¡¹ç›®çš„Â <a href=https://github.com/peaceiris/actions-hugo#github-actions-for-hugo target=_blank rel=noopener>README</a>ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸‹é…ç½®è¿‡ç¨‹ï¼š</p><ol><li><p>åœ¨æœ¬åœ°å†…å®¹ä»“åº“ä¸­æ·»åŠ ç›®å½•å’Œæ–‡ä»¶ï¼š<code>.github/workflows/gh-pages.yml</code>ï¼Œ<code>gh-pages.yml</code>Â æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>github pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>main </span><span class=w> </span><span class=c># æ¯æ¬¡æ¨é€åˆ° main åˆ†æ”¯éƒ½ä¼šè§¦å‘éƒ¨ç½²ä»»åŠ¡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-18.04</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>  </span><span class=c># Fetch Hugo themes (true OR recursive)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>    </span><span class=c># Fetch all history for .GitInfo and .Lastmod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0.79.1&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>extended</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>deploy_key</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.ACTIONS_DEPLOY_KEY }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>external_repository</span><span class=p>:</span><span class=w> </span><span class=l>&lt;USERNAME&gt;/&lt;USERNAME&gt;.github.io </span><span class=w> </span><span class=c># å‘å¸ƒä»“åº“åç§°</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>publish_branch</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>publish_dir</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></div><p>åœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†å¦‚ä¸‹çš„ workflowï¼š</p><ol><li>workflow åç§°ä¸º <code>github pages</code>ã€‚</li><li>ä»…åœ¨æ¨é€æäº¤åˆ° <code>main</code> åˆ†æ”¯æ—¶æ‰§è¡Œã€‚</li><li>å«æœ‰ä¸€ä¸ªåä¸º <code>deploy</code> çš„ä»»åŠ¡ï¼Œå¹¶éœ€è¦åœ¨<code>ubuntu-18.04</code>å¹³å°çš„ Runner æ‰§è¡Œã€‚</li><li>ä»»åŠ¡ä¸­çš„ç¬¬ä¸€ä¸ªæ­¥éª¤ä½¿ç”¨äº†åä¸º <code>actions/checkout@v2</code> çš„ <code>action</code>ï¼Œä»¥æ‹‰å–æäº¤çš„å†…å®¹åˆ° Runnerã€‚</li><li>ç¬¬äºŒä¸ªæ­¥éª¤ä½¿ç”¨ <code>peaceiris/actions-hugo@v2</code> action é…ç½® Hugoï¼Œå¹¶æŒ‡å®šç‰ˆæœ¬ã€‚</li><li>ç¬¬ä¸‰ä¸ªæ­¥éª¤ç›´æ¥æ‰§è¡Œ <code>hugo --minify</code> å‘½ä»¤ï¼Œç”Ÿæˆé™æ€ç«™ç‚¹ï¼ˆé»˜è®¤è¾“å‡ºæ–‡ä»¶åˆ° <code>public</code> ç›®å½•ï¼‰</li><li>ç¬¬å››ä¸ªæ­¥éª¤ä½¿ç”¨ <code>peaceiris/actions-gh-pages@v3</code> action å°†ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ°æŒ‡å®šçš„å¤–éƒ¨ä»“åº“ã€‚</li></ol><p>è¿™ä¸ªÂ <code>workflow</code>Â åŸºäºå†…å®¹ä»“åº“è¿è¡Œï¼Œä½†æˆ‘ä»¬éœ€è¦å°†è¿è¡Œè¿‡ç¨‹ç”Ÿæˆçš„é™æ€æ–‡ä»¶æ¨é€åˆ°å‘å¸ƒä»“åº“è¿›è¡Œå‘å¸ƒï¼Œå› æ­¤è¿˜éœ€è¦åœ¨ä¸¤ä¸ªä»“åº“ä¸­åˆ†åˆ«è®¾ç½®å¯†é’¥ã€‚</p></li><li><p>åœ¨æœ¬åœ°ç”Ÿæˆ SSH éƒ¨ç½²å¯†é’¥ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-keygen -t rsa -b <span class=m>4096</span> -C <span class=s2>&#34;</span><span class=k>$(</span>git config user.email<span class=k>)</span><span class=s2>&#34;</span> -f gh-pages -N <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># å°†åœ¨å½“å‰ç›®å½•ç”Ÿæˆå¦‚ä¸‹å¯†é’¥æ–‡ä»¶:</span>
</span></span><span class=line><span class=cl><span class=c1>#   gh-pages.pub (å…¬é’¥)</span>
</span></span><span class=line><span class=cl><span class=c1>#   gh-pages     (ç§é’¥)</span>
</span></span></code></pre></td></tr></table></div></div></div></li><li><p>åœ¨ GitHub åˆ†åˆ«è¿›å…¥å†…å®¹ä»“åº“å’Œå‘å¸ƒä»“åº“çš„Â <code>Settings</code>Â é¡µé¢ï¼š</p><ul><li>å°†å…¬é’¥Â <code>gh-pages.pub</code>Â ä½œä¸ºÂ <code>Secret</code>Â æ·»åŠ åˆ°å†…å®¹ä»“åº“ï¼Œå¹¶è®¾ç½®Â <code>Name</code>Â ä¸ºÂ <code>ACTIONS_DEPLOY_KEY</code>ã€‚</li><li>å°†ç§é’¥Â <code>gh-pages</code>Â ä½œä¸ºÂ <code>Deploy Key</code>Â æ·»åŠ åˆ°å‘å¸ƒä»“åº“ï¼Œå¹¶è®¾ç½®ä¸ºÂ <code>Allow write access</code>ã€‚</li></ul></li></ol><p>æ¥ä¸‹æ¥æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æ•ˆæœã€‚</p><p>åœ¨æœ¬åœ°å†…å®¹ä»“åº“åšä¸€äº›æ›´æ”¹ï¼Œé¢„è§ˆæ•ˆæœåæäº¤å¹¶æ¨é€ï¼Œç„¶ååœ¨å…±äº«ä»“åº“çš„ <strong>GitHub Actions</strong> é¡µé¢æ£€æŸ¥ç›¸åº”Â <code>workflow</code>Â çš„è¿è¡ŒçŠ¶æ€ä¸è¯¦ç»†ç»“æœï¼š</p><p><img src=2020-01-04-actions-page.png alt=2020-01-04-actions-page></p><p>è¿è¡ŒæˆåŠŸåï¼Œå¾ˆå¿«å‘å¸ƒä»“åº“å°†æ–°å¢ä¸€ä¸ªç”±è¯¥Â <code>workflow</code>Â åˆ›å»ºçš„æäº¤ï¼Œç›¸åº”çš„ GitHub Pages ä¹Ÿä¼šæ›´æ–°ç›¸åº”çš„å†…å®¹ã€‚</p><h2 id=æ€»ç»“><a href=#æ€»ç»“ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:æ€»ç»“ class=headings>æ€»ç»“</a></h2><p>æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å›´ç»•ä¿éšœä»£ç è´¨é‡è¿™ä¸€ç›®çš„ï¼š</p><ol><li>é¦–å…ˆä»‹ç»äº† Linterã€Static Type Checkerã€Autoformatter ä¸‰ç§å·¥å…·å¹¶å„å±•ç¤ºäº†ä¸€ä¸ªä»£è¡¨æ€§å·¥å…·çš„ä½¿ç”¨æ–¹æ³•ã€‚</li><li>å°†è¿™äº›å·¥å…·é€šè¿‡ <code>pre-commit</code> é›†æˆåˆ° <code>git hooks</code> ä¸­ï¼Œåœ¨ä»£ç å¼€å‘å·¥ä½œæµä¸­è‡ªåŠ¨æ‰§è¡Œã€‚</li><li>ä»‹ç»äº†CI/CDï¼Œå¹¶ä»¥ GitLab CI pipeline ä¸ºä¾‹å°†ä»¥ä¸Šæ£€æŸ¥éƒ¨ç½²åˆ°å…±äº«ä»“åº“ï¼Œåœ¨æ¯æ¬¡ä»£ç æäº¤åè‡ªåŠ¨æ‰§è¡Œã€‚</li><li>é¡ºä¾¿ä»‹ç»äº†ä¸€ä¸ªé€šè¿‡ GitHub Actions å®ç°æŒç»­éƒ¨ç½²çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº† GitHub æŒç»­é›†æˆæœåŠ¡çš„åŸºæœ¬ç”¨æ³•ã€‚</li></ol><p>ç»è¿‡ç®€å•å‡ æ­¥çš„ä¸€æ¬¡æ€§é…ç½®ï¼Œä½ å°±å¯ä»¥æ‹¥æœ‰ä¸€å¥—é«˜åº¦è‡ªåŠ¨åŒ–çš„ä»£ç è´¨é‡å·¥å…·å·¥ä½œæµç¨‹ã€‚ä½†å·¥å…·åªæ˜¯ä¿éšœä»£ç è´¨é‡ä¼—å¤šç¯èŠ‚ä¸­æœ€å®¹æ˜“å‘åŠ›ï¼Œè§æ•ˆå¿«ï¼Œä½†ä½œç”¨ä¹Ÿå¾ˆæœ‰é™çš„ä¸€ç¯ã€‚çœŸæ­£å®ç°ä¿è¯ä»£ç è´¨é‡è¿™ä¸€ç›®æ ‡ä»»é‡è€Œé“è¿œï¼Œè¿˜éœ€è¦æˆ‘ä»¬åœ¨ä¸ªäººå’Œå›¢é˜Ÿè¿™ä¸¤ä¸ªæ–¹é¢è®¤è¯†åˆ°ä»£ç è´¨é‡çš„é‡è¦æ€§ï¼Œå¹¶ä¸æ–­è·µè¡Œå„ç§ä»£ç è´¨é‡è®¾è®¡ä¸æ´»åŠ¨ã€‚</p><p><em><strong>æ›´æ–°</strong></em>ï¼š</p><ul><li>å¦‚æœä½ è§‰å¾—æ‰‹åŠ¨é›†æˆä»¥ä¸Šå·¥å…·è¿‡äºç¹çï¼Œå¯ä»¥å°è¯•æˆ‘åˆ¶ä½œçš„ Python é¡¹ç›®æ¨¡æ¿ <a href=https://github.com/waynerv/cookiecutter-pypackage target=_blank rel=noopener>Cookiecutter PyPackage</a>ï¼Œä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œä½¿ç”¨äº† GitHub Actions è‡ªåŠ¨æ‰§è¡Œæµ‹è¯•ã€é¢„è§ˆå’Œå‘å¸ƒã€‚</li><li>å¦‚æœä½ æƒ³å­¦ä¹ /æé«˜è‡ªå·±çš„ Python æŠ€èƒ½ï¼Œæˆ‘æ¨èä¸€ä¸ªå­¦ä¹ ç½‘ç«™ <a href=https://jobtensor.com/Tutorial/Python/en/Introduction target=_blank rel=noopener>https://jobtensor.com/Tutorial/Python/en/Introduction</a>ï¼Œå®ƒä»¬çš„å†…å®¹å¾ˆæ£’è€Œä¸”å®Œå…¨å…è´¹ã€‚</li></ul><h2 id=å‚è€ƒé“¾æ¥><a href=#å‚è€ƒé“¾æ¥ class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:å‚è€ƒé“¾æ¥ class=headings>å‚è€ƒé“¾æ¥</a></h2><ul><li><a href=https://en.wikipedia.org/wiki/Lint_(software) target=_blank rel=noopener>Linter-Wikipedia</a></li><li><a href=https://flake8.pycqa.org/en/latest/ target=_blank rel=noopener>Flake8</a></li><li><a href=https://mypy.readthedocs.io/en/stable/ target=_blank rel=noopener>Mypy</a></li><li><a href=https://realpython.com/python-type-checking target=_blank rel=noopener>Python Type Checking (Guide)</a></li><li><a href=https://black.readthedocs.io/en/stable/ target=_blank rel=noopener>Black</a></li><li><a href=https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks target=_blank rel=noopener>Customizing Git - Git Hooks</a></li><li><a href=https://pre-commit.com/ target=_blank rel=noopener>pre-commit</a></li><li><a href=https://docs.github.com/en/free-pro-team@latest/actions/guides/about-continuous-integration target=_blank rel=noopener>About continuous integration</a></li><li><a href=https://docs.gitlab.com/ee/ci/README.html target=_blank rel=noopener>GitLab CI/CD</a></li><li><a href=https://docs.github.com/en/free-pro-team@latest/actions/quickstart target=_blank rel=noopener>Quickstart for GitHub Actions</a></li><li><a href=https://docs.github.com/en/free-pro-team@latest/actions/learn-github-actions/introduction-to-github-actions target=_blank rel=noopener>Introduction to GitHub Actions</a></li><li><a href=http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html target=_blank rel=noopener>GitHub Actions å…¥é—¨æ•™ç¨‹</a></li></ul></div><ul class=post-copyright><li class="copyright-item author"><span class=copyright-item-text>ä½œè€…</span>ï¼š<a href=https://www.waynerv.com class="p-author h-card" target=_blank rel=noopener>Waynerv</a></li><li class="copyright-item link"><span class=copyright-item-text>é“¾æ¥</span>ï¼š<a href=/posts/build-automatic-code-quality-workflow/ target=_blank rel=noopener>https://www.waynerv.com/posts/build-automatic-code-quality-workflow/</a></li><li class="copyright-item license"><span class=copyright-item-text>è®¸å¯</span>ï¼š<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a></li></ul></article><div class=updated-badge-container><span title="Updated @ 2022-07-10 11:51:08 UTC" style=cursor:help><svg xmlns="http://www.w3.org/2000/svg" width="130" height="20" class="updated-badge"><linearGradient id="b" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></linearGradient><clipPath id="a"><rect width="130" height="20" rx="3" fill="#fff"/></clipPath><g clip-path="url(#a)"><path class="updated-badge-left" d="M0 0h55v20H0z"/><path class="updated-badge-right" d="M55 0h75v20H55z"/><path fill="url(#b)" d="M0 0h130v20H0z"/></g><g fill="#fff" text-anchor="middle" font-size="110"><text x="285" y="150" fill="#010101" fill-opacity=".3" textLength="450" transform="scale(.1)">updated</text><text x="285" y="140" textLength="450" transform="scale(.1)">updated</text><text x="915" y="150" fill="#010101" fill-opacity=".3" textLength="650" transform="scale(.1)">2022-07-10</text><text x="915" y="140" textLength="650" transform="scale(.1)">2022-07-10</text></g></svg></span></div><div class=post-share><div class=share-items><div class="share-item twitter"><a href="https://twitter.com/share?url=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&text=%e6%9e%84%e5%bb%ba%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e5%b7%a5%e4%bd%9c%e6%b5%81&hashtags=%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f,CI,&via=waynerv77" title=åˆ†äº«åˆ°ã€ŒTwitterã€ target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon twitter-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a></div><div class="share-item facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&hashtag=%23%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f" title=åˆ†äº«åˆ°ã€ŒFacebookã€ target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon facebook-icon"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></a></div><div class="share-item linkedin"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&title=%e6%9e%84%e5%bb%ba%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e5%b7%a5%e4%bd%9c%e6%b5%81&summary=%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e6%98%af%e7%a8%8b%e5%ba%8f%e5%91%98%e7%9a%84%e8%81%8c%e4%b8%9a%e5%ba%95%e7%ba%bf%ef%bc%8c%e7%bb%b4%e6%8a%a4%e5%ba%95%e7%ba%bf%e4%b8%8d%e8%83%bd%e5%85%a8%e9%9d%a0%e8%87%aa%e8%a7%89%ef%bc%8c%e6%9c%ac%e6%96%87%e5%b0%86%e4%bb%8b%e7%bb%8d%e5%a6%82%e4%bd%95%e5%b0%86%20flake8%e3%80%81black%e3%80%81pre-commit%20%e7%ad%89%e5%b7%a5%e5%85%b7%e9%9b%86%e6%88%90%e5%88%b0%e6%97%a5%e5%b8%b8%e7%9a%84%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%ad%ef%bc%8c%e7%9c%81%e5%bf%83%e7%9c%81%e5%8a%9b%e7%9a%84%e6%8c%81%e7%bb%ad%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e3%80%82&source=Shall%20We%20Code?" title=åˆ†äº«åˆ°ã€ŒLinkedInã€ target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon linkedin-icon"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></a></div><div class="share-item telegram"><a href="https://t.me/share/url?url=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&text=%e6%9e%84%e5%bb%ba%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e5%b7%a5%e4%bd%9c%e6%b5%81" title=åˆ†äº«åˆ°ã€ŒTelegramã€ target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon telegram-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a></div><div class="share-item weibo"><a href="https://service.weibo.com/share/share.php?&url=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&title=%e6%9e%84%e5%bb%ba%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e5%b7%a5%e4%bd%9c%e6%b5%81&pic=https://www.waynerv.com/2020-01-04-pre-commit-workflow.png&searchPic=false" title=åˆ†äº«åˆ°ã€Œæ–°æµªå¾®åšã€ target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon weibo-icon"><path d="M407 177.6c7.6-24-13.4-46.8-37.4-41.7-22 4.8-28.8-28.1-7.1-32.8 50.1-10.9 92.3 37.1 76.5 84.8-6.8 21.2-38.8 10.8-32-10.3zM214.8 446.7C108.5 446.7.0 395.3.0 310.4c0-44.3 28-95.4 76.3-143.7C176 67 279.5 65.8 249.9 161c-4 13.1 12.3 5.7 12.3 6 79.5-33.6 140.5-16.8 114 51.4-3.7 9.4 1.1 10.9 8.3 13.1 135.7 42.3 34.8 215.2-169.7 215.2zm143.7-146.3c-5.4-55.7-78.5-94-163.4-85.7-84.8 8.6-148.8 60.3-143.4 116s78.5 94 163.4 85.7c84.8-8.6 148.8-60.3 143.4-116zM347.9 35.1c-25.9 5.6-16.8 43.7 8.3 38.3 72.3-15.2 134.8 52.8 111.7 124-7.4 24.2 29.1 37 37.4 12 31.9-99.8-55.1-195.9-157.4-174.3zm-78.5 311c-17.1 38.8-66.8 60-109.1 46.3-40.8-13.1-58-53.4-40.3-89.7 17.7-35.4 63.1-55.4 103.4-45.1 42 10.8 63.1 50.2 46 88.5zm-86.3-30c-12.9-5.4-30 .3-38 12.9-8.3 12.9-4.3 28 8.6 34 13.1 6 30.8.3 39.1-12.9 8-13.1 3.7-28.3-9.7-34zm32.6-13.4c-5.1-1.7-11.4.6-14.3 5.4-2.9 5.1-1.4 10.6 3.7 12.9 5.1 2 11.7-.3 14.6-5.4 2.8-5.2 1.1-10.9-4-12.9z"/></svg></a></div><div class="share-item douban"><a href="https://www.douban.com/share/service?href=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&name=%e6%9e%84%e5%bb%ba%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e5%b7%a5%e4%bd%9c%e6%b5%81&text=%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e6%98%af%e7%a8%8b%e5%ba%8f%e5%91%98%e7%9a%84%e8%81%8c%e4%b8%9a%e5%ba%95%e7%ba%bf%ef%bc%8c%e7%bb%b4%e6%8a%a4%e5%ba%95%e7%ba%bf%e4%b8%8d%e8%83%bd%e5%85%a8%e9%9d%a0%e8%87%aa%e8%a7%89%ef%bc%8c%e6%9c%ac%e6%96%87%e5%b0%86%e4%bb%8b%e7%bb%8d%e5%a6%82%e4%bd%95%e5%b0%86%20flake8%e3%80%81black%e3%80%81pre-commit%20%e7%ad%89%e5%b7%a5%e5%85%b7%e9%9b%86%e6%88%90%e5%88%b0%e6%97%a5%e5%b8%b8%e7%9a%84%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%ad%ef%bc%8c%e7%9c%81%e5%bf%83%e7%9c%81%e5%8a%9b%e7%9a%84%e6%8c%81%e7%bb%ad%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e3%80%82" title=åˆ†äº«åˆ°ã€Œè±†ç“£ã€ target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon douban-icon"><path d="M.643.92v2.412h22.714V.92H.643zm1.974 4.926v9.42h18.764v-9.42H2.617zm2.72 2.408H18.69v4.605H5.338V8.254zm1.657 7.412-2.512.938c1.037 1.461 1.87 2.825 2.512 4.091H0v2.385h24v-2.385h-6.678c.818-1.176 1.589-2.543 2.303-4.091l-2.73-.938a29.952 29.952.0 01-2.479 5.03h-4.75c-.786-1.962-1.677-3.641-2.672-5.03z"/></svg></a></div><div class="share-item qq"><a href="https://connect.qq.com/widget/shareqq/index.html?url=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&title=%e6%9e%84%e5%bb%ba%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e5%b7%a5%e4%bd%9c%e6%b5%81&summary=%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e6%98%af%e7%a8%8b%e5%ba%8f%e5%91%98%e7%9a%84%e8%81%8c%e4%b8%9a%e5%ba%95%e7%ba%bf%ef%bc%8c%e7%bb%b4%e6%8a%a4%e5%ba%95%e7%ba%bf%e4%b8%8d%e8%83%bd%e5%85%a8%e9%9d%a0%e8%87%aa%e8%a7%89%ef%bc%8c%e6%9c%ac%e6%96%87%e5%b0%86%e4%bb%8b%e7%bb%8d%e5%a6%82%e4%bd%95%e5%b0%86%20flake8%e3%80%81black%e3%80%81pre-commit%20%e7%ad%89%e5%b7%a5%e5%85%b7%e9%9b%86%e6%88%90%e5%88%b0%e6%97%a5%e5%b8%b8%e7%9a%84%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%ad%ef%bc%8c%e7%9c%81%e5%bf%83%e7%9c%81%e5%8a%9b%e7%9a%84%e6%8c%81%e7%bb%ad%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e3%80%82&pics=https://www.waynerv.com/2020-01-04-pre-commit-workflow.png&site=Shall%20We%20Code?" title=åˆ†äº«åˆ°ã€ŒQQã€ target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qq-icon"><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741.0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792.0.0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"/></svg></a></div><div class="share-item qzone"><a href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://www.waynerv.com/posts/build-automatic-code-quality-workflow/&title=%e6%9e%84%e5%bb%ba%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e7%9a%84%e8%87%aa%e5%8a%a8%e5%8c%96%e5%b7%a5%e4%bd%9c%e6%b5%81&summary=%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e6%98%af%e7%a8%8b%e5%ba%8f%e5%91%98%e7%9a%84%e8%81%8c%e4%b8%9a%e5%ba%95%e7%ba%bf%ef%bc%8c%e7%bb%b4%e6%8a%a4%e5%ba%95%e7%ba%bf%e4%b8%8d%e8%83%bd%e5%85%a8%e9%9d%a0%e8%87%aa%e8%a7%89%ef%bc%8c%e6%9c%ac%e6%96%87%e5%b0%86%e4%bb%8b%e7%bb%8d%e5%a6%82%e4%bd%95%e5%b0%86%20flake8%e3%80%81black%e3%80%81pre-commit%20%e7%ad%89%e5%b7%a5%e5%85%b7%e9%9b%86%e6%88%90%e5%88%b0%e6%97%a5%e5%b8%b8%e7%9a%84%e5%b7%a5%e4%bd%9c%e6%b5%81%e4%b8%ad%ef%bc%8c%e7%9c%81%e5%bf%83%e7%9c%81%e5%8a%9b%e7%9a%84%e6%8c%81%e7%bb%ad%e4%bf%9d%e9%9a%9c%e4%bb%a3%e7%a0%81%e8%b4%a8%e9%87%8f%e3%80%82&pics=https://www.waynerv.com/2020-01-04-pre-commit-workflow.png&site=Shall%20We%20Code?" title="åˆ†äº«åˆ°ã€ŒQQ ç©ºé—´ã€" target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon qzone-icon"><path d="M23.985 9.202c-.032-.099-.127-.223-.334-.258-.207-.036-7.351-1.406-7.351-1.406s-.105-.022-.198-.07c-.092-.047-.127-.167-.127-.167S12.447.956 12.349.77C12.25.583 12.104.532 12 .532s-.251.051-.349.238c-.098.186-3.626 6.531-3.626 6.531s-.035.12-.128.167c-.092.047-.197.07-.197.07S.556 8.908.348 8.943c-.208.036-.302.16-.333.258a.477.477.0 00.125.449l5.362 5.49s.072.08.119.172c.016.104.005.21.005.21s-1.189 7.242-1.22 7.45.075.369.159.43c.083.062.233.106.421.013.189-.093 6.812-3.261 6.812-3.261s.098-.044.201-.061.201.061.201.061 6.623 3.168 6.812 3.261c.188.094.338.049.421-.013a.463.463.0 00.159-.43c-.021-.14-.93-5.677-.93-5.677.876-.54 1.425-1.039 1.849-1.747-2.594.969-6.006 1.717-9.415 1.866-.915.041-2.41.097-3.473-.015-.678-.071-1.17-.144-1.243-.438-.053-.215.054-.46.545-.831a2640.5 2640.5.0 012.861-2.155c1.285-.968 3.559-2.47 3.559-2.731.0-.285-2.144-.781-4.037-.781-1.945.0-2.275.132-2.811.168-.488.034-.769.005-.804-.138-.06-.248.183-.389.588-.568.709-.314 1.86-.594 1.984-.626.194-.052 3.082-.805 5.618-.535 1.318.14 3.244.668 3.244 1.276.0.342-1.721 1.494-3.225 2.597-1.149.843-2.217 1.561-2.217 1.688.0.342 3.533 1.241 6.689 1.01l.003-.022c.048-.092.119-.172.119-.172l5.362-5.49a.477.477.0 00.127-.449z"/></svg></a></div><div class="share-item qrcode"><div class=qrcode-container title=é€šè¿‡ã€ŒäºŒç»´ç ã€><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qrcode-icon"><path d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"/></svg><div id=qrcode-img></div></div><script src=https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js></script>
<script>var typeNumber=0,errorCorrectionLevel='L',qr=qrcode(typeNumber,errorCorrectionLevel);qr.addData('https://www.waynerv.com/posts/build-automatic-code-quality-workflow/'),qr.make(),document.getElementById('qrcode-img').innerHTML=qr.createImgTag()</script></div></div></div><div class=related-posts><h2 class=related-title>ç›¸å…³æ–‡ç« ï¼š<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6.0-12-5.4-12-12v-92h-92c-6.6.0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6.0 12 5.4 12 12v92h92c6.6.0 12 5.4 12 12v56z"/></svg></h2><ul class=related-list><li class=related-item><a href=/posts/use-sphinx-auto-generate-api-reference/ class=related-link>ä½¿ç”¨ Sphinx ä¸ºé¡¹ç›®è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£</a></li><li class=related-item><a href=/posts/git-cherry-pick-intro/ class=related-link>æ·±å…¥ç†è§£ git cherry-pick æ“ä½œ</a></li><li class=related-item><a href=/posts/git-undo-intro/ class=related-link>git å·¥ä½œåŸç†ä¸æ’¤é”€æ“ä½œå›¾è§£</a></li><li class=related-item><a href=/posts/ultimate-python-open-source-project-template/ class=related-link>ç©¶æçš„ Python å¼€æºé¡¹ç›®æ¨¡æ¿</a></li><li class=related-item><a href=/posts/git-merge-intro/ class=related-link>æ·±å…¥ç†è§£ git åˆå¹¶æ“ä½œ</a></li></ul></div><div class=post-tags><a href=/tags/%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>ä»£ç è´¨é‡</a>
<a href=/tags/ci/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>CI</a></div><ul class=post-nav><li class=post-nav-prev><a href=/posts/git-undo-intro/ rel=prev>&lt; git å·¥ä½œåŸç†ä¸æ’¤é”€æ“ä½œå›¾è§£</a></li><li class=post-nav-next><a href=/posts/setup-blog-with-hugo-and-github-pages/ rel=next>ä½¿ç”¨ Hugo å’Œ GitHub Pages æ­å»ºé™æ€åšå®¢ ></a></li></ul><div id=utterances></div></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div><footer id=footer class=footer><div class=footer-inner><div class=site-info>Â©&nbsp;2020â€“2022&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3.0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;Waynerv</div><div class=powered-by>Powered by <a href=https://github.com/gohugoio/hugo target=_blank rel=noopener>Hugo</a> | Theme is <a href=https://github.com/reuixiy/hugo-theme-meme target=_blank rel=noopener>MemE</a></div><div class=site-copyright><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a></div><ul class=socials><li class=socials-item><a href=/rss.xml target=_blank rel="external noopener" title=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M19.199 24C19.199 13.467 10.533 4.8.0 4.8V0c13.165.0 24 10.835 24 24h-4.801zM3.291 17.415c1.814.0 3.293 1.479 3.293 3.295.0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526.0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727.0 15.909 7.184 15.909 15.91z"/></svg></a></li><li class=socials-item><a href=mailto:ampedee@gmail.com target=_blank rel="external noopener" title=Email><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M464 64H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 4e2V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V4e2H48z"/></svg></a></li><li class=socials-item><a href=https://github.com/waynerv target=_blank rel="external noopener" title=GitHub><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="icon social-icon"><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a></li><li class=socials-item><a href=https://twitter.com/waynerv77 target=_blank rel="external noopener" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon social-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a></li><li class=socials-item><a href=https://t.me/waynerv target=_blank rel="external noopener" title=Telegram><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon social-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a></li></ul></div></footer></div><script>function loadComments(){(function(){var e,t=document.getElementById("utterances");if(!t)return;e=document.createElement('script'),e.src='https://utteranc.es/client.js',e.async=!0,e.crossOrigin='anonymous',e.setAttribute('repo','waynerv/waynerv.github.io'),e.setAttribute('issue-term','pathname');const n=getCurrentTheme()==='dark';n?e.setAttribute('theme','photon-dark'):e.setAttribute('theme','github-light'),e.setAttribute('label','comment'),t.appendChild(e)})()}</script><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script>
<script>let imgNodes=document.querySelectorAll('div.post-body img');imgNodes=Array.from(imgNodes).filter(e=>e.parentNode.tagName!=="A"),mediumZoom(imgNodes,{background:'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'})</script><script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script>
<script async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>